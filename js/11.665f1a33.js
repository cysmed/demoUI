(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{2311:function(e,t,a){},2481:function(e,t,a){},3962:function(e,t,a){"use strict";a("2481")},4815:function(e,t,a){"use strict";a("ef91")},"996f":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("breadcrumbs",{staticClass:"absolute-top",attrs:{links:e.links}}),e.hasBasicProfile?a("basicProfile",{attrs:{cysmed:e.cysmed}}):e._e(),e.hasMedicProfile?a("medicProfile",{attrs:{cysmed:e.cysmed}}):e._e(),e.hasFacilityProfile?a("facilityProfile",{attrs:{cysmed:e.cysmed}}):e._e()],1)},i=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-page",{staticClass:"flex flex-center",attrs:{padding:""}},[e.loaded?a("q-card",{staticClass:"items-center text-center bg-white"},[a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"items-left text-left"},[a("div",{staticClass:"text-h4"},[e._v("Profile")]),a("div",[e._v(e._s(e.email))])]),a("q-space"),a("div",{staticClass:"items-left text-left text-weight-thin"},[a("div",[e._v("Last Login")]),a("div",[e._v(e._s(e.lastLogin))])])],1)]),a("q-card-section",[a("q-form",{ref:"changeUserNameForm",staticClass:"q-gutter-md text-white",on:{submit:e.changeuserNames,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:e.allowlastName?"First Name":"Facility Name","lazy-rules":"",rules:[function(t){return t&&t.length>0||(!1===e.allowlastName||"false"===e.allowlastName?"Please enter facility name":"Please enter your first name")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),e.allowlastName?a("q-input",{attrs:{filled:"",type:"text",label:"Last Name",hint:"Last Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your last name"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}}):e._e(),e.allowlastName?a("q-input",{attrs:{filled:"",mask:"date",label:"Date of Birth(YYYY/MM/DD)",rules:["date"]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}}):e._e(),e.allowlastName?a("q-select",{attrs:{"use-input":"",filled:"",options:e.genders,label:"Gender","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select your gender"}]},model:{value:e.gender,callback:function(t){e.gender=t},expression:"gender"}}):e._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"items-left text-left"},[a("q-btn",{attrs:{label:"Change Password",color:"primary"},on:{click:function(t){e.changePasswordDialog=!0}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"items-left text-left"},[a("q-btn",{attrs:{label:"Delete Account",color:"red"},on:{click:e.deleteAccount}})],1),a("q-space"),a("div",{staticClass:"items-left text-left"},[a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),a("q-btn",{attrs:{label:"Save",type:"submit",color:"green",disable:e.userEditted}})],1)],1)],1)],1)],1):e._e(),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.changePasswordDialog,callback:function(t){e.changePasswordDialog=t},expression:"changePasswordDialog"}},[a("q-card",[a("q-card-section",{staticClass:"bg-secondary text-white text-h5 text-center"},[e._v("\n          Change Password\n        ")]),a("q-card-section",[a("q-form",{ref:"changePasswordForm",staticClass:"q-gutter-md text-white",on:{submit:e.changePassword,reset:e.onResetChangePassword}},[a("q-input",{attrs:{filled:"",type:"password",label:"Current Password",hint:"Current Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your current pasword"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.currentPassword,callback:function(t){e.currentPassword=t},expression:"currentPassword"}}),a("q-input",{attrs:{filled:"",type:"password",label:"New Password",hint:"New Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your new pasword"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),a("q-input",{attrs:{filled:"",type:"password",label:"Confirm New Password",hint:"Confirm New Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please confirm your new pasword"}],"error-message":e.confirmPasswordError},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.newPasswordAgain,callback:function(t){e.newPasswordAgain=t},expression:"newPasswordAgain"}}),a("div",{staticClass:"row"},[a("q-space"),a("div",{staticClass:"items-left text-left"},[a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),a("q-btn",{attrs:{label:"Change Password",type:"submit",color:"green"}})],1)],1)],1)],1)],1)],1)],1)],1)},n=[];a("ddb0"),a("cf57"),a("51e2");const l=a("c2a1").default,o=a("1712").to,d=a("20e6"),c=a("6daa").default;var m={name:"basicProfile",components:{},props:["cysmed"],data(){return{profilePath:"",userData:{},email:"",firstName:"",lastName:"",firstNameOriginal:"",lastNameOriginal:"",genderOriginal:"",dobOriginal:"",currentPassword:"",newPassword:"",newPasswordAgain:"",loaded:!1,changePasswordDialog:!1,lastLogin:"",confirmPasswordError:"",gender:"Male",genders:["Male","Female"],dob:"",allowlastName:!0}},async created(){l.setSettings({TBURL:d["TB_URL"]}),l.setVue(this),await l.authGuard(),console.log(this.cysmed.currentUserAuthority),this.allowlastName=!this.cysmed.currentUserAuthority.match(/FACILITY/),console.log(this.allowlastName),console.log(this.allowlastName),console.log(this.allowlastName),l.showLoading();let[e,t]=await o(l.readUserData());e||(l.hideLoading(),this.setUserData(t))},methods:{onReset(){this.firstName=this.firstNameOriginal,this.lastName=this.lastNameOriginal,this.gender=this.genderOriginal,this.dob=this.dobOriginal},onResetChangePassword(){this.currentPassword="",this.newPassword="",this.newPasswordAgain=""},setUserData(e){this.userData=e,this.email=e.email,this.firstName=e.firstName,this.lastName=e.lastName,this.firstNameOriginal=e.firstName,this.lastNameOriginal=e.lastName,this.dob=e.dateOfBirth,this.dobOriginal=e.dateOfBirth,this.gender=e.gender,this.genderOriginal=e.gender,this.loaded=!0,this.lastLogin=new Date(e.additionalInfo.lastLoginTs).toISOString()},async changeuserNames(){return new Promise((async(e,t)=>{if(this.notUserEditted())return e(!1);let a=this.userData;a.firstName=this.firstName,a.lastName=this.lastName,a.gender=this.gender,a.dateOfBirth=this.dob,l.showLoading();let[s,i]=await o(l.saveUserData(a));if(l.hideLoading(),s)return this.$q.notify({type:"negative",message:s.msg||s}),e(!1);this.setUserData(i),e(i)}))},async changePassword(){return new Promise((async(e,t)=>{if(this.newPassword!==this.newPasswordAgain)return this.newPasswordAgain="",this.confirmPasswordError="Passwords don't match",e(!1);let a={oldpassword:this.currentPassword,password:this.newPassword};l.showLoading({message:"Changing Password"});let[s,i]=await o(l.changePassword(a));if(l.hideLoading(),s)return this.$q.notify({type:"negative",message:s.response.data.error||s.msg||s.response.data.message||s.message||s}),e(!1);this.$q.notify({type:"positive",message:"Password changed."}),this.changePasswordDialog=!1,e(i)}))},async deleteAccount(){return new Promise((async(e,t)=>{let[a,s]=await o(c.confirm(this,"Are you sure you want to delete your account?","Delete Account"));return a?e(!1):(l.showLoading({message:"Deleting Account"}),[a,s]=await o(l.deleteUser(this.userData.userId,!0)),l.hideLoading(),a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:"Your account has been deleted"}),void window.location.assign("/")))}))},submitChangeUserName(){this.$refs.changeUserNameForm.submit()},submitChangePassword(){this.$refs.changePasswordForm.submit()},notUserEditted(){return this.firstName===this.firstNameOriginal&&this.lastName===this.lastNameOriginal&&this.dob===this.dobOriginal&&this.gender===this.genderOriginal}},computed:{userEditted(){return this.firstName===this.firstNameOriginal&&this.lastName===this.lastNameOriginal&&this.dob===this.dobOriginal&&this.gender===this.genderOriginal}}},h=m,u=(a("c69d"),a("2877")),g=a("9989"),f=a("f09f"),w=a("a370"),b=a("2c91"),y=a("0378"),p=a("27f9"),P=a("ddd8"),N=a("9c40"),v=a("24e8"),q=a("eebe"),C=a.n(q),O=Object(u["a"])(h,r,n,!1,null,"735f17f5",null),k=O.exports;C()(O,"components",{QPage:g["a"],QCard:f["a"],QCardSection:w["a"],QSpace:b["a"],QForm:y["a"],QInput:p["a"],QSelect:P["a"],QBtn:N["a"],QDialog:v["a"]});var x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"basic",label:"Basic Info"}}),a("q-tab",{attrs:{name:"details",label:"Details"}})],1),a("q-tab-panels",{staticClass:"q-ma-none q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"basic"}},[a("basicProfile",{attrs:{cysmed:e.cysmed}})],1),a("q-tab-panel",{attrs:{name:"details"}},[a("medicDetailsProfile",{attrs:{cysmed:e.cysmed}})],1)],1)],1)},D=[],L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-page",{staticClass:"flex flex-center",attrs:{padding:""}},[e.loaded?a("q-card",{staticClass:"items-center text-center bg-white"},[a("q-card-section",[a("q-form",{ref:"changeUserNameForm",staticClass:"q-gutter-md text-white",on:{submit:e.changeuserNames,reset:e.onReset}},[a("div",{staticClass:"row"},[a("q-space"),a("div",{staticClass:"items-left text-left"},[a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),a("q-btn",{attrs:{label:"Save",type:"submit",color:"green",disable:e.userEditted}})],1)],1)])],1)],1):e._e()],1)],1)},_=[];const A=a("c2a1").default,U=a("1712").to,E=a("20e6"),Q=a("6daa").default;var $={name:"basicProfile",components:{},data(){return{profilePath:"",userData:{},email:"",firstName:"",lastName:"",firstNameOriginal:"",lastNameOriginal:"",genderOriginal:"",dobOriginal:"",currentPassword:"",newPassword:"",newPasswordAgain:"",loaded:!1,changePasswordDialog:!1,lastLogin:"",confirmPasswordError:"",gender:"Male",genders:["Male","Female"],dob:"",allowlastName:!0}},async created(){A.setSettings({TBURL:E["TB_URL"]}),A.setVue(this),await A.authGuard();let e=(await A.whoAmILocally()).authority;this.allowlastName=!e.match(/PHARMACY/),A.showLoading();let[t,a]=await U(A.readUserData());t||(A.hideLoading(),this.setUserData(a))},methods:{onReset(){this.firstName=this.firstNameOriginal,this.lastName=this.lastNameOriginal,this.gender=this.genderOriginal,this.dob=this.dobOriginal},onResetChangePassword(){this.currentPassword="",this.newPassword="",this.newPasswordAgain=""},setUserData(e){this.userData=e,this.email=e.email,this.firstName=e.firstName,this.lastName=e.lastName,this.firstNameOriginal=e.firstName,this.lastNameOriginal=e.lastName,this.dob=e.dateOfBirth,this.dobOriginal=e.dateOfBirth,this.gender=e.gender,this.genderOriginal=e.gender,this.loaded=!0,this.lastLogin=new Date(e.additionalInfo.lastLoginTs).toISOString()},async changeuserNames(){return new Promise((async(e,t)=>{if(this.notUserEditted())return e(!1);let a=this.userData;a.firstName=this.firstName,a.lastName=this.lastName,a.gender=this.gender,a.dateOfBirth=this.dob,A.showLoading();let[s,i]=await U(A.saveUserData(a));if(A.hideLoading(),s)return this.$q.notify({type:"negative",message:s.msg||s}),e(!1);this.setUserData(i),e(i)}))},async changePassword(){return new Promise((async(e,t)=>{if(this.newPassword!==this.newPasswordAgain)return this.newPasswordAgain="",this.confirmPasswordError="Passwords don't match",e(!1);let a={oldpassword:this.currentPassword,password:this.newPassword};A.showLoading({message:"Changing Password"});let[s,i]=await U(A.changePassword(a));if(A.hideLoading(),s)return this.$q.notify({type:"negative",message:s.response.data.error||s.msg||s.response.data.message||s.message||s}),e(!1);this.$q.notify({type:"positive",message:"Password changed."}),this.changePasswordDialog=!1,e(i)}))},async deleteAccount(){return new Promise((async(e,t)=>{let[a,s]=await U(Q.confirm(this,"Are you sure you want to delete your account?","Delete Account"));return a?e(!1):(A.showLoading({message:"Deleting Account"}),[a,s]=await U(A.deleteUser(this.userData.userId,!0)),A.hideLoading(),a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:"Your account has been deleted"}),void window.location.assign("/")))}))},submitChangeUserName(){this.$refs.changeUserNameForm.submit()},submitChangePassword(){this.$refs.changePasswordForm.submit()},notUserEditted(){return this.firstName===this.firstNameOriginal&&this.lastName===this.lastNameOriginal&&this.dob===this.dobOriginal&&this.gender===this.genderOriginal}},computed:{userEditted(){return this.firstName===this.firstNameOriginal&&this.lastName===this.lastNameOriginal&&this.dob===this.dobOriginal&&this.gender===this.genderOriginal}}},I=$,T=(a("4815"),Object(u["a"])(I,L,_,!1,null,"42b8427d",null)),B=T.exports;C()(T,"components",{QPage:g["a"],QCard:f["a"],QCardSection:w["a"],QForm:y["a"],QSpace:b["a"],QBtn:N["a"]});var F={name:"medicProfile",components:{basicProfile:k,medicDetailsProfile:B},props:["cysmed"],data(){return{tab:"basic"}}},R=F,S=a("429bb"),M=a("7460"),Y=a("adad"),z=a("823b"),j=Object(u["a"])(R,x,D,!1,null,null,null),G=j.exports;C()(j,"components",{QTabs:S["a"],QTab:M["a"],QTabPanels:Y["a"],QTabPanel:z["a"]});var J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"basic",label:"Basic Info"}}),a("q-tab",{attrs:{name:"details",label:"Details"}})],1),a("q-tab-panels",{staticClass:"q-ma-none q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"basic"}},[a("basicProfile",{attrs:{cysmed:e.cysmed}})],1),a("q-tab-panel",{attrs:{name:"details"}},[e._v("\n         details\n      ")])],1)],1)},V=[],H={name:"facilityProfile",components:{basicProfile:k},props:["cysmed"],data(){return{tab:"basic"}}},K=H,W=Object(u["a"])(K,J,V,!1,null,null,null),X=W.exports;C()(W,"components",{QTabs:S["a"],QTab:M["a"],QTabPanels:Y["a"],QTabPanel:z["a"]});var Z=a("2cbd");const ee=a("c2a1").default;a("1712").to;var te={name:"profile",components:{breadcrumbs:Z["default"],basicProfile:k,medicProfile:G,facilityProfile:X},props:["cysmed"],data(){return{links:[{label:"Profile",icon:"person",to:"/profile"}],authority:null}},async created(){let e=await ee.whoAmILocally();this.userName=`${e.firstName} ${e.lastName}`,this.authority=`${e.currentAuthority||e.authority}`},methods:{},computed:{hasBasicProfile(){return["SYS_ADMIN","PATIENT"].includes(this.authority)},hasMedicProfile(){return["MEDIC"].includes(this.authority)},hasFacilityProfile(){return["FACILITY"].includes(this.authority)}}},ae=te,se=(a("3962"),Object(u["a"])(ae,s,i,!1,null,"70bd8da1",null));t["default"]=se.exports},c69d:function(e,t,a){"use strict";a("2311")},ef91:function(e,t,a){}}]);