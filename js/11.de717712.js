(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"13cf":function(t,e,s){"use strict";s("1b28")},"1b28":function(t,e,s){},"46f3":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-page",{staticClass:"flex flex-center",staticStyle:{position:"fixed",top:"0px",width:"100%","z-index":"100"}},[a("img",{attrs:{alt:t.sysValues.PROJECT.toLowerCase(),src:s("6e23")("./"+t.sysValues.PROJECT.toLowerCase()+"/csysteminfo.png")}})]),a("div",{staticClass:"q-ma-none absolute-top-right",staticStyle:{"z-index":"1001"}},[a("q-select",{staticClass:"q-ma-none q-pa-none bg-reen",attrs:{filled:"",options:t.langs,label:"Language","lazy-rules":"",rules:[function(t){return t&&t.length>0||"Please select a language"}]},on:{input:t.changeLang},model:{value:t.lang,callback:function(e){t.lang=e},expression:"lang"}})],1),a("q-page",{staticClass:"flex flex-center",staticStyle:{position:"absolute",top:"0px",width:"100%","z-index":"1000"}},[a("softwareRegistrationForm",{attrs:{cysmed:t.cysmed}}),a("seamlessDialog",{attrs:{cysmed:t.cysmed}})],1)],1)},r=[],i=s("cf57"),n=function(){var t=this,e=this,s=e.$createElement,a=e._self._c||s;return a("q-card",{staticClass:"my-card q-ma-md",staticStyle:{position:"relative"}},[a("q-card-section",{staticClass:"bg-secondary text-white text-center"},[a("div",{staticClass:"text-h6"},[e._v(e._s(e.translate("PROJECT.NAME")))])]),a("q-card-section",{staticClass:"bg-secondary text-white q-ma-none"},[1===e.formPage?a("div",[e.recoveringPassword?a("div",[e._v("\n        Go to the online portak to reset your password. Or\n        "),a("a",{attrs:{href:"#"},on:{click:e.recoverPassword}},[e._v("try again.")])]):a("q-form",{staticClass:"text-white bg-secondary",on:{submit:e.onSubmit,reset:e.onReset}},[a("div",{staticClass:"text-center"},[a("p",{staticClass:"q-pa-none q-ma-none"},[e._v("\n            Log in with you cysmed account to:\n          ")]),a("p",{staticClass:"q-pa-none q-ma-none"},[e._v("1. Register this software. Or")]),a("p",{staticClass:"q-pa-none q-mb-md"},[e._v("\n            2. Reset the admin account password.\n          ")])]),a("q-input",{attrs:{filled:"",type:"email",label:e.translate("FIELDS.EMAIL"),hint:e.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(s){return t.isValidEmail()||e.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("q-input",{attrs:{filled:"",type:"password",label:e.translate("FIELDS.PASSWORD"),"lazy-rules":"",rules:[function(t){return null!==t&&""!==t||e.translate("FIELDS.ERRORS.PASSWORD.MISSINGOWN")}],"error-message":e.passwordErrorMessage},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("div",{staticClass:"q-pa-none"},[a("q-btn",{attrs:{label:e.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1),a("p",{staticClass:"text-center items-center q-pa-md"},[a("a",{attrs:{href:"#"},on:{click:e.recoverPassword}},[e._v("Forgot password?")])])],1)],1):e._e(),2==e.formPage?a("q-form",{staticClass:"text-white bg-secondary",on:{submit:e.onSubmitPage2,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:"Computer Name","lazy-rules":"",rules:[function(t){return t&&t.length>0||"Please enter a name for the computer"}]},model:{value:e.computerName,callback:function(t){e.computerName=t},expression:"computerName"}}),a("div",{staticClass:"q-pa-none"},[a("q-btn",{attrs:{label:e.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1)],1):e._e(),3==e.formPage?a("q-form",{staticClass:"text-white bg-secondary",on:{submit:e.onSubmitPage3,reset:e.onReset}},[a("p",[e._v("Administrator Account")]),a("p"),a("q-input",{attrs:{filled:"",type:"email",label:e.translate("FIELDS.EMAIL"),hint:e.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(s){return t.isValidEmail()||e.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("q-input",{attrs:{filled:"",type:"password",label:e.translate("FIELDS.PASSWORD"),"lazy-rules":"",rules:[function(t){return null!==t&&""!==t||e.translate("FIELDS.ERRORS.PASSWORD.MISSINGOWN")}],"error-message":e.passwordErrorMessage},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("q-input",{attrs:{filled:"",type:"password",label:e.translate("FIELDS.CONFIRMPASSWORD"),"lazy-rules":"",rules:[function(t){return null!==t&&""!==t||e.translate("FIELDS.ERRORS.CONFIRMPASSWORD.MISSINGOWN")}],"error-message":e.passwordErrorMessage},model:{value:e.cpassword,callback:function(t){e.cpassword=t},expression:"cpassword"}}),a("div",{staticClass:"q-pa-none"},[a("q-btn",{attrs:{label:e.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1)],1):e._e()],1),a("q-card-section",{staticClass:"bg-secondary text-white text-center"},[a("div",{staticClass:"text-h6"},[a("q-btn",{attrs:{icon:"home"},on:{click:function(t){return e.cysmed.navigate("/")}}})],1)])],1)},o=[];s("ddb0");const l=s("1712").to,c=s("20e6"),m=s("ea76").default;var d={name:"softwareRegistrationForm",components:{},props:["cysmed"],async created(){this.extendedProjectName=c["PROJECTEXTENDED"]},data(){return{formPage:1,registrationData:{},computerName:"",recoveringPassword:!1,translate:m.translate,extendedProjectName:"",tab:"",loggedin:!1,working:!1,email:"",password:"",cpassword:"",passwordErrorMessage:""}},methods:{recoverPassword(t){t.preventDefault(),this.recoveringPassword=!this.recoveringPassword},isValidEmail(){const t=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return t.test(this.email)||this.translate("FIELDS.ERRORS.EMAIL.INVALID")},async onSubmit(){this.cysmed.setSettings({TBURL:c["TB_URL"]});c["TB_URL"];let t={email:this.email,password:this.password};this.working=!0,this.showCustom();let[e,s]=await l(this.cysmed.loginOnPortal(t));if(this.working=!1,e)return this.loggedin=!1,this.$q.notify({type:"negative",message:this.translate(e.error||e.message||e||"ACTIONS.ERRORS.LOGINFAILED")}),this.password="",this.passwordErrorMessage=this.translate(),void(e.error||e.message);this.formPage++,this.registrationData=s,this.onReset(),this.registrationData.computerName&&(this.computerName=this.registrationData.computerName),this.email="",this.$q.notify({type:"positive",message:"Successful login to online portal."})},async onSubmitPage2(){this.cysmed.setSettings({TBURL:c["TB_URL"]});c["TB_URL"];this.working=!0,this.showCustom(),this.registrationData.computerName=this.computerName;let[t,e]=await l(this.cysmed.registerSoftware(this.registrationData));if(this.working=!1,t)return this.loggedin=!1,void this.$q.notify({type:"negative",message:this.translate(t.error||t.message||"Failed to register software")});this.formPage++,this.onReset(),e.email&&(this.email=e.email),this.$q.notify({type:"positive",message:"Successful software registration"})},async onSubmitPage3(){if(this.password!==this.cpassword)return this.cpassword="",this.passwordErrorMessage=this.translate("FIELDS.ERRORS.PASSWORD.DONTMATCH"),this.$q.notify({type:"negative",message:this.translate("FIELDS.ERRORS.PASSWORD.DONTMATCH")}),!1;this.cysmed.setSettings({TBURL:c["TB_URL"]}),this.working=!0,this.showCustom(),console.log(this.registrationData);let[t,e]=await l(this.cysmed.createAdminAccount({email:this.email,password:this.password},this.registrationData.token));if(this.working=!1,t)return console.log(t),this.loggedin=!1,void this.$q.notify({type:"negative",message:this.translate(t.error||t.message||"Failed to create/Modify admin account")});this.$q.notify({type:"positive",message:"Admin account created/modified successfully"}),this.onReset(),this.$router.push({path:"/"})},onReset(){this.email=null,this.password=null,this.cpassword=null,this.computerName=null},showCustom(t=""){const e=this.$q.dialog({title:t,message:"",progress:{spinner:i["a"],color:"primary"},persistent:!0,ok:!1}),s=setInterval((()=>{!1===this.working&&(clearInterval(s),e.hide())}),500)}},watch:{async tab(t,e){let s=this.$route.path.match(/\/auth\/(.+)/);s?(s=s[1],s!==t&&this.$router.push({path:`/auth/${t}`})):this.$router.push({path:`/auth/${t}`})}}},u=d,p=(s("13cf"),s("2877")),h=s("f09f"),g=s("a370"),f=s("0378"),w=s("27f9"),S=s("9c40"),y=s("eebe"),R=s.n(y),E=Object(p["a"])(u,n,o,!1,null,"a878330c",null),b=E.exports;R()(E,"components",{QCard:h["a"],QCardSection:g["a"],QForm:f["a"],QInput:w["a"],QBtn:S["a"]});var I=s("87a4");const v=s("ea76").default,q=(s("1712").to,s("20e6"));var C={name:"softwareRegistration",components:{seamlessDialog:I["a"],softwareRegistrationForm:b},props:["cysmed"],data(){return{isRegistered:!1,hasCheckedRegistered:!1,sysValues:q,lang:"",langs:[]}},async created(){this.lang=v.getLang(),this.langs=v.listLangs()},methods:{changeLang(){let t=this.lang;v.setLang(t),window.location.reload()}}},L=C,O=s("9989"),D=s("ddd8"),A=Object(p["a"])(L,a,r,!1,null,null,null);e["default"]=A.exports;R()(A,"components",{QPage:O["a"],QSelect:D["a"]})}}]);