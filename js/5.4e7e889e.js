(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"36d2":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",{staticClass:"padding"},[e.loadingSomethingBigger?i("q-linear-progress",{attrs:{indeterminate:"",color:"negative"}}):e._e(),e.rightSideBarP?i("rightSideBar",{attrs:{main:e.main,objType:"organization"}}):e._e(),i("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.createOrganizationDialog,callback:function(t){e.createOrganizationDialog=t},expression:"createOrganizationDialog"}},[i("q-card",{staticClass:"q-ma-md"},[i("q-card-section",{staticClass:"bg-secondary text-white text-center"},[i("div",{staticClass:"text-h6"},[e._v("Create Organization")])]),i("q-card-section",{staticClass:"bg-secondary text-white"},[i("createOrganization",{attrs:{main:e.main}})],1)],1)],1),e.notOuterPage?e._e():i("breadcrumbs",{attrs:{links:e.links}}),i("q-table",{attrs:{grid:"","card-container-class":e.cardContainerClass,data:e.allOrganizations,columns:e.columns,title:"Organizations",filter:e.filter,"row-key":"name","hide-header":"","hide-bottom":"","rows-per-page-options":[0]},on:{"row-click":e.selectOrganization},scopedSlots:e._u([{key:"top-right",fn:function(){return[i("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[i("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),i("q-btn",{attrs:{flat:""}},[i("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.listUserOrganizations()}}})],1),i("q-btn",{attrs:{flat:""}},[i("q-icon",{attrs:{color:"primary",name:"add_circle",side:""},on:{click:function(t){e.createOrganizationDialog=!0}}})],1)]},proxy:!0},{key:"item",fn:function(t){return[i("div",{staticClass:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},[i("q-card",{staticClass:"bg-primary",staticStyle:{height:"200px"}},[i("q-card-section",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"flex flex-center text-h6 bg-green q-mb-none q-pb-none full-height cursor-pointer q-hoverable",on:{click:function(i){return e.selectOrganization(t.row)}}},[i("strong",[e._v(e._s(t.row.organizationName))])]),i("q-btn",{staticClass:"text-white absolute-top-right q-ma-sm",attrs:{icon:"delete",color:"red"},on:{click:function(i){return e.deleteOrganization(t.row)}}}),i("q-btn",{staticClass:"text-white absolute-top-left q-ma-sm",attrs:{icon:"input",color:"secondary"},on:{click:function(i){return e.manageUsers(t.row)}}})],1)],1)]}}])})],1)},s=[],n=(i("ddb0"),i("5319"),i("cf57"),i("2cbd")),o=i("c64e"),r=i("4d6d");const l=i("20e6"),c=i("40cd").default,g=i("1712").to,d=i("6daa").default;var m={name:"organizations",props:["notOuterPage"],components:{breadcrumbs:n["a"],createOrganization:o["a"],rightSideBar:r["a"]},watch:{$route(e,t){this.setfilters(e.path)}},data(){return{activeElement_:"",main:this,editted:!1,loadingSomething:!1,loadingSomethingBigger:!1,rightSideBarP:!1,createOrganizationDialog:!1,loaded:!0,links:[{label:"Organizations",icon:"corporate_fare",to:"/organizations"}],checkedLoggedIn:!1,loggedIn:!1,listHck:[{name:"Users",icon:"settings",link:"/#/system/users",Authority:"Manage Users and Organizations",description:"Manage Users and Organizations"}],filter:"",columnsHck:[],columns:[{name:"organizationName",label:"Organization",field:"organizationName",sortable:!0},{name:"lastName",label:"Last Name",field:"lastName",sortable:!0},{name:"email",label:"Email",field:"email",sortable:!0}],numUsers:0,numSysAdmins:0,numActiveUsers:0,numInactiveUsers:0,numEnabledUsers:0,numDisabledusers:0,allOrganizations:[],selectedRow:{}}},async created(){this.setfilters(),c.setVue(this),c.setSettings({TBURL:l["TB_URL"]}),c.showLoading();let[e,t]=await g(c.isLoggedIn());c.hideLoading(),this.checkedLoggedIn=!0,!e&&t||window.location.assign("#/"),await this.listUserOrganizations();let i,a,s=window.location.hash.replace(/^[#]*[\/]*/,""),n=s.match(/(organizations)\/([0-9a-z-]+)$/);n&&"organizations"===n[1]&&(i=n[2]),i&&(this.allOrganizations.map((e=>{e.organizationId===i&&(a=e)})),a&&this.selectOrganization(a))},methods:{manageUsers(e){window.location.assign(`/#/organizations/${e.organizationId}/users`)},async deleteOrganization(e){let{organizationId:t,organizationName:i}=e;return new Promise((async(t,i)=>{let[a,s]=await g(d.confirm(this,`Are you sure you want to delete ${e.organizationName}?`,"Delete Organization"));return a?t(!1):(this.main.loadingSomething=!0,[a,s]=await g(c.deleteOrganization(e.organizationId)),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),t(!1)):(this.$q.notify({type:"positive",message:`Organization ${e.organizationName} has been deleted.`}),void await this.listUserOrganizations()))}))},setfilters(e=!1){let t=(e||window.location.hash).replace(/[\/]*[#]*\//,"");switch(t){case"system/users":this.filters={},this.activeElement_="users",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"}];break;case"system/users/sys_admin":this.filters={authority:"SYS_ADMIN"},this.activeElement_="sys_admin",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Sys_Admins",icon:"settings",to:"/system/users/sys_admin"}];break;case"system/users/active":this.filters={isActive:!0},this.activeElement_="active",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Active",icon:"do_not_disturb_off",to:"/system/users/active"}];break;case"system/users/inactive":this.filters={isActive:!1},this.activeElement_="inactive",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Inactive",icon:"do_not_disturb_on",to:"/system/users/inactive"}];break;case"system/users/enabled":this.filters={enabled:!0},this.activeElement_="enabled",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Enabled",icon:"people",to:"/system/users/enabled"}];break;case"system/users/disabled":this.filters={enabled:!1},this.activeElement_="disabled",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Disabled",icon:"person_off",to:"/system/users/disabled"}];break}this.listUserOrganizations()},async listUserOrganizations(){this.loadingSomethingBigger=!0;let e=(await c.whoAmILocally()).userId;console.log((await c.whoAmILocally()).userId,e);let[t,i]=await g(c.listUserOrganizations(e));this.loadingSomethingBigger=!1,t||(this.allOrganizations=i||[],this.numUsers=this.allOrganizations.length,this.numSysAdmins=this.allOrganizations.filter((e=>"SYS_ADMIN"===e.authority)).length,this.numActiveUsers=this.allOrganizations.filter((e=>!0===e.isActive)).length,this.numInactiveUsers=this.allOrganizations.filter((e=>!1===e.isActive)).length,this.numEnabledUsers=this.allOrganizations.filter((e=>!0===e.enabled)).length,this.numDisabledusers=this.allOrganizations.filter((e=>!1===e.enabled)).length)},selectApplication(e){window.location.assign(e)},gotoPage(e){console.log(e),window.location.assign(e)},selectOrganization(e){this.notOuterPage?window.location.assign(`/#/organizations/${e.organizationId}`):(this.selectedOrganization=e,this.selectedOrganizationName=e.organizationName,this.selectedOrganizationId=e.organizationId,this.selectedId="object"===typeof e.organizationId?e.id.organizationId:e.organizationId,this.rightSideBarP=!1,this.$nextTick((()=>this.rightSideBarP=!0)))}},computed:{activeElement(){return this.activeElement_},cardContainerClass(){if(this.$q.screen.gt.xs)return"grid-masonry grid-masonry--"+(this.$q.screen.gt.sm?"6":"4")}}},h=m,u=i("2877"),b=i("9989"),p=i("6b1d"),z=i("24e8"),f=i("f09f"),y=i("a370"),w=i("eaac"),O=i("27f9"),v=i("0016"),k=i("9c40"),_=i("714f"),S=i("eebe"),q=i.n(S),U=Object(u["a"])(h,a,s,!1,null,null,null);t["default"]=U.exports;q()(U,"components",{QPage:b["a"],QLinearProgress:p["a"],QDialog:z["a"],QCard:f["a"],QCardSection:y["a"],QTable:w["a"],QInput:O["a"],QIcon:v["a"],QBtn:k["a"]}),q()(U,"directives",{Ripple:_["a"]})}}]);