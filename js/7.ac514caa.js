(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{4253:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=this,s=e.$createElement,a=e._self._c||s;return e.recoveringPassword?"DESKTOP"===e.cysmed.platform?a("div",[e._v("\n  Contact your system administrator to recorver your password. Or use the web\n  portal and reregister this software to recover the admin account.\n")]):a("q-form",{staticClass:"text-white bg-secondary",on:{submit:e.onSubmitRecover,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"email",label:e.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(s){return t.isValidEmail()||e.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("div",{staticClass:"q-pt-md"},[a("q-btn",{attrs:{label:e.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1),a("div",{staticClass:"flex flex-center"},[a("p",{staticClass:"text-center items-center q-pa-md"},[a("a",{attrs:{href:"#"},on:{click:e.unrecoverPassword}},[e._v("Log in?")])])])],1):a("q-form",{staticClass:"text-white bg-secondary",on:{submit:e.onSubmit,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"email",label:e.translate("FIELDS.EMAIL"),hint:e.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(s){return t.isValidEmail()||e.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("q-input",{attrs:{filled:"",type:"password",label:e.translate("FIELDS.PASSWORD"),"lazy-rules":"",rules:[function(t){return null!==t&&""!==t||e.translate("FIELDS.ERRORS.PASSWORD.MISSINGOWN")}],"error-message":e.passwordErrorMessage},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("div",{staticClass:"q-pa-none"},[a("q-btn",{attrs:{label:e.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1),a("p",{staticClass:"text-center items-center q-pa-md"},[a("a",{attrs:{href:"#"},on:{click:e.recoverPassword}},[e._v("Forgot password?")])])],1)},r=[],o=(s("ddb0"),s("cf57"));const i=s("1712").to,l=s("20e6"),n=s("c2a1").default,c=s("ea76").default;var u={name:"adminLogin",props:["cysmed","setRecoveringPassword"],data(){return{translate:c.translate,email:"",password:"",passwordErrorMessage:"",recoveringPassword:!1}},created(){},methods:{recoverPassword(t){t.preventDefault(),this.recoveringPassword=!0},unrecoverPassword(t){t.preventDefault(),this.recoveringPassword=!1},isValidEmail(){const t=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return t.test(this.email)||this.translate("FIELDS.ERRORS.EMAIL.INVALID")},showCustom(t=""){const e=this.$q.dialog({title:t,message:"",progress:{spinner:o["a"],color:"primary"},persistent:!0,ok:!1}),s=setInterval((()=>{!1===this.working&&(clearInterval(s),e.hide())}),500)},async onSubmitRecover(){n.setSettings({TBURL:l["TB_URL"]});l["TB_URL"];let t={email:this.email,password:this.password,authority:"SYS_ADMIN"};this.working=!0,this.showCustom();let[e,s]=await i(n.initializeResetPassword(t));if(this.working=!1,e)return this.loggedin=!1,this.$q.notify({type:"negative",message:this.translate(e.error||e.message)}),this.password="",void(this.passwordErrorMessage=this.translate(e.error||e.message));this.$q.notify({type:"positive",message:"log in successful"});let a=n.getDefaultPageAfterLogin();a.match(/^http/)&&(a=a.split(/^http[s]*:\/\/[^\/]*/)[1]),void 0===a&&(a=""),a.match(/#/)&&(a=a.split(/#/)[1]),alert(a),this.$router.push({path:a})},async onSubmit(){n.setSettings({TBURL:l["TB_URL"]});l["TB_URL"];let t={email:this.email,password:this.password,authority:"SYS_ADMIN"};this.working=!0,this.showCustom();let[e,s]=await i(n.login(t));if(this.working=!1,e)return this.loggedin=!1,this.$q.notify({type:"negative",message:this.translate(e.error||e.message||e||"ACTIONS.ERRORS.LOGINFAILED")}),this.password="",void(this.passwordErrorMessage=this.translate(e.error||e.message||e||"FIELDS.ERRORS.EMAILORPASSWORD"));this.$q.notify({type:"positive",message:"log in successful"});let a=n.getDefaultPageAfterLogin();console.log(a),console.log(a),console.log(a),console.log(a),console.log(a),console.log(a),console.log(a),window.location.assign(n.getDefaultPageAfterLogin())},onReset(){this.email=null,this.password=null}}},d=u,m=s("2877"),p=s("0378"),g=s("27f9"),h=s("9c40"),w=s("eebe"),S=s.n(w),I=Object(m["a"])(d,a,r,!1,null,null,null);e["default"]=I.exports;S()(I,"components",{QForm:p["a"],QInput:g["a"],QBtn:h["a"]})}}]);