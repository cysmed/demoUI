(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{4444:function(e,t,s){"use strict";s("d61f")},"996f":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{staticClass:"flex flex-center",attrs:{padding:""}},[e.loaded?s("q-card",{staticClass:"items-center text-center bg-white"},[s("q-card-section",[s("div",{staticClass:"row"},[s("div",{staticClass:"items-left text-left"},[s("div",{staticClass:"text-h4"},[e._v("Profile")]),s("div",[e._v(e._s(e.email))])]),s("q-space"),s("div",{staticClass:"items-left text-left text-weight-thin"},[s("div",[e._v("Last Login")]),s("div",[e._v(e._s(e.lastLogin))])])],1)]),s("q-card-section",[s("q-form",{ref:"changeUserNameForm",staticClass:"q-gutter-md text-white",on:{submit:e.changeuserNames,reset:e.onReset}},[s("q-input",{attrs:{filled:"",type:"text",label:"First Name",hint:"First Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your first name"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),s("q-input",{attrs:{filled:"",type:"text",label:"Last Name",hint:"Last Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your last name"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}}),s("q-input",{attrs:{filled:"",mask:"date",label:"Date of Birth(YYYY/MM/DD)",rules:["date"]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}}),s("q-select",{attrs:{"use-input":"",filled:"",options:e.genders,label:"Gender","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select your gender"}]},model:{value:e.gender,callback:function(t){e.gender=t},expression:"gender"}}),s("div",{staticClass:"row"},[s("div",{staticClass:"items-left text-left"},[s("q-btn",{attrs:{label:"Change Password",color:"primary"},on:{click:function(t){e.changePasswordDialog=!0}}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"items-left text-left"},[s("q-btn",{attrs:{label:"Delete Account",color:"red"},on:{click:e.deleteAccount}})],1),s("q-space"),s("div",{staticClass:"items-left text-left"},[s("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),s("q-btn",{attrs:{label:"Save",type:"submit",color:"green",disable:e.userEditted}})],1)],1)],1)],1)],1):e._e(),s("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.changePasswordDialog,callback:function(t){e.changePasswordDialog=t},expression:"changePasswordDialog"}},[s("q-card",[s("q-card-section",{staticClass:"bg-secondary text-white text-h5 text-center"},[e._v("\n        Change Password\n      ")]),s("q-card-section",[s("q-form",{ref:"changePasswordForm",staticClass:"q-gutter-md text-white",on:{submit:e.changePassword,reset:e.onResetChangePassword}},[s("q-input",{attrs:{filled:"",type:"password",label:"Current Password",hint:"Current Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your current pasword"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.currentPassword,callback:function(t){e.currentPassword=t},expression:"currentPassword"}}),s("q-input",{attrs:{filled:"",type:"password",label:"New Password",hint:"New Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your new pasword"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),s("q-input",{attrs:{filled:"",type:"password",label:"Confirm New Password",hint:"Confirm New Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please confirm your new pasword"}],"error-message":e.confirmPasswordError},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.newPasswordAgain,callback:function(t){e.newPasswordAgain=t},expression:"newPasswordAgain"}}),s("div",{staticClass:"row"},[s("q-space"),s("div",{staticClass:"items-left text-left"},[s("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),s("q-btn",{attrs:{label:"Change Password",type:"submit",color:"green"}})],1)],1)],1)],1)],1)],1)],1)},r=[];s("ddb0"),s("cf57"),s("07de");const i=s("40cd").default,n=s("1712").to,o=s("ff00"),l=s("6daa").default;var d={name:"logout",components:{},data(){return{profilePath:"",userData:{},email:"",firstName:"",lastName:"",firstNameOriginal:"",lastNameOriginal:"",genderOriginal:"",dobOriginal:"",currentPassword:"",newPassword:"",newPasswordAgain:"",loaded:!1,changePasswordDialog:!1,lastLogin:"",confirmPasswordError:"",gender:"Male",genders:["Male","Female"],dob:""}},async created(){i.setSettings({TBURL:o["TB_URL"]}),i.setVue(this),await i.authGuard(),i.showLoading();let[e,t]=await n(i.readUserData());e||(i.hideLoading(),this.setUserData(t))},methods:{onReset(){this.firstName=this.firstNameOriginal,this.lastName=this.lastNameOriginal,this.gender=this.genderOriginal,this.dob=this.dobOriginal},onResetChangePassword(){this.currentPassword="",this.newPassword="",this.newPasswordAgain=""},setUserData(e){this.userData=e,this.email=e.email,this.firstName=e.firstName,this.lastName=e.lastName,this.firstNameOriginal=e.firstName,this.lastNameOriginal=e.lastName,this.dob=e.dateOfBirth,this.dobOriginal=e.dateOfBirth,this.gender=e.gender,this.genderOriginal=e.gender,this.loaded=!0,this.lastLogin=new Date(e.additionalInfo.lastLoginTs).toISOString()},async changeuserNames(){return new Promise((async(e,t)=>{if(this.notUserEditted())return e(!1);let s=this.userData;s.firstName=this.firstName,s.lastName=this.lastName,s.gender=this.gender,s.dateOfBirth=this.dob,i.showLoading();let[a,r]=await n(i.saveUserData(s));if(i.hideLoading(),a)return this.$q.notify({type:"negative",message:a.msg||a}),e(!1);this.setUserData(r),e(r)}))},async changePassword(){return new Promise((async(e,t)=>{if(this.newPassword!==this.newPasswordAgain)return this.newPasswordAgain="",this.confirmPasswordError="Passwords don't match",e(!1);let s={oldpassword:this.currentPassword,password:this.newPassword};i.showLoading({message:"Changing Password"});let[a,r]=await n(i.changePassword(s));if(i.hideLoading(),a)return this.$q.notify({type:"negative",message:a.response.data.error||a.msg||a.response.data.message||a.message||a}),e(!1);this.$q.notify({type:"positive",message:"Password changed."}),this.changePasswordDialog=!1,e(r)}))},async deleteAccount(){return new Promise((async(e,t)=>{let[s,a]=await n(l.confirm(this,"Are you sure you want to delete your account?","Delete Account"));return s?e(!1):(i.showLoading({message:"Deleting Account"}),[s,a]=await n(i.deleteUser(this.userData.userId,!0)),i.hideLoading(),s?(this.$q.notify({type:"negative",message:s.msg||s}),e(!1)):(this.$q.notify({type:"positive",message:"Your account has been deleted"}),void window.location.assign("/")))}))},submitChangeUserName(){this.$refs.changeUserNameForm.submit()},submitChangePassword(){this.$refs.changePasswordForm.submit()},notUserEditted(){return this.firstName===this.firstNameOriginal&&this.lastName===this.lastNameOriginal&&this.dob===this.dobOriginal&&this.gender===this.genderOriginal}},computed:{userEditted(){return this.firstName===this.firstNameOriginal&&this.lastName===this.lastNameOriginal&&this.dob===this.dobOriginal&&this.gender===this.genderOriginal}}},c=d,u=(s("4444"),s("2877")),g=s("9989"),h=s("f09f"),m=s("a370"),f=s("2c91"),w=s("0378"),y=s("27f9"),p=s("ddd8"),b=s("9c40"),P=s("24e8"),N=s("eebe"),C=s.n(N),k=Object(u["a"])(c,a,r,!1,null,"ca73eeac",null);t["default"]=k.exports;C()(k,"components",{QPage:g["a"],QCard:h["a"],QCardSection:m["a"],QSpace:f["a"],QForm:w["a"],QInput:y["a"],QSelect:p["a"],QBtn:b["a"],QDialog:P["a"]})},d61f:function(e,t,s){}}]);