(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{3120:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"padding bg-grey-1"},[e.rightSideBar?a("rightSideBar",{attrs:{main:e.main}}):e._e(),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.createUserDialog,callback:function(t){e.createUserDialog=t},expression:"createUserDialog"}},[a("q-card",{staticClass:"q-ma-md"},[a("q-card-section",{staticClass:"bg-secondary text-white text-center"},[a("div",{staticClass:"text-h6"},[e._v("CysmedHub")])]),a("q-card-section",{staticClass:"bg-secondary text-white"},[a("registrationForm",{attrs:{inside:"true"}})],1)],1)],1),a("breadcrumbs",{attrs:{links:e.links}}),a("div",{staticClass:"row q-gutter-lg q-ma-none q-pa-none"},[a("cardTotal",{staticClass:"col-12 col-lg-2 col-md-3 col-sm-12 bg-transparent q-ma-none",attrs:{title:"ALL USERS","background-color":"bg-primary","icon-name":"person",total:e.numUsers}}),a("cardTotal",{staticClass:"col-12 col-lg-2 col-md-3 col-sm-12 bg-transparent q-ma-none",attrs:{title:"SYS_ADMIN","background-color":"bg-primary","icon-name":"settings",total:e.numSysAdmins,link:"/#/system/users/sys_admins"}}),a("cardTotal",{staticClass:"col-12 col-lg-2 col-md-3 col-sm-12 bg-transparent q-ma-none",attrs:{title:"ACTIVE","background-color":"bg-primary","icon-name":"do_not_disturb_off",total:e.numActiveUsers,link:"/#/system/users/active"}}),a("cardTotal",{staticClass:"col-12 col-lg-2 col-md-3 col-sm-12 bg-transparent q-ma-none",attrs:{title:"INACTIVE","background-color":"bg-primary","icon-name":"do_not_disturb_on",total:e.numInactiveUsers,link:"/#/system/users/inactive"}}),a("cardTotal",{staticClass:"col-12 col-lg-2 col-md-3 col-sm-12 bg-transparent q-ma-none",attrs:{title:"ENABLED","background-color":"bg-primary","icon-name":"people",total:e.numEnabledUsers,link:"/#/system/users/enabled"}}),a("cardTotal",{staticClass:"col-12 col-lg-2 col-md-3 col-sm-12 bg-transparent q-ma-none",attrs:{title:"DISABLED","background-color":"bg-primary","icon-name":"person_off",total:e.numDisabledusers,link:"/#/system/users/disabled"}})],1),a("q-table",{staticClass:"col",attrs:{title:"Users",dense:"",data:e.allUsers,columns:e.columns,filter:e.filter,"row-key":"index"},on:{"row-click":e.selectUser},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.fetchUsers()}}})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"add_circle",side:""},on:{click:function(t){e.createUserDialog=!0}}})],1)]},proxy:!0}])})],1)},i=[],n=(a("ddb0"),a("cf57"),a("310f")),l=a("2cbd"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card",{staticClass:"bg-white",attrs:{flat:""}},[a("q-card-section",{staticClass:"flex flex-center"},[a("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"bg-primary cursor-pointer q-hoverable",staticStyle:{width:"80vw"},on:{click:function(t){return e.gotoPage(e.localLink)}}},[a("q-card-section",{staticClass:"text-center"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-3 flex flex-center"},[a("q-icon",{staticStyle:{"font-size":"3em"},attrs:{name:e.iconName,color:"white"}})],1),a("div",{staticClass:"col"},[a("p",{staticClass:"text-bold"},[e._v(e._s(e.title))]),a("h5",{ref:"number",staticClass:"q-ma-none"},[e._v(e._s(e.total))])])])])],1)],1)],1)},o=[],c={props:["title","total","backgroundColor","iconName","link"],mounted(){this.link?this.localLink=this.link:this.localLink=window.location.href},created(){this.link?this.localLink=this.link:this.localLink=window.location.href},computed:{},watch:{},data(){return{localLink:window.location.href,options:{separator:"."}}},methods:{gotoPage(e){console.log(e),window.location.assign(e)}}},d=c,m=(a("d30f"),a("2877")),u=a("f09f"),b=a("a370"),g=a("0016"),h=a("714f"),p=a("eebe"),f=a.n(p),y=Object(m["a"])(d,r,o,!1,null,"aa7de262",null),w=y.exports;f()(y,"components",{QCard:u["a"],QCardSection:b["a"],QIcon:g["a"]}),f()(y,"directives",{Ripple:h["a"]});var q=a("5757"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-drawer",{staticClass:"bg-primary",attrs:{bordered:"",side:"right",width:e.rightSideBarSize,overlay:"",breakpoint:2,behavior:"desktop"},model:{value:e.rightSidebarOpen,callback:function(t){e.rightSidebarOpen=t},expression:"rightSidebarOpen"}},[e.main.loadingSomething?a("q-linear-progress",{attrs:{indeterminate:"",color:"negative"}}):e._e(),a("userSideBar",{attrs:{main:e.main}})],1)},k=[],S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v(e._s(e.main.selectedEmail))]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("User details")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent"}}):e._e(),e.openedEditing&&e.editted?a("q-btn",{attrs:{fab:"",icon:"done",color:"red"}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.reset}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}}),a("q-tab",{attrs:{name:"logins",label:"Logins"}}),a("q-tab",{attrs:{name:"organizations",label:"Organizations"}}),a("q-tab",{attrs:{name:"facilities",label:"Facilities"}}),a("q-tab",{attrs:{name:"registrations",label:"Registrations"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none full-width q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("userDetails",{attrs:{main:e.main}})],1),a("q-tab-panel",{attrs:{name:"logins"}},[e._v(" ...LOGIN... ")]),a("q-tab-panel",{attrs:{name:"organizations"}},[e._v(" ...LOGIN... ")]),a("q-tab-panel",{attrs:{name:"facilities"}},[e._v(" ...LOGIN... ")]),a("q-tab-panel",{attrs:{name:"registrations"}},[e._v(" ...LOGIN... ")])],1)],1)],1)},U=[],C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"q-pa-sm"},[a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Display activation link"},on:{click:e.displayActivationLink}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Resend activation"},on:{click:e.resendActivationEmail}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Login as User"},on:{click:e.loginAsUser}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Delete User"},on:{click:e.deleteUser}})],1),a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.createUser,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:"first name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your name"}]},model:{value:e.main.selectedRow.firstName,callback:function(t){e.$set(e.main.selectedRow,"firstName",t)},expression:"main.selectedRow.firstName"}}),a("q-input",{attrs:{filled:"",type:"text",label:"last name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your name"}]},model:{value:e.main.selectedRow.lastName,callback:function(t){e.$set(e.main.selectedRow,"lastName",t)},expression:"main.selectedRow.lastName"}}),a("q-input",{attrs:{filled:"",type:"text",label:"authority","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your name"}]},model:{value:e.main.selectedRow.authority,callback:function(t){e.$set(e.main.selectedRow,"authority",t)},expression:"main.selectedRow.authority"}}),a("q-select",{attrs:{"use-input":"",filled:"",options:e.genders,label:"Gender","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select your gender"}]},model:{value:e.main.selectedRow.gender,callback:function(t){e.$set(e.main.selectedRow,"gender",t)},expression:"main.selectedRow.gender"}}),a("q-input",{attrs:{filled:"",mask:"date",label:"Date of Birth(YYYY/MM/DD)",rules:["date",function(e){return e&&e.length>0||"Please enter your dob"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.main.selectedRow.dateOfBirth,callback:function(t){e.$set(e.main.selectedRow,"dateOfBirth",t)},expression:"main.selectedRow.dateOfBirth"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.main.selectedRow.dateOfBirth,callback:function(t){e.$set(e.main.selectedRow,"dateOfBirth",t)},expression:"main.selectedRow.dateOfBirth"}}),a("q-checkbox",{staticClass:"col text-black",attrs:{label:"Active"},model:{value:e.main.selectedRow.isActive,callback:function(t){e.$set(e.main.selectedRow,"isActive",t)},expression:"main.selectedRow.isActive"}}),a("q-checkbox",{staticClass:"col text-black",attrs:{label:"Enabled"},model:{value:e.main.selectedRow.enabled,callback:function(t){e.$set(e.main.selectedRow,"enabled",t)},expression:"main.selectedRow.enabled"}}),a("div",[a("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1),a("activationLink",{attrs:{alert:e.alert,alertUserId:e.alertUserId,main:e.main}})],1)],1)},x=[],R=a("7c83");a("bc3a");const _=a("1712").to,Q=a("ff00"),I=a("40cd").default,L=a("6daa").default;var A={name:"userDetails",props:["main"],components:{activationLink:R["a"]},async created(){I.setSettings({TBURL:Q["TB_URL"]}),I.setVue(this);let[e,t]=await _(I.whoAmILocally());t&&(this.whoami=t)},data(){return{whoami:{},alert:!1,alertUserId:""}},methods:{async deleteUser(e){return new Promise((async(e,t)=>{if(this.whoami.userId===this.main.selectedRow.userId)return this.$q.notify({type:"negative",message:"You can't delete you own account from here."}),t("same account");let[a,s]=await _(L.confirm(this,`Are you sure you want to delete ${this.main.selectedRow.email} account?`,"Delete Account"));return a?e(!1):(this.main.loadingSomething=!0,[a,s]=await _(I.deleteUser(this.main.selectedRow.userId)),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Account for ${this.main.selectedRow.email} has been deleted.`}),void await this.main.listUsers()))}))},async loginAsUser(e){return new Promise((async(e,t)=>{this.main.loadingSomething=!0;let[a,s]=await _(I.loginasUser(this.main.selectedRow.userId));this.main.loadingSomething=!1,a?(this.loggedin=!1,this.$q.notify({type:"negative",message:a.error||a.message||"failed to log in"})):window.location.assign("#/home")}))},async resendActivationEmail(){return new Promise((async(e,t)=>{this.main.loadingSomething=!0;let[a,s]=await _(I.sendActivationEmail({userId:this.main.selectedRow.userId,firstName:this.main.selectedRow.firstName,lastName:this.main.selectedRow.lastName,email:this.main.selectedRow.email,authority:this.main.selectedRow.authority,dateOfBirth:this.main.selectedRow.dateOfBirth,gender:this.main.selectedRow.gender},{activationEmail:!0,showActivationLink:!1},!0));if(this.main.loadingSomething=!1,this.working=!1,a){a=a.msg||a.message||a.error||a;try{a=JSON.parse(a)}catch(i){}if("object"===typeof a){let e=Object.keys(a);a=a[e[0]]}this.$q.notify({type:"negative",message:a}),e(!1)}else this.$q.notify({type:"positive",message:`Activation email has been sent to ${this.main.selectedRow.email}`})}))},displayActivationLink(){this.alert=!1,this.$nextTick((()=>this.alert=!0)),this.alertUserId=this.main.selectedRow.userId}},computed:{}},N=A,B=a("9c40"),T=a("0378"),E=a("27f9"),$=a("ddd8"),D=a("7cbe"),O=a("52ee"),P=a("8f8e"),z=a("7f67"),j=Object(m["a"])(N,C,x,!1,null,null,null),F=j.exports;f()(j,"components",{QBtn:B["a"],QForm:T["a"],QInput:E["a"],QSelect:$["a"],QIcon:g["a"],QPopupProxy:D["a"],QDate:O["a"],QCheckbox:P["a"]}),f()(j,"directives",{ClosePopup:z["a"]});a("bc3a"),a("1712").to,a("9fea")();var Y={name:"userSideBar",props:["main"],created(){},components:{userDetails:F},data(){return{rightSidebarOpen:!0,tab:"details",editted:!1,openedEditing:!1}},methods:{closeSelf(){this.main.rightSideBar=!1},reset(){this.openedEditing=!1,this.editted=!1}},computed:{}},M=Y,G=a("65c6"),V=a("6ac5"),H=a("de5e"),J=a("429bb"),W=a("7460"),K=a("eb85"),X=a("adad"),Z=a("823b"),ee=Object(m["a"])(M,S,U,!1,null,null,null),te=ee.exports;f()(ee,"components",{QToolbar:G["a"],QToolbarTitle:V["a"],QBtn:B["a"],QPageSticky:H["a"],QTabs:J["a"],QTab:W["a"],QSeparator:K["a"],QTabPanels:X["a"],QTabPanel:Z["a"]});a("bc3a"),a("1712").to,a("9fea")();var ae={name:"rightSideBar",props:["main"],created(){},components:{userSideBar:te},data(){return{rightSidebarOpen:!0,tab:"login"}},methods:{},computed:{rightSideBarSize(){return this.$q.screen.lt.xs||this.$q.screen.lt.sm||this.$q.screen.lt.md?document.getElementsByTagName("body")[0].clientWidth:.75*document.getElementsByTagName("body")[0].clientWidth}}},se=ae,ie=a("9404"),ne=a("6b1d"),le=Object(m["a"])(se,v,k,!1,null,null,null),re=le.exports;f()(le,"components",{QDrawer:ie["a"],QLinearProgress:ne["a"],QToolbar:G["a"],QToolbarTitle:V["a"],QBtn:B["a"],QTabs:J["a"],QTab:W["a"],QSeparator:K["a"],QTabPanels:X["a"],QTabPanel:Z["a"]});const oe=a("ff00"),ce=a("40cd").default,de=a("1712").to;var me={name:"PageIndex",components:{loginForm:n["a"],breadcrumbs:l["a"],cardTotal:w,registrationForm:q["a"],rightSideBar:re},data(){return{main:this,loadingSomething:!1,rightSideBar:!1,createUserDialog:!1,loaded:!0,links:[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"}],checkedLoggedIn:!1,loggedIn:!1,listHck:[{name:"Users",icon:"settings",link:"/#/system/users",Authority:"Manage Users and Organizations",description:"Manage Users and Organizations"}],filter:"",columnsHck:[],columns:[{name:"firstName",label:"First Name",field:"firstName"},{name:"lastName",label:"Last Name",field:"lastName"},{name:"email",label:"Email",field:"email"}],numUsers:0,numSysAdmins:0,numActiveUsers:0,numInactiveUsers:0,numEnabledUsers:0,numDisabledusers:0,allUsers:[],selectedRow:{}}},async created(){ce.setVue(this),ce.setSettings({TBURL:oe["TB_URL"]}),ce.showLoading();let[e,t]=await de(ce.isLoggedIn());ce.hideLoading(),this.checkedLoggedIn=!0,!e&&t||window.location.assign("#/"),await this.listUsers()},methods:{async listUsers(){ce.showLoading();let[e,t]=await de(ce.listAllUsers());console.log(t),ce.hideLoading(),this.allUsers=t||[],this.numUsers=this.allUsers.length,this.numSysAdmins=this.allUsers.filter((e=>"SYS_ADMIN"===e.authority)).length,this.numActiveUsers=this.allUsers.filter((e=>!0===e.isActive)).length,this.numInactiveUsers=this.allUsers.filter((e=>!1===e.isActive)).length,this.numEnabledUsers=this.allUsers.filter((e=>!0===e.enabled)).length,this.numDisabledusers=this.allUsers.filter((e=>!1===e.enabled)).length},selectApplication(e){window.location.assign(e)},gotoPage(e){console.log(e),window.location.assign(e)},selectUser(e,t){this.selectedUser=!0,this.selectedEmail=t.email,this.selectedId="object"===typeof t.id?t.id.id:t.id,this.selectedFirstName=t.firstName,this.selectedLastName=t.lastName,this.selectedRow=t,console.log("clicked on",t),this.rightSideBar=!1,this.$nextTick((()=>this.rightSideBar=!0))}},computed:{cardContainerClass(){if(this.$q.screen.gt.xs)return"grid-masonry grid-masonry--"+(this.$q.screen.gt.sm?"6":"4")}}},ue=me,be=a("9989"),ge=a("24e8"),he=a("eaac"),pe=a("bd08"),fe=a("db86"),ye=a("42a1"),we=Object(m["a"])(ue,s,i,!1,null,null,null);t["default"]=we.exports;f()(we,"components",{QPage:be["a"],QDialog:ge["a"],QCard:u["a"],QCardSection:b["a"],QTable:he["a"],QInput:E["a"],QIcon:g["a"],QBtn:B["a"],QTr:pe["a"],QTd:fe["a"],QPopupEdit:ye["a"]})},"359c":function(e,t,a){},d30f:function(e,t,a){"use strict";a("359c")}}]);