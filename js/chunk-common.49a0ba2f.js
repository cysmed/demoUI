(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"07de":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card",{staticClass:"my-card"},[a("q-card-section",{staticClass:"bg-secondary text-white text-center"},[a("div",{staticClass:"text-h6"},[e._v("CysmedHub")]),a("q-tabs",{staticClass:"text-white",model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"login",icon:"login",label:"Login"}}),a("q-tab",{attrs:{name:"register",icon:"person_add",label:"Register"}})],1)],1),a("q-card-section",{staticClass:"bg-secondary text-white q-pa-none"},[a("q-tab-panels",{staticClass:"bg-secondary q-ma-none full-width q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"login"}},[a("loginForm")],1),a("q-tab-panel",{attrs:{name:"register"}},[a("registrationForm")],1)],1)],1)],1)},s=[],n=a("310f"),o=a("5757"),r={name:"authForms",components:{loginForm:n["a"],registrationForm:o["a"]},props:{},async created(){},data(){return{tab:"login",loggedin:!1,working:!1}},methods:{}},l=r,c=(a("e12e"),a("2877")),d=a("f09f"),m=a("a370"),g=a("429bb"),u=a("7460"),h=a("adad"),p=a("823b"),b=a("eebe"),f=a.n(b),y=Object(c["a"])(l,i,s,!1,null,"64b66aa8",null);t["a"]=y.exports;f()(y,"components",{QCard:d["a"],QCardSection:m["a"],QTabs:g["a"],QTab:u["a"],QTabPanels:h["a"],QTabPanel:p["a"]})},"0924":function(e,t,a){"use strict";a.r(t);const i=a("76cd");t["default"]={home:i}},"2cbd":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",[a("q-breadcrumbs-el",{attrs:{icon:"home",to:"/"}}),e._l(e.links,(function(e){return a("q-breadcrumbs-el",{key:e.link,attrs:{label:e.label,icon:e.icon,to:e.to}})}))],2)],1)},s=[],n={name:"breadcrumbs",props:{links:{type:Array}},data(){return{}},methods:{}},o=n,r=a("2877"),l=a("ead5"),c=a("079e"),d=a("eebe"),m=a.n(d),g=Object(r["a"])(o,i,s,!1,null,null,null);t["a"]=g.exports;m()(g,"components",{QBreadcrumbs:l["a"],QBreadcrumbsEl:c["a"]})},"310f":function(e,t,a){"use strict";var i=function(){var e=this,t=this,a=t.$createElement,i=t._self._c||a;return i("q-form",{staticClass:"text-white bg-secondary",on:{submit:t.onSubmit,reset:t.onReset}},[i("q-input",{attrs:{filled:"",type:"email",label:"email",hint:"email","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your email address"},function(t){return e.isValidEmail()||"Invalid email address"}]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),i("q-input",{attrs:{filled:"",type:"password",label:"Password","lazy-rules":"",rules:[function(e){return null!==e&&""!==e||"Please enter your password"}],"error-message":t.passwordErrorMessage},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),i("div",{staticClass:"q-pa-md"},[i("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),i("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1)],1)},s=[],n=(a("ddb0"),a("cf57"));const o=a("1712").to,r=a("ff00"),l=a("40cd").default;var c={name:"loginForm",data(){return{email:"",password:"",passwordErrorMessage:""}},methods:{isValidEmail(){const e=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return e.test(this.email)||"Invalid email"},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:n["a"],color:"primary"},persistent:!0,ok:!1}),a=setInterval((()=>{!1===this.working&&(clearInterval(a),t.hide())}),500)},async onSubmit(){l.setSettings({TBURL:r["TB_URL"]});r["TB_URL"];let e={email:this.email,password:this.password};this.working=!0,this.showCustom();let[t,a]=await o(l.login(e));if(this.working=!1,t)return this.loggedin=!1,this.$q.notify({type:"negative",message:t.error||t.message||"failed to log in"}),this.password="",void(this.passwordErrorMessage=t.error||t.message||"wrong email/password");this.$q.notify({type:"positive",message:"log in successful"});l.getDefaultPageAfterLogin("");window.location.assign(l.getDefaultPageAfterLogin())},onReset(){this.email=null,this.password=null}}},d=c,m=a("2877"),g=a("0378"),u=a("27f9"),h=a("9c40"),p=a("eebe"),b=a.n(p),f=Object(m["a"])(d,i,s,!1,null,null,null);t["a"]=f.exports;b()(f,"components",{QForm:g["a"],QInput:u["a"],QBtn:h["a"]})},"46c6":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card",{staticClass:"bg-white",attrs:{flat:""}},[a("q-card-section",{staticClass:"flex flex-center"},[a("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"cursor-pointer q-hoverable",class:e.backgroundColor,staticStyle:{width:"80vw"},on:{click:function(t){return e.gotoPage(e.localLink)}}},[a("q-card-section",{staticClass:"text-center"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-3 flex flex-center"},[a("q-icon",{staticStyle:{"font-size":"3em"},attrs:{name:e.iconName,color:"white"}})],1),a("div",{staticClass:"col"},[a("p",{staticClass:"text-bold"},[e._v(e._s(e.title))]),a("h5",{ref:"number",staticClass:"q-ma-none"},[e._v(e._s(e.total))])])])])],1)],1)],1)},s=[],n={props:["title","total","backgroundColor","iconName","link"],mounted(){this.link?this.localLink=this.link:this.localLink=window.location.href},created(){this.link?this.localLink=this.link:this.localLink=window.location.href},computed:{},watch:{},data(){return{localLink:window.location.href,options:{separator:"."}}},methods:{gotoPage(e){console.log(e),window.location.assign(e)}}},o=n,r=(a("e0ea"),a("2877")),l=a("f09f"),c=a("a370"),d=a("0016"),m=a("714f"),g=a("eebe"),u=a.n(g),h=Object(r["a"])(o,i,s,!1,null,"2f5d3873",null);t["a"]=h.exports;u()(h,"components",{QCard:l["a"],QCardSection:c["a"],QIcon:d["a"]}),u()(h,"directives",{Ripple:m["a"]})},"4d6d":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-drawer",{staticClass:"bg-primary",attrs:{bordered:"",side:"right",width:e.rightSideBarSize,overlay:"",breakpoint:2,behavior:"desktop"},model:{value:e.rightSidebarOpen,callback:function(t){e.rightSidebarOpen=t},expression:"rightSidebarOpen"}},[e.main.loadingSomething?a("q-linear-progress",{attrs:{indeterminate:"",color:"negative"}}):e._e(),"user"===e.objType?a("userSideBar",{attrs:{main:e.main}}):e._e(),"organization"===e.objType?a("organizationSideBar",{attrs:{main:e.main}}):e._e()],1)},s=[],n=(a("cf57"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v(e._s(e.main.selectedEmail))]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("User details")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.main.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent",disable:!0}}):e._e(),e.openedEditing&&e.main.editted?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}}),a("q-tab",{attrs:{name:"auditLogs",label:"Audit Logs"}}),a("q-tab",{attrs:{name:"organizations",label:"Organizations"}}),a("q-tab",{attrs:{name:"facilities",label:"Facilities"}}),a("q-tab",{attrs:{name:"registrations",label:"Registrations"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none  q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("userDetails",{attrs:{main:e.main,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1),a("q-tab-panel",{attrs:{name:"auditLogs"}},[a("auditLogs",{attrs:{main:e.main,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1),a("q-tab-panel",{attrs:{name:"organizations"}},[a("organizationsPage",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset,notOuterPage:!0}})],1),a("q-tab-panel",{attrs:{name:"facilities"}},[e._v(" Under construction ")]),a("q-tab-panel",{attrs:{name:"registrations"}},[e._v(" Under construction ")])],1)],1)],1)}),o=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.openedEditing?e._e():a("div",{staticClass:"q-pa-sm"},[a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Display activation link"},on:{click:e.displayActivationLink}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Resend activation"},on:{click:e.resendActivationEmail}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Login as User"},on:{click:e.loginAsUser}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Delete User"},on:{click:e.deleteUser}})],1),a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.editUser}},[a("q-input",{attrs:{filled:"",type:"text",label:"first name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!e.openedEditing},model:{value:e.selectedRow.firstName,callback:function(t){e.$set(e.selectedRow,"firstName",t)},expression:"selectedRow.firstName"}}),a("q-input",{attrs:{filled:"",type:"text",label:"last name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!e.openedEditing},model:{value:e.selectedRow.lastName,callback:function(t){e.$set(e.selectedRow,"lastName",t)},expression:"selectedRow.lastName"}}),a("q-select",{attrs:{filled:"",options:e.authorities,label:"Authority","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select an authority"}],disable:!e.openedEditing,clearable:!1},model:{value:e.selectedRow.authority,callback:function(t){e.$set(e.selectedRow,"authority",t)},expression:"selectedRow.authority"}}),a("q-select",{attrs:{filled:"",options:e.genders,label:"Gender","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select a gender"}],disable:!e.openedEditing},model:{value:e.selectedRow.gender,callback:function(t){e.$set(e.selectedRow,"gender",t)},expression:"selectedRow.gender"}}),a("q-input",{attrs:{filled:"",mask:"date",label:"Date of Birth(YYYY/MM/DD)",rules:["date",function(e){return e&&e.length>0||"Please enter a dob"}],disable:!e.openedEditing},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.selectedRow.dateOfBirth,callback:function(t){e.$set(e.selectedRow,"dateOfBirth",t)},expression:"selectedRow.dateOfBirth"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.selectedRow.dateOfBirth,callback:function(t){e.$set(e.selectedRow,"dateOfBirth",t)},expression:"selectedRow.dateOfBirth"}}),a("q-checkbox",{staticClass:"col text-black",attrs:{label:"Enabled",disable:!e.openedEditing},model:{value:e.selectedRow.enabled,callback:function(t){e.$set(e.selectedRow,"enabled",t)},expression:"selectedRow.enabled"}}),a("activationLink",{attrs:{alert:e.alert,alertUserId:e.alertUserId,main:e.main}})],1)],1)},l=[],c=(a("ddb0"),a("7c83"));a("bc3a");const d=a("1712").to,m=a("ff00"),g=a("40cd").default,u=a("6daa").default;var h={name:"userDetails",props:["main","openedEditing","submit","reset"],components:{activationLink:c["a"]},async created(){g.setSettings({TBURL:m["TB_URL"]}),g.setVue(this),this.selectedRow=JSON.parse(JSON.stringify(this.main.selectedRow));let[e,t]=await d(g.whoAmILocally());t&&(this.whoami=t)},data(){return{selectedRow:{},whoami:{},userChanged:!1,alert:!1,alertUserId:"",genders:["Male","Female"],authorities:["SYS_ADMIN","SYS_USER"]}},methods:{async editUser(){return new Promise((async(e,t)=>{let a=this.selectedRow;this.main.loadingSomething=!0;let[i,s]=await d(g.saveUserData(a));if(this.main.loadingSomething=!1,i)return this.$q.notify({type:"negative",message:i.msg||i}),e(!1);this.$q.notify({type:"positive",message:`Saved changes for ${this.selectedRow.email}`}),await this.main.listUsers(),this.main.editted=!1,e(!0)}))},async deleteUser(e){return new Promise((async(e,t)=>{if(this.whoami.userId===this.main.selectedRow.userId)return this.$q.notify({type:"negative",message:"You can't delete you own account from here."}),t("same account");let[a,i]=await d(u.confirm(this,`Are you sure you want to delete ${this.main.selectedRow.email} account?`,"Delete Account"));return a?e(!1):(this.main.loadingSomething=!0,[a,i]=await d(g.deleteUser(this.main.selectedRow.userId)),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Account for ${this.main.selectedRow.email} has been deleted.`}),void await this.main.listUsers()))}))},async loginAsUser(e){return new Promise((async(e,t)=>{let a=(await g.whoAmILocally()).userId;if(a===this.main.selectedRow.userId)return this.$q.notify({type:"negative",message:"You are already logged in"}),e();this.main.loadingSomething=!0;let[i,s]=await d(g.loginasUser(this.main.selectedRow.userId));this.main.loadingSomething=!1,i?(this.loggedin=!1,this.$q.notify({type:"negative",message:i.error||i.message||"failed to log in"})):window.location.assign("#/home")}))},async resendActivationEmail(){return new Promise((async(e,t)=>{this.main.loadingSomething=!0;let[a,i]=await d(g.sendActivationEmail({userId:this.main.selectedRow.userId,firstName:this.main.selectedRow.firstName,lastName:this.main.selectedRow.lastName,email:this.main.selectedRow.email,authority:this.main.selectedRow.authority,dateOfBirth:this.main.selectedRow.dateOfBirth,gender:this.main.selectedRow.gender},{activationEmail:!0,showActivationLink:!1},!0));if(this.main.loadingSomething=!1,this.working=!1,a){a=a.msg||a.message||a.error||a;try{a=JSON.parse(a)}catch(s){}if("object"===typeof a){let e=Object.keys(a);a=a[e[0]]}this.$q.notify({type:"negative",message:a}),e(!1)}else this.$q.notify({type:"positive",message:`Activation email has been sent to ${this.main.selectedRow.email}`})}))},displayActivationLink(){this.alert=!1,this.$nextTick((()=>this.alert=!0)),this.alertUserId=this.main.selectedRow.userId}},computed:{userEditted(){return(this.main.selectedRow.firstName!==this.originalSelectedUser.firstName||this.main.selectedRow.lastName!==this.originalSelectedUser.lastName||this.main.selectedRow.authority!==this.originalSelectedUser.authority||this.main.selectedRow.dateOfBirth!==this.originalSelectedUser.dateOfBirth||this.main.selectedRow.gender!==this.originalSelectedUser.gender||this.main.selectedRow.enabled!==this.originalSelectedUser.enabled)&&(this.main.editted=!0)}},watch:{selectedRow:{handler(e){JSON.stringify(this.selectedRow)!==JSON.stringify(this.main.selectedRow)?this.main.editted=!0:this.main.editted=!1},deep:!0},submit(e){e&&this.$refs.userRegistrationForm.submit()},reset(e){e&&(this.selectedRow=JSON.parse(JSON.stringify(this.main.selectedRow)))}}},p=h,b=a("2877"),f=a("9c40"),y=a("0378"),w=a("27f9"),v=a("ddd8"),q=a("0016"),k=a("7cbe"),S=a("52ee"),T=a("8f8e"),x=a("7f67"),C=a("eebe"),R=a.n(C),z=Object(b["a"])(p,r,l,!1,null,null,null),O=z.exports;R()(z,"components",{QBtn:f["a"],QForm:y["a"],QInput:w["a"],QSelect:v["a"],QIcon:q["a"],QPopupProxy:k["a"],QDate:S["a"],QCheckbox:T["a"]}),R()(z,"directives",{ClosePopup:x["a"]});var _=a("82ef"),D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"padding"},[e.loadingSomethingBigger?a("q-linear-progress",{attrs:{indeterminate:"",color:"negative"}}):e._e(),e.rightSideBarP?a("rightSideBar",{attrs:{main:e.main,objType:"organization"}}):e._e(),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.createOrganizationDialog,callback:function(t){e.createOrganizationDialog=t},expression:"createOrganizationDialog"}},[a("q-card",{staticClass:"q-ma-md"},[a("q-card-section",{staticClass:"bg-secondary text-white text-center"},[a("div",{staticClass:"text-h6"},[e._v("Create Organization")])]),a("q-card-section",{staticClass:"bg-secondary text-white"},[a("createOrganization",{attrs:{main:e.main}})],1)],1)],1),e.notOuterPage?e._e():a("breadcrumbs",{attrs:{links:e.links}}),a("q-table",{attrs:{grid:"","card-container-class":e.cardContainerClass,data:e.allOrganizations,columns:e.columns,title:"Organizations",filter:e.filter,"row-key":"name","hide-header":"","hide-bottom":"","rows-per-page-options":[0]},on:{"row-click":e.selectOrganization},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.listUserOrganizations()}}})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"add_circle",side:""},on:{click:function(t){e.createOrganizationDialog=!0}}})],1)]},proxy:!0},{key:"item",fn:function(t){return[a("div",{staticClass:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},[a("q-card",{staticClass:"bg-primary",staticStyle:{height:"200px"}},[a("q-card-section",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"flex flex-center text-h6 bg-green q-mb-none q-pb-none full-height cursor-pointer q-hoverable",on:{click:function(a){return e.selectOrganization(t.row)}}},[a("strong",[e._v(e._s(t.row.organizationName))])]),a("q-btn",{staticClass:"text-white absolute-top-right q-ma-sm",attrs:{icon:"delete",color:"red"},on:{click:function(a){return e.deleteOrganization(t.row)}}}),a("q-btn",{staticClass:"text-white absolute-top-left q-ma-sm",attrs:{icon:"input",color:"secondary"},on:{click:function(a){return e.manageUsers(t.row)}}})],1)],1)]}}])})],1)},$=[],M=(a("5319"),a("2cbd")),L=a("c64e");const Q=a("ff00"),A=a("40cd").default,P=a("1712").to,I=a("6daa").default;var N={name:"organizationsPage",props:["notOuterPage"],components:{breadcrumbs:M["a"],createOrganization:L["a"],rightSideBar:ze},watch:{$route(e,t){this.setfilters(e.path)}},data(){return{activeElement_:"",main:this,editted:!1,loadingSomething:!1,loadingSomethingBigger:!1,rightSideBarP:!1,createOrganizationDialog:!1,loaded:!0,links:[{label:"Organizations",icon:"corporate_fare",to:"/organizations"}],checkedLoggedIn:!1,loggedIn:!1,listHck:[{name:"Users",icon:"settings",link:"/#/system/users",Authority:"Manage Users and Organizations",description:"Manage Users and Organizations"}],filter:"",columnsHck:[],columns:[{name:"organizationName",label:"Organization",field:"organizationName",sortable:!0},{name:"lastName",label:"Last Name",field:"lastName",sortable:!0},{name:"email",label:"Email",field:"email",sortable:!0}],numUsers:0,numSysAdmins:0,numActiveUsers:0,numInactiveUsers:0,numEnabledUsers:0,numDisabledusers:0,allOrganizations:[],selectedRow:{}}},async created(){this.setfilters(),A.setVue(this),A.setSettings({TBURL:Q["TB_URL"]}),await this.listUserOrganizations();let e,t,a=window.location.hash.replace(/^[#]*[\/]*/,""),i=a.match(/(organizations)\/([0-9a-z-]+)$/);i&&"organizations"===i[1]&&(e=i[2]),e&&(this.allOrganizations.map((a=>{a.organizationId===e&&(t=a)})),t&&this.selectOrganization(t))},methods:{manageUsers(e){window.location.assign(`/#/organizations/${e.organizationId}/users`)},async deleteOrganization(e){let{organizationId:t,organizationName:a}=e;return new Promise((async(t,a)=>{let[i,s]=await P(I.confirm(this,`Are you sure you want to delete ${e.organizationName}?`,"Delete Organization"));return i?t(!1):(this.main.loadingSomething=!0,[i,s]=await P(A.deleteOrganization(e.organizationId)),this.main.loadingSomething=!1,i?(this.$q.notify({type:"negative",message:i.msg||i}),t(!1)):(this.$q.notify({type:"positive",message:`Organization ${e.organizationName} has been deleted.`}),void await this.listUserOrganizations()))}))},setfilters(e=!1){let t=(e||window.location.hash).replace(/[\/]*[#]*\//,"");switch(t){case"system/users":this.filters={},this.activeElement_="users",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"}];break;case"system/users/sys_admin":this.filters={authority:"SYS_ADMIN"},this.activeElement_="sys_admin",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Sys_Admins",icon:"settings",to:"/system/users/sys_admin"}];break;case"system/users/active":this.filters={isActive:!0},this.activeElement_="active",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Active",icon:"do_not_disturb_off",to:"/system/users/active"}];break;case"system/users/inactive":this.filters={isActive:!1},this.activeElement_="inactive",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Inactive",icon:"do_not_disturb_on",to:"/system/users/inactive"}];break;case"system/users/enabled":this.filters={enabled:!0},this.activeElement_="enabled",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Enabled",icon:"people",to:"/system/users/enabled"}];break;case"system/users/disabled":this.filters={enabled:!1},this.activeElement_="disabled",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Disabled",icon:"person_off",to:"/system/users/disabled"}];break}this.listUserOrganizations()},async listUserOrganizations(){this.loadingSomethingBigger=!0;let e=(await A.whoAmILocally()).userId;console.log((await A.whoAmILocally()).userId,e);let[t,a]=await P(A.listUserOrganizations(e));this.loadingSomethingBigger=!1,t||(this.allOrganizations=a||[],this.numUsers=this.allOrganizations.length,this.numSysAdmins=this.allOrganizations.filter((e=>"SYS_ADMIN"===e.authority)).length,this.numActiveUsers=this.allOrganizations.filter((e=>!0===e.isActive)).length,this.numInactiveUsers=this.allOrganizations.filter((e=>!1===e.isActive)).length,this.numEnabledUsers=this.allOrganizations.filter((e=>!0===e.enabled)).length,this.numDisabledusers=this.allOrganizations.filter((e=>!1===e.enabled)).length)},selectApplication(e){window.location.assign(e)},gotoPage(e){console.log(e),window.location.assign(e)},selectOrganization(e){this.notOuterPage?window.location.assign(`/#/organizations/${e.organizationId}`):(this.selectedOrganization=e,this.selectedOrganizationName=e.organizationName,this.selectedOrganizationId=e.organizationId,this.selectedId="object"===typeof e.organizationId?e.id.organizationId:e.organizationId,this.rightSideBarP=!1,this.$nextTick((()=>this.rightSideBarP=!0)))}},computed:{activeElement(){return this.activeElement_},cardContainerClass(){if(this.$q.screen.gt.xs)return"grid-masonry grid-masonry--"+(this.$q.screen.gt.sm?"6":"4")}}},U=N,E=a("9989"),F=a("6b1d"),B=a("24e8"),Y=a("f09f"),j=a("a370"),H=a("eaac"),J=a("714f"),Z=Object(b["a"])(U,D,$,!1,null,null,null),V=Z.exports;R()(Z,"components",{QPage:E["a"],QLinearProgress:F["a"],QDialog:B["a"],QCard:Y["a"],QCardSection:j["a"],QTable:H["a"],QInput:w["a"],QIcon:q["a"],QBtn:f["a"]}),R()(Z,"directives",{Ripple:J["a"]});a("bc3a"),a("1712").to,a("9fea")();var G={name:"userSideBar",props:["main"],created(){this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{userDetails:O,auditLogs:_["a"],organizationsPage:V},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBar=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},W=G,K=a("65c6"),X=a("6ac5"),ee=a("de5e"),te=a("429bb"),ae=a("7460"),ie=a("eb85"),se=a("adad"),ne=a("823b"),oe=Object(b["a"])(W,n,o,!1,null,null,null),re=oe.exports;R()(oe,"components",{QToolbar:K["a"],QToolbarTitle:X["a"],QBtn:f["a"],QPageSticky:ee["a"],QTabs:te["a"],QTab:ae["a"],QSeparator:ie["a"],QTabPanels:se["a"],QTabPanel:ne["a"]});var le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v(e._s(e.main.selectedOrganization.organizationName))]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("Organization details")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.main.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent",disable:!0}}):e._e(),e.openedEditing&&e.main.editted?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}}),a("q-tab",{attrs:{name:"facilities",label:"Facilities"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none  q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("organizationDetails",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1),a("q-tab-panel",{attrs:{name:"facilities"}},[e._v(" Under construction ")])],1)],1)],1)},ce=[],de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.openedEditing?e._e():a("div",{staticClass:"q-pa-sm"},[a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Users"},on:{click:e.manageUsers}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Facilities"},on:{click:e.manageFacilities}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Admins"},on:{click:e.manageAdmins}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Delete Organization"},on:{click:e.deleteOrganization}})],1),a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.editOrganization}},[a("q-input",{attrs:{filled:"",type:"text",label:"Organzation Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!e.openedEditing},model:{value:e.selectedOrganization.organizationName,callback:function(t){e.$set(e.selectedOrganization,"organizationName",t)},expression:"selectedOrganization.organizationName"}})],1)],1)},me=[];a("bc3a");const ge=a("1712").to,ue=a("ff00"),he=a("40cd").default,pe=a("6daa").default;var be={name:"userDetails",props:["main","openedEditing","submit","reset","immediateMain"],components:{activationLink:c["a"]},beforeDestroy(){this.main.loadingSomething=!1},async created(){he.setSettings({TBURL:ue["TB_URL"]}),he.setVue(this),this.selectedOrganization=JSON.parse(JSON.stringify(this.main.selectedOrganization));let[e,t]=await ge(he.whoAmILocally());t&&(this.whoami=t)},data(){return{selectedOrganization:{},whoami:{},userChanged:!1,alert:!1}},methods:{async editOrganization(){return new Promise((async(e,t)=>{let a={organizationName:this.selectedOrganization.organizationName,organizationId:this.selectedOrganization.organizationId};this.main.loadingSomething=!0;let[i,s]=await ge(he.editOrganization(a));if(this.main.loadingSomething=!1,console.log(i),i)return this.$q.notify({type:"negative",message:i.msg||i}),e(!1);this.$q.notify({type:"positive",message:`Saved changes for ${this.selectedOrganization.organizationName}`}),await this.main.listUserOrganizations(),this.immediateMain.openedEditing=!1,this.main.selectedOrganization=this.selectedOrganization,this.main.editted=!1,e(!0)}))},async deleteOrganization(e){return new Promise((async(e,t)=>{let[a,i]=await ge(pe.confirm(this,`Are you sure you want to delete ${this.main.selectedOrganization.organizationName}?`,"Delete Organization"));return a?e(!1):(this.main.loadingSomething=!0,[a,i]=await ge(he.deleteOrganization(this.main.selectedOrganization.organizationId)),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Organization ${this.main.selectedOrganization.organizationName} has been deleted.`}),void await this.main.listUserOrganizations()))}))},async manageAdmins(e){window.location.assign(`/#/organizations/${this.main.selectedOrganization.organizationId}/admins`)},async manageFacilities(){window.location.assign(`/#/organizations/${this.main.selectedOrganization.organizationId}/facilities`)},manageUsers(){window.location.assign(`/#/organizations/${this.main.selectedOrganization.organizationId}/users`)}},computed:{userEditted(){return(this.main.selectedOrganization.firstName!==this.originalSelectedUser.firstName||this.main.selectedOrganization.lastName!==this.originalSelectedUser.lastName||this.main.selectedOrganization.authority!==this.originalSelectedUser.authority||this.main.selectedOrganization.dateOfBirth!==this.originalSelectedUser.dateOfBirth||this.main.selectedOrganization.gender!==this.originalSelectedUser.gender||this.main.selectedOrganization.enabled!==this.originalSelectedUser.enabled)&&(this.main.editted=!0)}},watch:{selectedOrganization:{handler(e){JSON.stringify(this.selectedOrganization)!==JSON.stringify(this.main.selectedOrganization)?this.main.editted=!0:this.main.editted=!1},deep:!0},submit(e){e&&this.$refs.userRegistrationForm.submit()},reset(e){e&&(this.selectedOrganization=JSON.parse(JSON.stringify(this.main.selectedOrganization)))}}},fe=be,ye=Object(b["a"])(fe,de,me,!1,null,null,null),we=ye.exports;R()(ye,"components",{QBtn:f["a"],QForm:y["a"],QInput:w["a"]});a("bc3a"),a("1712").to,a("9fea")();var ve={name:"organizationSideBar",props:["main"],created(){this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{organizationDetails:we},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBar=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},qe=ve,ke=Object(b["a"])(qe,le,ce,!1,null,null,null),Se=ke.exports;R()(ke,"components",{QToolbar:K["a"],QToolbarTitle:X["a"],QBtn:f["a"],QPageSticky:ee["a"],QTabs:te["a"],QTab:ae["a"],QSeparator:ie["a"],QTabPanels:se["a"],QTabPanel:ne["a"]});a("bc3a"),a("1712").to,a("9fea")();var Te={name:"rightSideBar",props:["main","objType"],created(){},components:{userSideBar:re,organizationSideBar:Se},data(){return{rightSidebarOpen:!0,tab:"login"}},methods:{},computed:{rightSideBarSize(){return this.$q.screen.lt.xs||this.$q.screen.lt.sm||this.$q.screen.lt.md?document.getElementsByTagName("body")[0].clientWidth:.75*document.getElementsByTagName("body")[0].clientWidth}}},xe=Te,Ce=a("9404"),Re=Object(b["a"])(xe,i,s,!1,null,null,null),ze=t["a"]=Re.exports;R()(Re,"components",{QDrawer:Ce["a"],QLinearProgress:F["a"],QToolbar:K["a"],QToolbarTitle:X["a"],QBtn:f["a"],QTabs:te["a"],QTab:ae["a"],QSeparator:ie["a"],QTabPanels:se["a"],QTabPanel:ne["a"]})},5757:function(e,t,a){"use strict";var i=function(){var e=this,t=this,a=t.$createElement,i=t._self._c||a;return i("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:t.createUser,reset:t.onReset}},[i("q-input",{attrs:{filled:"",type:"text",label:"first name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your name"}]},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.firstName,callback:function(e){t.firstName=e},expression:"firstName"}}),i("q-input",{attrs:{filled:"",type:"text",label:"last name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your name"}]},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.lastName,callback:function(e){t.lastName=e},expression:"lastName"}}),i("q-select",{attrs:{"use-input":"",filled:"",options:t.genders,label:"Gender","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select your gender"}]},model:{value:t.gender,callback:function(e){t.gender=e},expression:"gender"}}),i("q-input",{attrs:{filled:"",mask:"date",label:"Date of Birth(YYYY/MM/DD)",rules:["date",function(e){return e&&e.length>0||"Please enter your dob"}]},scopedSlots:t._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[i("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[i("q-date",{model:{value:t.dob,callback:function(e){t.dob=e},expression:"dob"}},[i("div",{staticClass:"row items-center justify-end"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:t.dob,callback:function(e){t.dob=e},expression:"dob"}}),i("q-input",{attrs:{filled:"",type:"email",label:"email","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your email address"},function(t){return e.isValidEmail()||"Invalid email address"}]},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),t.showAccept?i("terms",{attrs:{accept:t.accept,main:t.main}}):t._e(),t.showActivation?i("div",{staticClass:"col"},[i("q-checkbox",{staticClass:"col",attrs:{label:"Send Activation Email"},model:{value:t.activationEmail,callback:function(e){t.activationEmail=e},expression:"activationEmail"}}),i("q-checkbox",{staticClass:"col",attrs:{label:"Show Activation link"},model:{value:t.showActivationLink,callback:function(e){t.showActivationLink=e},expression:"showActivationLink"}})],1):t._e(),i("div",[i("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),i("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1),i("activationLink",{attrs:{alert:t.alert,alertUserId:t.alertUserId}})],1)},s=[],n=(a("ddb0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toggle",{attrs:{color:"secondary"},on:{input:e.toggled},model:{value:e.localAccept,callback:function(t){e.localAccept=t},expression:"localAccept"}}),e._v("I\n  accept the\n  "),a("a",{staticClass:"text-underline text-italic",staticStyle:{"text-decoration":"underline",cursor:"pointer"},attrs:{clickable:""},on:{click:e.showTerms}},[e._v("terms and conditions")]),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.termsDialog,callback:function(t){e.termsDialog=t},expression:"termsDialog"}},[a("q-card",[a("q-card-section",{staticClass:"q-pt-none"},[""!==e.termsText?a("q-markdown",[e._v("\n          "+e._s(e.termsText)+"\n        ")]):e._e()],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Ok",color:"primary"}})],1)],1)],1)],1)}),o=[],r=a("cf57");a("bc3a"),a("1712").to;const l=a("9fea")();var c={name:"terms",props:{accept:Boolean,main:Function},created(){this.myParent=this.main(),this.localAccept=this.accept},data(){return{localAccept:!1,myParent:null,termsText:"",termsDialog:!1}},methods:{async showTerms(){this.termsDialog=!0,this.termsText=l},toggled(e){this.$nextTick((function(){this.myParent.changeAccept(e)}))},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:r["a"],color:"primary"},persistent:!0,ok:!1}),a=setInterval((()=>{!1===this.working&&(clearInterval(a),t.hide())}),500)}}},d=c,m=a("2877"),g=a("9564"),u=a("24e8"),h=a("f09f"),p=a("a370"),b=a("4b7e"),f=a("9c40"),y=a("7f67"),w=a("eebe"),v=a.n(w),q=Object(m["a"])(d,n,o,!1,null,null,null),k=q.exports;v()(q,"components",{QToggle:g["a"],QDialog:u["a"],QCard:h["a"],QCardSection:p["a"],QCardActions:b["a"],QBtn:f["a"]}),v()(q,"directives",{ClosePopup:y["a"]});var S=a("7c83");a("bc3a");const T=a("1712").to,x=a("ff00"),C=a("40cd").default;var R={name:"registrationForm",components:{terms:k,activationLink:S["a"]},props:["inside"],async created(){if(C.setSettings({TBURL:x["TB_URL"]}),C.setSettings(x),this.inside)this.showAccept=!1,this.accept=!0,this.showActivation=!0,this.activationEmail=!1,this.showActivationLink=!0;else{let[e,t]=await T(C.isLoggedIn());t&&window.location.assign("#/home")}},data(){return{activationPage:"",accept:!1,showAccept:!0,showActivation:!1,showActivationLink:!1,activationEmail:!0,email:"",firstName:"",lastName:"",gender:"Male",genders:["Male","Female"],dob:"",password:"",cpassword:"",passwordErrorMessage:"",users:[],alert:!1,alertUserId:null}},methods:{changeAccept(e){this.accept=e},submit(){this.$refs.userRegistrationForm.submit()},main(){return this},isValidEmail(){const e=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return e.test(this.email)||"Invalid email"},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:r["a"],color:"primary"},persistent:!0,ok:!1}),a=setInterval((()=>{!1===this.working&&(clearInterval(a),t.hide())}),500)},async createUser(){return C.setSettings({TBURL:x["TB_URL"]}),new Promise((async(e,t)=>{if(!0!==this.accept)return this.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:"You need to read and accept the terms and conditions"}),e(!1);this.working=!0,this.showCustom();let[a,i]=await T(C.createUser({email:this.email,firstName:this.firstName,lastName:this.lastName,gender:this.gender,dateOfBirth:this.dob,authority:"SYS_USER"},{activationEmail:this.activationEmail,showActivationLink:this.showActivationLink},!0));if(this.working=!1,a){a=a.msg||a.message||a.error||a;try{a=JSON.parse(a)}catch(s){}if("object"===typeof a){let e=Object.keys(a);a=a[e[0]]}this.$q.notify({type:"negative",message:a}),e(!1)}else console.log(this.showActivationLink),this.showActivationLink?(this.alert=!0,this.alertUserId=i):this.$q.notify({type:"positive",message:"Registration successful. Check your email to activate you account."})}))},onReset(){this.email=null,this.firstName=null,this.lastName=null,this.password=null,this.cpassword=null,this.accept=!1}}},z=R,O=a("0378"),_=a("27f9"),D=a("ddd8"),$=a("0016"),M=a("7cbe"),L=a("52ee"),Q=a("8f8e"),A=Object(m["a"])(z,i,s,!1,null,null,null);t["a"]=A.exports;v()(A,"components",{QForm:O["a"],QInput:_["a"],QSelect:D["a"],QIcon:$["a"],QPopupProxy:M["a"],QDate:L["a"],QBtn:f["a"],QToggle:g["a"],QCheckbox:Q["a"],QDialog:u["a"],QCard:h["a"],QCardSection:p["a"]}),v()(A,"directives",{ClosePopup:y["a"]})},"6daa":function(e,t,a){"use strict";a.r(t);var i=a("cf57");const s=a("e350").default,n=a("4556");class o extends s{constructor(){super()}async confirm(e,t,a="Confirm"){return new Promise(((i,s)=>{e.$q.dialog({title:a,message:t,cancel:!0,persistent:!0}).onOk((()=>i(!0))).onOk((()=>i(!0))).onCancel((()=>s(!0))).onDismiss((()=>s(!0)))}))}showDialog(e,t="",a="",s=0){let o=n({length:10});const r=e.$q.dialog({title:t,message:a,progress:{spinner:i["a"],color:"primary"},persistent:!0,ok:!1});let l,c,d=s;r.update({message:`${d} secs`});const m=()=>{clearInterval(l),clearInterval(c),r.hide()};return c=setInterval((()=>{s>0?(d--,0===d&&m()):d++,r.update({message:`${d} secs`})}),1e3),this.once(o,m),o}}t["default"]=new o},"6f24":function(e,t,a){},7687:function(e,t,a){e.exports=a.p+"img/cysmedinfo.d33fe8a7.png"},"76cd":function(e){e.exports=JSON.parse('[{"name":"System Tools","icon":"settings","link":"/#/system","description":"Tools for System Administration","children":[{"name":"Users","icon":"settings","link":"/#/system/users","description":"Manage Users","authorities":["SYS_ADMIN","ORG_ADMIN"]},{"name":"Organizations","icon":"corporate_fare","link":"/#/system/organizations","description":"Organizations Management","authorities":["SYS_ADMIN","ORG_ADMIN"]},{"name":"Custom Landing","icon":"house","link":"/#/system/landing_page","description":"Default page after log in","authorities":["SYS_USER","SYS_ADMIN"]},{"name":"Audit Logs","icon":"track_changes","link":"/#/system/audit_logs","description":"Audit logs and logins","authorities":["SYS_USER","SYS_ADMIN"]}]},{"name":"Organizations","icon":"corporate_fare","link":"/#/organizations","description":"Organizations Management"},{"name":"Pharmacy","icon":"medication","link":"/#/pharmacy","description":"Retail Pharmacy"},{"name":"Distributor","icon":"medication","link":"/#/distributor","description":"Pharmaceutical Distributor"},{"name":"Hospital","icon":"local_hospital","link":"/#/hospital","description":"Hospital Management"},{"name":"Laboratory","icon":"science","link":"/#/laboratory","description":"Laboratory Management"},{"name":"Professional Registrations","icon":"app_registration","link":"/#/professional_registrations","description":"Register as a health professional"},{"name":"Profile Management","icon":"person","link":"/#/profile","description":"Profile"}]')},"7c83":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{attrs:{"full-width":""},model:{value:e.innerAlert,callback:function(t){e.innerAlert=t},expression:"innerAlert"}},[a("q-card",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",[a("span",{staticClass:"text-weight-bold"},[e._v("User activation link")])]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),a("q-card-section",[e._v("\n      In order to activate user use the following\n      "),a("a",{attrs:{href:e.activationPage}},[e._v("activation link")]),e._v(" :\n    ")]),a("q-card-section",{staticClass:"text-center row flex flex-center"},[a("div",{staticClass:"col text-no-wrap flex flex-center"},[a("code",{staticClass:"bg-grey-4 text-h6 text-bold q-pa-md row text-no-wrap",staticStyle:{"overflow-x":"scroll","overflow-y":"none"}},[e._v(e._s(e.activationPage))]),a("q-btn",{staticClass:"text-primary",attrs:{icon:"content_copy",flat:""},on:{click:e.copyActivationLinkToClipBoard}},[a("q-tooltip",[e._v(" Copy activation link ")])],1)],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK",color:"primary"}})],1)],1)],1)},s=[];a("ddb0"),a("cf57");const n=a("1712").to,o=a("ff00"),r=a("40cd").default;var l={name:"activationLink",components:{},props:["inside","alert","alertUserId","main"],async created(){r.setSettings({TBURL:o["TB_URL"]}),r.setSettings(o),this.showAccept=!1,this.accept=!0},data(){return{activationPage:"",accept:!1,showAccept:!0,innerAlert:!1}},watch:{async alert(e,t){this.main.loadingSomething=!0;let[a,i]=await n(r.getActivationCode(this.alertUserId));if(this.main.loadingSomething=!1,a)return void this.$q.notify({type:"negative",message:a||a.response||"Couldn't fetch activation link"});this.innerAlert=!0;let{activationCode:s}=i,o=window.location.protocol+"//"+window.location.host+`/#/activate?activateToken=${s}`;this.activationPage=o}},methods:{copyActivationLinkToClipBoard(){navigator.clipboard.writeText(this.activationPage).then((()=>{this.$q.notify({type:"positive",message:"Activation link copied!"})}),(()=>{}))}}},c=l,d=a("2877"),m=a("24e8"),g=a("f09f"),u=a("a370"),h=a("65c6"),p=a("6ac5"),b=a("9c40"),f=a("05c0"),y=a("4b7e"),w=a("7f67"),v=a("eebe"),q=a.n(v),k=Object(d["a"])(c,i,s,!1,null,null,null);t["a"]=k.exports;q()(k,"components",{QDialog:m["a"],QCard:g["a"],QCardSection:u["a"],QToolbar:h["a"],QToolbarTitle:p["a"],QBtn:b["a"],QTooltip:f["a"],QCardActions:y["a"]}),q()(k,"directives",{ClosePopup:w["a"]})},"82ef":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("q-tabs",{staticClass:"text-black bg-secondary",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"logins",label:"Logins"}}),a("q-tab",{attrs:{name:"activeDevices",label:"Active Devices"}}),a("q-tab",{attrs:{name:"create",label:"Create"}}),a("q-tab",{attrs:{name:"update",label:"Update"}}),a("q-tab",{attrs:{name:"delete",label:"Delete"}})],1),a("q-tab-panels",{staticClass:"q-ma-none full-width q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{staticClass:"q-pa-none q-ma-none",attrs:{name:"logins"}},[a("logins",{attrs:{main:e.main,immediateMain:e.immediateMain}})],1),a("q-tab-panel",{staticClass:"q-pa-none q-ma-none",attrs:{name:"activeDevices"}},[a("logins",{attrs:{main:e.main,immediateMain:e.immediateMain}})],1)],1)],1)},s=[],n=(a("5319"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("q-table",{staticClass:"col",attrs:{title:"Logins",dense:"",data:e.allLogins,columns:e.columns,filter:e.filter,"row-key":"loginId",selection:"multiple",selected:e.selected},on:{"row-click":e.selectLogin,"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"top-left",fn:function(){return[a("dateTimeRange",{attrs:{immediateMain:e.myImmediateMain,id:e.id}})]},proxy:!0},{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",outlined:"",dense:"",debounce:"300",placeholder:"Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),a("q-btn",{attrs:{flat:"",disable:!e.selectedRows}},[a("q-icon",{attrs:{color:"primary",name:"logout",side:""},on:{click:function(t){return e.logoutSelected()}}})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.fetchLogins()}}})],1)]},proxy:!0},{key:"body-cell-ip",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[t.row.isMe?a("q-icon",{staticClass:"text-white",attrs:{name:"person"}}):e._e(),a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-browser",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-os",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-platform",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-createdAt",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-email",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-active",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[t.row[t.col.name]?e._e():a("q-chip",{staticClass:"text-weight-bolder",attrs:{color:!0===t.row.active?"green":"red","text-color":"white",dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))]),t.row[t.col.name]?a("q-btn",{staticClass:"bg-white",attrs:{flat:"",icon:"logout"},on:{click:function(a){return e.logoutFromBtn(t.row)}}}):e._e()],1)]}}])})],1)}),o=[],r=(a("ddb0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-btn",{staticClass:"bg-primary text-white",attrs:{"no-caps":"",icon:"schedule",label:e.dateRangeSelectLabel}},[a("q-menu",{ref:"menu0",staticClass:"q-ma-md q-pa-md"},[a("q-card",{staticClass:"q-pa-none q-ma-none",staticStyle:{width:"300px"}},[a("q-card-section",{staticClass:"q-pa-none q-ma-none"},[a("div",[a("q-radio",{attrs:{val:"last",label:"Last"},on:{input:e.dateRangeSelectTypeChanged},model:{value:e.dateRangeSelectType,callback:function(t){e.dateRangeSelectType=t},expression:"dateRangeSelectType"}}),"last"===e.dateRangeSelectType?a("div",{staticClass:"row q-pa-md"},[e.advancedForLastFilter?e._e():a("q-select",{staticClass:"col-8",attrs:{options:e.dateRangeSelectTypeLasts,label:"Last","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please provide an input"}]},model:{value:e.dateRangeSelectTypeLast,callback:function(t){e.dateRangeSelectTypeLast=t},expression:"dateRangeSelectTypeLast"}}),e.advancedForLastFilter?a("div",{staticClass:"col-8"},[a("q-input",{attrs:{label:"Days",type:"number"},model:{value:e.days,callback:function(t){e.days=t},expression:"days"}}),a("q-input",{attrs:{label:"hours",type:"number"},model:{value:e.hours,callback:function(t){e.hours=t},expression:"hours"}}),a("q-input",{attrs:{label:"Minutes",type:"number"},model:{value:e.minutes,callback:function(t){e.minutes=t},expression:"minutes"}}),a("q-input",{attrs:{label:"Seconds",type:"number"},model:{value:e.seconds,callback:function(t){e.seconds=t},expression:"seconds"}})],1):e._e(),a("span",{staticClass:"float-right"},[a("q-list",[a("q-item-section",[a("q-item-label",{attrs:{caption:""}},[e._v("Advanced")]),a("q-item-label",[a("q-toggle",{staticClass:"float-right",attrs:{color:"secondary"},model:{value:e.advancedForLastFilter,callback:function(t){e.advancedForLastFilter=t},expression:"advancedForLastFilter"}})],1)],1)],1)],1)],1):e._e()],1),a("div",{staticClass:"q-ma-none q-pa-none"},[a("q-radio",{attrs:{val:"timePeriod",label:"Time Period"},on:{input:e.dateRangeSelectTypeChanged},model:{value:e.dateRangeSelectType,callback:function(t){e.dateRangeSelectType=t},expression:"dateRangeSelectType"}}),"timePeriod"===e.dateRangeSelectType?a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-6",attrs:{mask:"date",label:"Date to",rules:["date",function(e){return e&&e.length>0||"Please enter a date"}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.dateTo,callback:function(t){e.dateTo=t},expression:"dateTo"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}],null,!1,2882366464),model:{value:e.dateTo,callback:function(t){e.dateTo=t},expression:"dateTo"}}),a("q-input",{staticClass:"col-6",attrs:{mask:"time",label:"Time to",rules:["time",function(e){return e&&e.length>0||"Please enter a time"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"schedule"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-time",{attrs:{"now-btn":""},model:{value:e.timeTo,callback:function(t){e.timeTo=t},expression:"timeTo"}})],1)],1)]},proxy:!0}],null,!1,789531335),model:{value:e.timeTo,callback:function(t){e.timeTo=t},expression:"timeTo"}})],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-6",attrs:{mask:"date",label:"Date from",rules:["date",function(e){return e&&e.length>0||"Please enter a date"}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.dateFrom,callback:function(t){e.dateFrom=t},expression:"dateFrom"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}],null,!1,1103465677),model:{value:e.dateFrom,callback:function(t){e.dateFrom=t},expression:"dateFrom"}}),a("q-input",{staticClass:"col-6",attrs:{mask:"time",label:"Time from",rules:["time",function(e){return e&&e.length>0||"Please enter a time"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"schedule"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-time",{attrs:{"now-btn":""},model:{value:e.timeFrom,callback:function(t){e.timeFrom=t},expression:"timeFrom"}})],1)],1)]},proxy:!0}],null,!1,94629418),model:{value:e.timeFrom,callback:function(t){e.timeFrom=t},expression:"timeFrom"}})],1)]):e._e()],1),a("div",[a("q-radio",{attrs:{val:"interval",label:"Interval"},on:{input:e.dateRangeSelectTypeChanged},model:{value:e.dateRangeSelectType,callback:function(t){e.dateRangeSelectType=t},expression:"dateRangeSelectType"}}),"interval"===e.dateRangeSelectType?a("div",{staticClass:"row q-pa-md"},[a("q-select",{staticClass:"col-12",attrs:{options:e.intervalTypes,label:"Last","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please provide an input"}]},model:{value:e.intervalType,callback:function(t){e.intervalType=t},expression:"intervalType"}})],1):e._e()],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:""},on:{click:e.cancel}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"primary"},on:{click:e.update}},[e._v("Update")])],1)],1)],1)],1)}),l=[],c=(a("26e9"),{name:"dateTimeRange",props:["main","immediateMain","id"],components:{},async created(){this.immediateMain.dateTimeRanges||(this.immediateMain.dateTimeRanges={});let e=this.immediateMain.dateTimeRanges[this.id];e||(this.dateRangeSelectType="last",this.dateRangeSelectTypeLast="1 day"),this.oldDateRangeSelectType=this.dateRangeSelectType,this.convertToOtherTypes()},data(){return{dateFrom:"2021/01/04",timeFrom:"",dateTo:"",timeTo:"",days:1,hours:0,minutes:0,seconds:0,advancedForLastFilter:!1,dateRangeSelectType:"last",dateRangeSelectLabel:"...",intervalType:"Yesterday",intervalTypes:["Yesterday","Day before yesterday","This day last week","Previous week (Sun - Sat)","Previous week (Mon - Sun)","Previous month","Previous year","Current hour","Current day","Current day so far","Current week (Sun - Sat)","Current week (Mon - Sun)","Current week so far (Sun - Sat)","Current week so far (Mon - Sun)","Current month","Current month so far","Current year","Current year so far"],dateRangeSelectTypeLast:"1 day",dateRangeSelectTypeLasts:["1 second","5 seconds","10 seconds","15 seconds","30 seconds","1 minute","2 minutes","5 minutes","10 minutes","15 minutes","30 minutes","1 hour","2 hours","5 hours","10 hours","12 hours","1 day"]}},methods:{convertToOtherTypes(e){let t,a,i=e||this.dateRangeSelectType;switch(e||"last"===i&&this.advancedForLastFilter&&(i="lastAdvanced"),i){case"last":let e=parseInt(this.dateRangeSelectTypeLast),i=this.dateRangeSelectTypeLast.split(" ").slice(-1)[0].replace(/s$/,"");switch(a=e,i){case"second":break;case"minute":a*=60;break;case"hour":a*=3600;break;case"day":a*=86400;break}this.dateRangeSelectLabel=`Last ${this.dateRangeSelectTypeLast}`,this.interval={to:"now",from:-a};let s=0,n=parseInt(a/86400);s=n>0?a%(86400*n):a;let o=parseInt(s/3600);s=o>0?s%(3600*o):s;let r=parseInt(s/60);s=r>0?s%(60*r):s;let l=s;this.dateRangeSelectTypeLastAdvanced={day:n,hour:o,min:r,sec:l},console.log(n,o,r,l),this.days=n,this.hours=o,this.minutes=r,this.seconds=l,t=new Date,this.dateTo=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeTo=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`,t=new Date(t.getTime()-1e3*a),this.dateFrom=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeFrom=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`;break;case"lastAdvanced":a=24*parseInt(this.days)*60*60+60*parseInt(this.hours)*60+60*parseInt(this.minutes)+parseInt(this.seconds),t=new Date,this.dateTo=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeTo=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`,t=new Date(t.getTime()-1e3*a),this.dateFrom=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeFrom=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`;let c=[1,5,10,15,30,1,2,5,10,15,30,1,2,5,10,12,1],d=[1,60,3600,86400],m=-1;c=c.map((e=>(1===e&&m++,e*d[m])));let g=c[0],u=c[c.length-1];c.map((e=>{e<=a&&(g=e)})),c=c.reverse(),c.map((e=>{e>=a&&(u=e)})),c=c.reverse(),this.interval={to:"now",from:-a},a=a-g<u-a?g:u;let h=c.indexOf(a);this.dateRangeSelectTypeLast=this.dateRangeSelectTypeLasts[h];let p="";this.days>0&&(""===p&&(p="Last "),p+=`${this.days} day${this.days>1?"s":""} `),this.hours>0&&(""===p&&(p="Last "),p+=`${this.hours} hour${this.hours>1?"s":""} `),this.minutes>0&&(""===p&&(p="Last "),p+=`${this.minutes} minute${this.minutes>1?"s":""} `),this.seconds>0&&(""===p&&(p="Last "),p+=`${this.seconds} second${this.seconds>1?"s":""} `),this.dateRangeSelectLabel=p;break;case"timePeriod":this.interval={to:new Date(`${this.dateTo} ${this.timeTo}`),from:new Date(`${this.dateFrom} ${this.timeFrom}`)},this.dateRangeSelectLabel=`from ${this.dateFrom} ${this.timeFrom} to ${this.dateTo} ${this.timeTo}`;break;case"interval":const b=e=>{e=e||new Date;let t=60*e.getHours()*60+60*e.getMinutes()+e.getSeconds();return t};t=new Date;let f=b(),y=new Date(t.getTime()-60*t.getMinutes()*1e3-1e3*t.getSeconds()),w=new Date(y.getTime()+36e5),v=new Date(t.getTime()-1e3*f),q=new Date(v.getTime()+864e5),k=new Date(v.getTime()-864e5),S=new Date(k.getTime()-864e5),T=(new Date).getDay(),x=new Date(v.getTime()-24*T*60*60*1e3),C=new Date(x.getTime()+6048e5),R=new Date(x.getTime()-6048e5),z=new Date(x.getTime()+864e5),O=new Date(z.getTime()+6048e5),_=new Date(R.getTime()+864e5),D=new Date(v.getTime()-24*((new Date).getDate()-1)*60*60*1e3),$=new Date(D.getTime()-1e4),M=new Date(D.getTime()-24*$.getDate()*60*60*1e3),L=($.getDate(),new Date((new Date).getFullYear(),0,0)),Q=b(L);L=new Date(L.getTime()-1e3*Q+864e5);let A=new Date(t.getFullYear()-1,0,0);Q=b(A),A=new Date(A.getTime()-1e3*Q+864e5);let P=new Date(t.getFullYear()+1,0,0);Q=b(P),P=new Date(P.getTime()-1e3*Q+864e5);let I=new Date(t.getFullYear(),t.getMonth()+1,0),N=b(I);switch(I=new Date(I.getTime()-1e3*N+864e5),console.log(x),console.log(S),console.log(R),console.log(z),console.log(D),console.log($),console.log(M),console.log(L),console.log(A),console.log({beginningOfHour:y,endofHour:w,beginningOfToday:v,endOfToday:q,beginningOfNextMonth:I,beginningOfNextYear:P}),this.intervalType){case"Yesterday":this.interval={to:v,from:k};break;case"Day before yesterday":this.interval={to:k,from:k};break;case"This day last week":let e=new Date(v.getTime()-6048e5),t=new Date(e.getTime()+864e5);this.interval={to:t,from:e};break;case"Previous week (Sun - Sat)":this.interval={to:x,from:R};break;case"Previous week (Mon - Sun)":this.interval={to:z,from:_};break;case"Previous month":this.interval={to:D,from:M};break;case"Previous year":this.interval={to:L,from:A};break;case"Current hour":this.interval={to:w,from:y};break;case"Current day":this.interval={to:q,from:v};break;case"Current day so far":this.interval={to:"now",from:v};break;case"Current week (Sun - Sat)":this.interval={to:C,from:x};break;case"Current week (Mon - Sun)":this.interval={to:O,from:z};break;case"Current week so far (Sun - Sat)":this.interval={to:"now",from:x};break;case"Current week so far (Mon - Sun)":this.interval={to:"now",from:z};break;case"Current month":this.interval={to:I,from:D};break;case"Current month so far":this.interval={to:"now",from:D};break;case"Current year":this.interval={to:P,from:D};break;case"Current year so far":this.interval={to:"now",from:L};break}this.dateRangeSelectLabel=`${this.intervalType}`;let U=this.interval.from,E=this.interval.to;"now"===E&&(E=new Date),t=E,this.dateTo=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeTo=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`,t=U,this.dateFrom=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeFrom=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`;break}},cancel(){this.$refs.menu0.toggle(),this.immediateMain.dateTimeRanges[this.id]=this.settingsOriginal},update(){this.convertToOtherTypes(!1),this.immediateMain.dateTimeRanges[this.id]||(this.immediateMain.dateTimeRanges[this.id]={});let e=["dateRangeSelectType","dateRangeSelectTypeLast","interval"];e.map((e=>this.immediateMain.dateTimeRanges[this.id][e]=this[e])),this.$refs.menu0.toggle(),this.immediateMain.dateTimeRanges[this.id].interval=this.interval,this.immediateMain.runSelected()},dateRangeSelectTypeChanged(e,t){this.convertToOtherTypes()}},computed:{},watch:{dateRangeSelectType(){let e=this.dateRangeSelectType;this.dateRangeSelectType=this.oldDateRangeSelectType,this.convertToOtherTypes(),this.dateRangeSelectType=e,this.oldDateRangeSelectType=e},advancedForLastFilter(){if(!1===this.advancedForLastFilter){let e=this.dateRangeSelectType;this.convertToOtherTypes("lastAdvanced"),this.dateRangeSelectType=e,this.oldDateRangeSelectType=e}else{let e=this.dateRangeSelectType;this.convertToOtherTypes("last"),this.dateRangeSelectType=e,this.oldDateRangeSelectType=e}}}}),d=c,m=a("2877"),g=a("9c40"),u=a("4e73"),h=a("f09f"),p=a("a370"),b=a("3786"),f=a("ddd8"),y=a("27f9"),w=a("1c1c"),v=a("4074"),q=a("0170"),k=a("9564"),S=a("0016"),T=a("7cbe"),x=a("52ee"),C=a("ca78"),R=a("4b7e"),z=a("7f67"),O=a("eebe"),_=a.n(O),D=Object(m["a"])(d,r,l,!1,null,null,null),$=D.exports;_()(D,"components",{QBtn:g["a"],QMenu:u["a"],QCard:h["a"],QCardSection:p["a"],QRadio:b["a"],QSelect:f["a"],QInput:y["a"],QList:w["a"],QItemSection:v["a"],QItemLabel:q["a"],QToggle:k["a"],QIcon:S["a"],QPopupProxy:T["a"],QDate:x["a"],QTime:C["a"],QCardActions:R["a"]}),_()(D,"directives",{ClosePopup:z["a"]});const M=a("1712").to,L=a("ff00"),Q=a("40cd").default;var A={name:"logins",props:["main","immediateMain"],components:{dateTimeRange:$},async created(){Q.setSettings({TBURL:L["TB_URL"]}),Q.setVue(this),this.fetchLogins()},data(){return{id:1,myImmediateMain:this,dateTimeRanges:{},dateRangeSelectType:"last",dateRangeSelectLabel:"",selected:[],columns:[{name:"email",label:"Email",field:"email",sortable:!0},{name:"ip",label:"IP",field:"ip",sortable:!0},{name:"browser",label:"Browser",field:"browser",sortable:!0},{name:"os",label:"OS",field:"os",sortable:!0},{name:"platform",label:"Platform",field:"platform",sortable:!0},{name:"active",label:"Active",field:"active",sortable:!0},{name:"createdAt",label:"Created",field:"createdAt",sortable:!0}],allLogins:[],selectedRow:{},filter:""}},methods:{async logoutFromBtn(e){await this.logoutSelected([e])},async logoutSelected(e){return new Promise((async(t,a)=>{let i=!1,s=(e||this.selected).map((e=>e));s.map((e=>{e.isMe&&(i=!0)})),s=s.filter((e=>!e.isMe&&""!==e.token)),s=s.map((e=>e.token)),i&&this.$q.notify({type:"negative",message:"We will not log you out from here"});let n=s.map(Q.logout);this.main.loadingSomething=!0;let[o,r]=await M(Promise.all(n));if(this.main.loadingSomething=!1,o)return this.$q.notify({type:"negative",message:o.msg||o}),t(!1);await M(this.fetchLogins()),t()}))},async runSelected(){return this.fetchLogins()},async fetchLogins(){let e={};this.main.selectedRow&&(e={userId:this.main.selectedRow.userId}),this.dateTimeRanges[this.id]||(this.dateTimeRanges[this.id]={}),this.dateTimeRanges[this.id].interval&&(e.createdAt={},this.dateTimeRanges[this.id].interval.to&&("now"===this.dateTimeRanges[this.id].interval.to?e.createdAt["lte"]=new Date:e.createdAt["lte"]=this.dateTimeRanges[this.id].interval.to),this.dateTimeRanges[this.id].interval.from&&(this.dateTimeRanges[this.id].interval.from<0?e.createdAt["gte"]=new Date((new Date).getTime()+1e3*this.dateTimeRanges[this.id].interval.from):e.createdAt["gte"]=this.dateTimeRanges[this.id].interval.from)),"activeDevices"===this.immediateMain.tab&&(e["tokenExpiry"]={gte:parseInt((new Date).getTime()/1e3)},e["token"]={ne:""}),this.main.loadingSomething=!0;let[t,a]=await M(Q.getLogins(e));this.main.loadingSomething=!1;let i=Q.currentToken();t||(a=a.map((e=>(e.active=""!==e.token,e.token===i?e.isMe=!0:e.isMe=!1,e))),this.allLogins=a)},selectLogin(e,t){t.active&&(this.selectedRow=t)}},computed:{selectedRows(){let e=this.selected.filter((e=>e.active));return e.length>0}},watch:{selectedRow:{handler(e){JSON.stringify(this.selectedRow)!==JSON.stringify(this.main.selectedRow)?this.main.editted=!0:this.main.editted=!1},deep:!0}}},P=A,I=a("9989"),N=a("eaac"),U=a("db86"),E=a("b047"),F=Object(m["a"])(P,n,o,!1,null,null,null),B=F.exports;_()(F,"components",{QPage:I["a"],QTable:N["a"],QBtn:g["a"],QMenu:u["a"],QCard:h["a"],QCardSection:p["a"],QRadio:b["a"],QCardActions:R["a"],QInput:y["a"],QIcon:S["a"],QTd:U["a"],QChip:E["a"]});a("ff00"),a("40cd").default;var Y={name:"userDetails",props:["main"],components:{logins:B},async created(){let e,t,a=window.location.hash.replace(/^[#]*[\/]*/,""),i=a.match(/(audit_logs)\/([0-9a-z-]+)[\/]*([a-zA-Z]+)/);i&&"audit_logs"===i[1]&&(e=i[2],t=i[3]),e&&(this.selectedRow={userId:e}),t&&(this.tab=t)},data(){return{tab:"logins",immediateMain:this}},methods:{},computed:{},watch:{}},j=Y,H=a("429bb"),J=a("7460"),Z=a("adad"),V=a("823b"),G=Object(m["a"])(j,i,s,!1,null,null,null);t["a"]=G.exports;_()(G,"components",{QPage:I["a"],QTabs:H["a"],QTab:J["a"],QTabPanels:Z["a"],QTabPanel:V["a"]})},"9fea":function(e,t){function a(){return"\n## Terms and Conditions\n\n...\n    "}e.exports=a},c64e:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-form",{ref:"createOrganizationForm",staticClass:"q-gutter-md text-white",on:{submit:e.createOrganization,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:"Organization name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name for your organization"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.organizationName,callback:function(t){e.organizationName=t},expression:"organizationName"}}),a("div",[a("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1)],1)},s=[];a("ddb0");const n=a("1712").to,o=a("ff00"),r=a("40cd").default;var l={name:"createOrganization",components:{},props:["main"],beforeDestroy(){this.main.loadingSomethingBigger=!1},async created(){r.setSettings({TBURL:o["TB_URL"]}),r.setSettings(o)},data(){return{organizationName:""}},methods:{submit(){this.$refs.createOrganizationForm.submit()},async createOrganization(){return r.setSettings({TBURL:o["TB_URL"]}),new Promise((async(e,t)=>{this.main.loadingSomethingBigger=!0;let a=(await r.whoAmILocally()).userId,i=this.organizationName,[s,o]=await n(r.createOrganization({organizationName:i,userId:a}));if(this.main.loadingSomethingBigger=!1,s){s=s.msg||s.message||s.error||s;try{s=JSON.parse(s)}catch(l){}if("object"===typeof s){let e=Object.keys(s);s=s[e[0]]}return this.$q.notify({type:"negative",message:s}),e(!1)}this.$q.notify({type:"positive",message:`${i} created.`}),this.main.createOrganizationDialog=!1,this.main.listUserOrganizations()}))},onReset(){this.organizationName=null}}},c=l,d=a("2877"),m=a("0378"),g=a("27f9"),u=a("9c40"),h=a("eebe"),p=a.n(h),b=Object(d["a"])(c,i,s,!1,null,null,null);t["a"]=b.exports;p()(b,"components",{QForm:m["a"],QInput:g["a"],QBtn:u["a"]})},de8b:function(e,t,a){},e0ea:function(e,t,a){"use strict";a("de8b")},e12e:function(e,t,a){"use strict";a("6f24")}}]);