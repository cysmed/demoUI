(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"07de":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-card",{staticClass:"my-card"},[s("q-card-section",{staticClass:"bg-secondary text-white text-center"},[s("div",{staticClass:"text-h6"},[e._v("CysmedHub")]),s("q-tabs",{staticClass:"text-white",model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[s("q-tab",{attrs:{name:"login",icon:"login",label:"Login"}}),s("q-tab",{attrs:{name:"register",icon:"person_add",label:"Register"}})],1)],1),s("q-card-section",{staticClass:"bg-secondary text-white q-pa-none"},[s("q-tab-panels",{staticClass:"bg-secondary q-ma-none full-width q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[s("q-tab-panel",{attrs:{name:"login"}},[s("loginForm")],1),s("q-tab-panel",{attrs:{name:"register"}},[s("registrationForm")],1)],1)],1)],1)},n=[],i=s("310f"),o=s("5757"),r={name:"authForms",components:{loginForm:i["a"],registrationForm:o["a"]},props:{},async created(){},data(){return{tab:"login",loggedin:!1,working:!1}},methods:{}},l=r,c=(s("e12e"),s("2877")),d=s("f09f"),u=s("a370"),h=s("429bb"),p=s("7460"),m=s("adad"),g=s("823b"),y=s("eebe"),w=s.n(y),f=Object(c["a"])(l,a,n,!1,null,"64b66aa8",null);t["a"]=f.exports;w()(f,"components",{QCard:d["a"],QCardSection:u["a"],QTabs:h["a"],QTab:p["a"],QTabPanels:m["a"],QTabPanel:g["a"]})},1:function(e,t){},10:function(e,t){},2:function(e,t){},"2cbd":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"q-pa-md q-gutter-sm"},[s("q-breadcrumbs",[s("q-breadcrumbs-el",{attrs:{icon:"home",to:"/"}}),e._l(e.links,(function(e){return s("q-breadcrumbs-el",{key:e.link,attrs:{label:e.label,icon:e.icon,to:e.to}})}))],2)],1)},n=[],i={name:"breadcrumbs",props:{links:{type:Array}},data(){return{}},methods:{}},o=i,r=s("2877"),l=s("ead5"),c=s("079e"),d=s("eebe"),u=s.n(d),h=Object(r["a"])(o,a,n,!1,null,null,null);t["a"]=h.exports;u()(h,"components",{QBreadcrumbs:l["a"],QBreadcrumbsEl:c["a"]})},3:function(e,t){},"310f":function(e,t,s){"use strict";var a=function(){var e=this,t=this,s=t.$createElement,a=t._self._c||s;return a("q-form",{staticClass:"text-white bg-secondary",on:{submit:t.onSubmit,reset:t.onReset}},[a("q-input",{attrs:{filled:"",type:"email",label:"email",hint:"email","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your email address"},function(t){return e.isValidEmail()||"Invalid email address"}]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),a("q-input",{attrs:{filled:"",type:"password",label:"Password","lazy-rules":"",rules:[function(e){return null!==e&&""!==e||"Please enter your password"}],"error-message":t.passwordErrorMessage},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),a("div",{staticClass:"q-pa-md"},[a("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1)],1)},n=[],i=(s("ddb0"),s("cf57"));const o=s("1712").to,r=s("ff00"),l=s("40cd").default;var c={name:"loginForm",data(){return{email:"",password:"",passwordErrorMessage:""}},methods:{isValidEmail(){const e=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return e.test(this.email)||"Invalid email"},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:i["a"],color:"primary"},persistent:!0,ok:!1}),s=setInterval((()=>{!1===this.working&&(clearInterval(s),t.hide())}),500)},async onSubmit(){l.setSettings({TBURL:r["TB_URL"]});r["TB_URL"];let e={email:this.email,password:this.password};this.working=!0,this.showCustom();let[t,s]=await o(l.login(e));if(this.working=!1,t)return this.loggedin=!1,this.$q.notify({type:"negative",message:t.error||t.message||"failed to log in"}),this.password="",void(this.passwordErrorMessage=t.error||t.message||"wrong email/password");l.setToken(s),this.$q.notify({type:"positive",message:"log in successful"}),window.location.assign("#/home")},onReset(){this.email=null,this.password=null}}},d=c,u=s("2877"),h=s("0378"),p=s("27f9"),m=s("9c40"),g=s("eebe"),y=s.n(g),w=Object(u["a"])(d,a,n,!1,null,null,null);t["a"]=w.exports;y()(w,"components",{QForm:h["a"],QInput:p["a"],QBtn:m["a"]})},4:function(e,t){},"40cd":function(e,t,s){"use strict";s.r(t);var a=s("9523"),n=s.n(a),i=(s("ddb0"),s("e01a"),s("cf57"));const o=s("1712").to,r=s("bc3a"),l=s("1232").default,c=s("4556"),d=s("e350").default;class u extends d{constructor(){super(),n()(this,"vueObj",null),n()(this,"setVue",(e=>{this.vueObj=e})),n()(this,"showLoading",((e={})=>{let{message:t,color:s}=e;t||(t="loading"),s||(s="white"),this.vueObj.$q.loading.show({spinner:i["a"],spinnerColor:s,message:t})})),n()(this,"hideLoading",(()=>{this.vueObj.$q.loading.hide()})),n()(this,"settings",{}),n()(this,"setSettings",(e=>{for(let t in e){let s=e[t];this.settings[t]=s}})),n()(this,"setToken",(e=>{let t=e.token,s=e.refreshToken;window.localStorage.setItem("cysmedTokenGSAC",t),window.localStorage.setItem("cysmedRefreshTokenGSAC",s)})),n()(this,"createUser",(async(e,t)=>{let{activationEmail:s,showActivationLink:a}=t;return new Promise((async(t,n)=>{let i=`${this.settings.TBURL}/user?sendActivationMail=${s||!1}`,l=window.location.protocol+"//"+window.location.host+"/#/activate";e.activationPage=`${l}`;let[c,d]=await o(r.post(i,e,{headers:{"Content-Type":"application/json"}}));if(c)return n(c.response.data);if(a){let{userId:e}=d.data;if([c,d]=await o(this.getActivationCode(e)),c)return n(c);let{activationCode:s}=d;return t(s)}return t(d.data)}))})),n()(this,"getActivationCode",(async e=>new Promise((async(t,s)=>{let a=`${this.settings.TBURL}/noauth/activationCode?userId=${e}`,[n,i]=await o(r.get(a,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+this.jwt_token}}));if(n)return s(n.response.data.error||n);t(i.data)})))),n()(this,"authGuard",(async e=>new Promise((async(e,t)=>{let[s,a]=await o(this.isLoggedIn());!s&&a||window.location.assign("/"),e()})))),n()(this,"activateAndCreatePassword",(async e=>{let{activateToken:t,password:s}=e;return new Promise((async(a,n)=>{let i=`${this.settings.TBURL}/noauth/activate?activateToken=${t}`,[l,c]=await o(r.get(i));if(l)return n(l.response.data);let d=c.data.passwordToken;return e={passwordToken:d,password:s},i=`${this.settings.TBURL}/noauth/resetPassword`,[l,c]=await o(r.post(i,e,{headers:{"Content-Type":"application/json"}})),l?n(l.response.data):a(c.data)}))})),n()(this,"login",(async e=>new Promise((async(t,s)=>{let a=`${this.settings.TBURL}/auth/login`,[n,i]=await o(r.post(a,e,{headers:{"Content-Type":"application/json"}}));return n?s(n.response.data):t(i.data)})))),n()(this,"logout",(()=>{window.localStorage.removeItem("cysmedTokenGSAC"),window.localStorage.removeItem("cysmedRefreshTokenGSAC"),this.jwt_token=null,this.authGuard()})),n()(this,"getToken",(async(e,t)=>new Promise((async(t,s)=>{let a=`${this.settings.TBURL}/auth/token`,[n,i]=await o(r.get(a,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+e}}));return n?s(n):t(i.data)})))),n()(this,"isLoggedIn",(async()=>new Promise((async(e,t)=>{let s=localStorage.getItem("cysmedTokenGSAC");if(!s)return this.vueObj.isLoggedIn=!1,t("missing token");let a=l(s);console.log(a),this.userId=a.userId,this.jwt_token=s;let n=a.exp;if(!n)return t("missing token expiry");let i=localStorage.getItem("cysmedRefreshTokenGSAC");n=parseInt(n),console.log("==========="),console.log("==========="),console.log("==========="),console.log("==========="),(new Date).getTime();{let[e,a]=await o(this.getToken(s,i));if(e)return t("could not find token");this.setToken(a),s=a.token}return console.log(s),e(s)})))),n()(this,"readUserData",(async()=>new Promise((async(e,t)=>{let s=`${this.settings.TBURL}/user/me`,[a,n]=await o(r.get(s,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+this.jwt_token}}));return a?t(a):e(n.data)})))),n()(this,"listAllUsers",(async()=>new Promise((async(e,t)=>{let s=`${this.settings.TBURL}/users`,[a,n]=await o(r.get(s,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+this.jwt_token}}));return a?(console.log(a.response.data.error),console.log(this.jwt_token),t(a.response.data.error||a.response.data.msg||a.response.data.message||a)):e(n.data)})))),n()(this,"saveUserData",(async e=>new Promise((async(t,s)=>{let a=`${this.settings.TBURL}/user`,[n,i]=await o(r.patch(a,e,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+this.jwt_token}}));return n?s(n.response.data):t(i.data)})))),n()(this,"deleteUser",(async e=>new Promise((async(t,s)=>{let a=`${this.settings.TBURL}/user?userId=${e}`,[n,i]=await o(r.delete(a,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+this.jwt_token}}));return n?s(n.response.data.error):t(i.data)})))),n()(this,"fetchRoles",(async()=>new Promise((async(e,t)=>{let[s,a]=await o(this.sendSaveTeletry({type:"roles",action:"get"}));if(s)return t(s);e(a)})))),n()(this,"fetchUserRoles",(async e=>new Promise((async(t,s)=>{let[a,n]=await o(this.sendSaveTeletry({type:"roles",action:"userroles",user:e}));if(a)return s(a);console.log(n),t(n)})))),n()(this,"fetctUserProjects",(async e=>new Promise((async(t,s)=>{let[a,n]=await o(this.sendSaveTeletry({type:"projects",action:"userprojects",user:e}));if(a)return s(a);console.log(n),t(n)})))),n()(this,"addUserRole",(async(e,t)=>new Promise((async(s,a)=>{let[n,i]=await o(this.sendSaveTeletry({type:"roles",action:"adduserrole",user:e,roleId:t},!0));if(n)return a(n);console.log(i),s(i)})))),n()(this,"removeUserRole",(async(e,t)=>new Promise((async(s,a)=>{let[n,i]=await o(this.sendSaveTeletry({type:"roles",action:"removeuserrole",user:e,roleId:t}));if(n)return a(n);console.log(i),s(i)})))),n()(this,"fetchProjects",(async()=>new Promise((async(e,t)=>{let[s,a]=await o(this.sendSaveTeletry({type:"projects",action:"get"}));if(s)return t(s);e(a)})))),n()(this,"whoAmI",(async()=>new Promise((async(e,t)=>{let[s,a]=await o(this.readUserData());if(console.log("WHOAMI"),s)return t(s);e(a)})))),n()(this,"fetchUsers",(async()=>new Promise((async(e,t)=>{let[s,a]=await o(this.whoAmI());if(s)return t(s);let n,i=a.authority;if("TENANT_ADMIN"===i){let e=`${this.settings.TBURL}/tenant/customers?customerTitle=GS Publications`;if([s,a]=await o(r.get(e,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+this.jwt_token}})),s)return t(s);n=a.data.id.id}else console.log("i am a customer...."),console.log(a),n=a.customerId.id;if(console.log("CUSTOMER ID",n),[s,a]=await o(this.sendSaveTeletry({type:"users",action:"get",customerId:n})),s)return t(s.msg||s);e(a)})))),n()(this,"createRole",(async e=>new Promise((async(t,s)=>{let[a,n]=await o(this.sendSaveTeletry({type:"roles",action:"create",role:e}));if(a)return s(a);t(n)})))),n()(this,"checkSuccessfulCreateUser",(async(e,t)=>new Promise((async(s,a)=>{let n=(new Date).getTime();console.log("starting for sure...");const i=async()=>{console.log("here.....");let r=c({length:20,type:"url-safe"});return this.once(r,i),new Promise((async(l,c)=>{let[d,u]=await o(this.login({username:e,password:t}));if(d){console.log(d.data);let t=(new Date).getTime(),s=t-n;s<=1e4?this.emit(r):(this.removeListener(r,i),a(`Error creating account. Probably ${e} already exists`),c("Timed out"))}if(void 0!==u)return console.log(u),this.removeListener(r,i),l(u.data),s(u.data);{let e=(new Date).getTime(),t=e-n;t<=1e4?this.emit(r):(this.removeListener(r,i),a("Error creating account. Probably ${user} already exists"),c("Timed out"))}}))};await o(i())})))),n()(this,"getActivationLink",(async(e,t)=>new Promise((async(s,a)=>{let n=`${this.settings.TBURL}/user/${e}/activationLink`,[i,l]=await o(r.get(`${this.settings.JSONPROXY}?path=${n}`,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+t}}));if(i)return a(i);s(l.data)})))),n()(this,"createProject",(async(e,t,s)=>new Promise((async(t,s)=>{let[a,n]=await o(this.sendSaveTeletry({type:"projects",action:"create",project:e}));if(console.log("adhkjashdkhasdk"),a)return s(a);console.log("RETURNED..."),console.log(n),t(n)})))),n()(this,"deleteRole",(async(e,t)=>new Promise((async(s,a)=>{let[n,i]=await o(this.sendSaveTeletry({type:"roles",action:"delete",role:e,roleId:t}));if(n)return a(n);s(i)})))),n()(this,"deleteProject",(async e=>new Promise((async(t,s)=>{let[a,n]=await o(this.sendSaveTeletry({type:"projects",action:"delete",project:e}));if(a)return s(a);t(n)})))),n()(this,"createApplication",(async(e,t)=>{let{application:s,description:a,icon:n,link:i}=e;return new Promise((async(e,r)=>{let[l,c]=await o(this.sendSaveTeletry({type:"applications",action:t,application:s,description:a,icon:n,link:i}));if(l)return r(l);e(c)}))})),n()(this,"fetchApplications",(async()=>new Promise((async(e,t)=>{let[s,a]=await o(this.sendSaveTeletry({type:"applications",action:"get"}));if(s)return t(s);e(a)})))),n()(this,"deleteApplication",(async e=>new Promise((async(t,s)=>{let[a,n]=await o(this.sendSaveTeletry({type:"applications",action:"delete",application:e}));if(a)return s(a);t(n)})))),n()(this,"readSingleUserData",(async e=>new Promise((async(t,s)=>{this.settings.TBURL;let[a,n]=await o(this.sendSaveTeletry({type:"users",action:"getSingle",user:e}));return a?s(a):t(n)})))),n()(this,"changePassword",(async e=>new Promise((async(t,s)=>{let a=`${this.settings.TBURL}/auth/changePassword`,[n,i]=await o(r.post(a,e,{headers:{"Content-Type":"application/json","X-Authorization":"Bearer "+this.jwt_token}}));if(n){let e=n.response;return n=JSON.parse(JSON.stringify(n)),n.response=e,console.log(n),s(n)}return t(i.data)})))),n()(this,"sendSaveTeletry",(async(e,t=!1)=>(e.userId||(e.userId=this.userId),e.jwt_token||this.jwt_token&&(e.jwt_token=this.jwt_token),e.rqId||(e.rqId=c({length:20,type:"url-safe"})),console.log("step2"),console.log({data:e}),new Promise((async(s,a)=>{let n=this.settings.PUBLIC_DEVICE_ACCESS_TOKEN;console.log(this.settings);let i=this.settings.CORS_PROXY,l=`${this.settings.TBURL}/v1/${n}/telemetry`;console.log(e);let[d,u]=await o(r.post(`${i}/${l}`,e,{headers:{"Content-Type":"application/json"}}));if(console.log("ERRED......"),console.log(d),console.log(u),d)return a(d);if(t)return console.log("NO WAITING.."),s(!0);let h=e.rqId,p=(new Date).getTime();const m=async()=>new Promise((async(e,t)=>{let[n,i]=await o(this.readUserData()),r=c({length:20,type:"url-safe"});if(this.once(r,m),n)console.log(n.status),console.log(n.response.data.status),console.log(n.data),console.log(n),this.removeListener(r,m),401===n.response.data.status?(console.log("---------160"),e({}),s({})):(console.log("---------1601"),e(!1),a(n));else if(void 0===i.additionalInfo)a("Unknown error occured"),e(!1);else{let t=i.additionalInfo.responses;if(t&&t[h]){console.log("---------167");let n=t[h];return console.log(n),n.msg.error?(this.removeListener(r,m),e(!1),a(n.msg.error)):(console.log("returned...."),console.log(n.msg),s(n.msg),e(!0),console.log("after resolve....."),this.removeListener(r,m),s(n.msg))}{let t=(new Date).getTime(),s=t-p;s<=12e4?(console.log(s,h),this.emit(r)):(this.removeListener(r,m),a("timed out"),e(!1))}}}));await o(m())})))))}openLink(e,t=!1){window.open(e,t)}}const h=new u;t["default"]=h},5:function(e,t){},5757:function(e,t,s){"use strict";var a=function(){var e=this,t=this,s=t.$createElement,a=t._self._c||s;return a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:t.createUser,reset:t.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:"first name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your name"}]},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.firstName,callback:function(e){t.firstName=e},expression:"firstName"}}),a("q-input",{attrs:{filled:"",type:"text",label:"last name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your name"}]},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.lastName,callback:function(e){t.lastName=e},expression:"lastName"}}),a("q-select",{attrs:{"use-input":"",filled:"",options:t.genders,label:"Gender","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select your gender"}]},model:{value:t.gender,callback:function(e){t.gender=e},expression:"gender"}}),a("q-input",{attrs:{filled:"",mask:"date",label:"Date of Birth(YYYY/MM/DD)",rules:["date",function(e){return e&&e.length>0||"Please enter your dob"}]},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:t.dob,callback:function(e){t.dob=e},expression:"dob"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:t.dob,callback:function(e){t.dob=e},expression:"dob"}}),a("q-input",{attrs:{filled:"",type:"email",label:"email","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your email address"},function(t){return e.isValidEmail()||"Invalid email address"}]},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),t.showAccept?a("terms",{attrs:{accept:t.accept,main:t.main}}):t._e(),t.showActivation?a("div",{staticClass:"col"},[a("q-checkbox",{staticClass:"col",attrs:{label:"Send Activation Email"},model:{value:t.activationEmail,callback:function(e){t.activationEmail=e},expression:"activationEmail"}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Show Activation link"},model:{value:t.showActivationLink,callback:function(e){t.showActivationLink=e},expression:"showActivationLink"}})],1):t._e(),a("div",[a("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1),a("activationLink",{attrs:{alert:t.alert}})],1)},n=[],i=(s("ddb0"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("q-toggle",{attrs:{color:"secondary"},on:{input:e.toggled},model:{value:e.localAccept,callback:function(t){e.localAccept=t},expression:"localAccept"}}),e._v("I\n  accept the\n  "),s("a",{staticClass:"text-underline text-italic",staticStyle:{"text-decoration":"underline",cursor:"pointer"},attrs:{clickable:""},on:{click:e.showTerms}},[e._v("terms and conditions")]),s("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.termsDialog,callback:function(t){e.termsDialog=t},expression:"termsDialog"}},[s("q-card",[s("q-card-section",{staticClass:"q-pt-none"},[""!==e.termsText?s("q-markdown",[e._v("\n          "+e._s(e.termsText)+"\n        ")]):e._e()],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Ok",color:"primary"}})],1)],1)],1)],1)}),o=[],r=s("cf57");s("bc3a"),s("1712").to;const l=s("9fea")();var c={name:"terms",props:{accept:Boolean,main:Function},created(){this.myParent=this.main(),this.localAccept=this.accept},data(){return{localAccept:!1,myParent:null,termsText:"",termsDialog:!1}},methods:{async showTerms(){this.termsDialog=!0,this.termsText=l},toggled(e){this.$nextTick((function(){this.myParent.changeAccept(e)}))},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:r["a"],color:"primary"},persistent:!0,ok:!1}),s=setInterval((()=>{!1===this.working&&(clearInterval(s),t.hide())}),500)}}},d=c,u=s("2877"),h=s("9564"),p=s("24e8"),m=s("f09f"),g=s("a370"),y=s("4b7e"),w=s("9c40"),f=s("7f67"),v=s("eebe"),b=s.n(v),k=Object(u["a"])(d,i,o,!1,null,null,null),T=k.exports;b()(k,"components",{QToggle:h["a"],QDialog:p["a"],QCard:m["a"],QCardSection:g["a"],QCardActions:y["a"],QBtn:w["a"]}),b()(k,"directives",{ClosePopup:f["a"]});var C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-dialog",{attrs:{"full-width":""},model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[s("q-card",{staticClass:"bg-grey"},[s("q-card-section",{staticClass:"flex flex-center q-ma-md q-pt-none"},[s("a",{staticStyle:{"text-decoration":"none"},attrs:{href:e.activationPage}},[s("q-markdown",[e._v("\n          "+e._s(e.activationPage)+"\n        ")])],1)])],1)],1)},P=[];s("1712").to;const q=s("ff00"),A=s("40cd").default;var S={name:"activationLink",components:{},props:["inside","userId","alert"],async created(){A.setSettings({TBURL:q["TB_URL"]}),A.setSettings(q),this.showAccept=!1,this.accept=!0},data(){return{activationPage:"Some data on the activation page",accept:!1,showAccept:!0}},methods:{}},x=S,L=Object(u["a"])(x,C,P,!1,null,null,null),_=L.exports;b()(L,"components",{QDialog:p["a"],QCard:m["a"],QCardSection:g["a"]});s("bc3a");const j=s("1712").to,I=s("ff00"),R=s("40cd").default;var $={name:"registrationForm",components:{terms:T,activationLink:_},props:["inside"],async created(){if(R.setSettings({TBURL:I["TB_URL"]}),R.setSettings(I),this.inside)this.showAccept=!1,this.accept=!0,this.showActivation=!0,this.activationEmail=!1,this.showActivationLink=!0;else{let[e,t]=await j(R.isLoggedIn());t&&window.location.assign("#/home")}},data(){return{activationPage:"",accept:!1,showAccept:!0,showActivation:!1,showActivationLink:!1,activationEmail:!0,email:"",firstName:"",lastName:"",gender:"Male",genders:["Male","Female"],dob:"",password:"",cpassword:"",passwordErrorMessage:"",users:[],alert:!0}},methods:{changeAccept(e){this.accept=e},submit(){this.$refs.userRegistrationForm.submit()},main(){return this},isValidEmail(){const e=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return e.test(this.email)||"Invalid email"},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:r["a"],color:"primary"},persistent:!0,ok:!1}),s=setInterval((()=>{!1===this.working&&(clearInterval(s),t.hide())}),500)},async createUser(){return R.setSettings({TBURL:I["TB_URL"]}),new Promise((async(e,t)=>{if(!0!==this.accept)return this.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:"You need to read and accept the terms and conditions"}),e(!1);this.working=!0,this.showCustom();let[s,a]=await j(R.createUser({email:this.email,firstName:this.firstName,lastName:this.lastName,gender:this.gender,dateOfBirth:this.dob,authority:"SYS_USER"},{activationEmail:this.activationEmail,showActivationLink:this.showActivationLink},!0));if(this.working=!1,s){s=s.msg||s.message||s.error||s;try{s=JSON.parse(s)}catch(n){}if("object"===typeof s){let e=Object.keys(s);s=s[e[0]]}this.$q.notify({type:"negative",message:s}),e(!1)}else if(this.users.push(a),console.log(this.showActivationLink),this.showActivationLink){let e=window.location.protocol+"//"+window.location.host+`/#/activate?activateToken=${a}`;this.activationPage=e,this.alert=!0}else this.$q.notify({type:"positive",message:"Registration successful. Check your email to activate you account."})}))},onReset(){this.email=null,this.firstName=null,this.lastName=null,this.password=null,this.cpassword=null,this.accept=!1}}},U=$,B=s("0378"),E=s("27f9"),Q=s("ddd8"),O=s("0016"),D=s("7cbe"),N=s("52ee"),z=s("8f8e"),F=Object(u["a"])(U,a,n,!1,null,null,null);t["a"]=F.exports;b()(F,"components",{QForm:B["a"],QInput:E["a"],QSelect:Q["a"],QIcon:O["a"],QPopupProxy:D["a"],QDate:N["a"],QBtn:w["a"],QToggle:h["a"],QCheckbox:z["a"],QDialog:p["a"],QCard:m["a"],QCardSection:g["a"]}),b()(F,"directives",{ClosePopup:f["a"]})},6:function(e,t){},"6f24":function(e,t,s){},7:function(e,t){},7687:function(e,t,s){e.exports=s.p+"img/cysmedinfo.d33fe8a7.png"},8:function(e,t){},9:function(e,t){},"9fea":function(e,t){function s(){return"\n## Terms and Conditions\n\n...\n    "}e.exports=s},e12e:function(e,t,s){"use strict";s("6f24")},e350:function(e,t,s){"use strict";s.r(t);class a{constructor(){this.events={}}on(e,t){return"object"!==typeof this.events[e]&&(this.events[e]=[]),this.events[e].push(t),()=>this.removeListener(e,t)}removeListener(e,t){if("object"===typeof this.events[e]){const s=this.events[e].indexOf(t);s>-1&&this.events[e].splice(s,1)}}emit(e,...t){"object"===typeof this.events[e]&&this.events[e].forEach((e=>e.apply(this,t)))}once(e,t){const s=this.on(e,((...e)=>{s(),t.apply(this,e)}))}}t["default"]=a},ff00:function(e){e.exports=JSON.parse('{"TB_URL":"http://localhost:8800/api"}')}}]);