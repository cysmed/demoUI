(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"020c":function(e,t,a){"use strict";a("d52d")},"0e1b":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loaded?a("q-card",{staticClass:"items-center text-center bg-white",attrs:{flat:""}},[a("q-card-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"items-left text-left"},[a("div",{staticClass:"text-h4"},[e._v("Profile")]),a("div",[e._v(e._s(e.email))])]),a("q-space"),a("div",{staticClass:"items-left text-left text-weight-thin"},[a("div",[e._v("Last Login")]),a("div",[e._v(e._s(e.lastLogin))])])],1)]),a("q-card-section",[a("q-form",{ref:"changeUserNameForm",staticClass:"q-gutter-md text-white",on:{submit:e.changeuserNames,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:e.allowlastName?"First Name":"Facility Name","lazy-rules":"",rules:[function(t){return t&&t.length>0||(!1===e.allowlastName||"false"===e.allowlastName?"Please enter facility name":"Please enter your first name")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),e.allowlastName?a("q-input",{attrs:{filled:"",type:"text",label:"Last Name",hint:"Last Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your last name"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}}):e._e(),e.allowlastName?a("q-input",{attrs:{filled:"",mask:"date",label:"Date of Birth(YYYY/MM/DD)",rules:["date"]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangeUserName(t)}},model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}}):e._e(),e.allowlastName?a("q-select",{attrs:{"use-input":"",filled:"",options:e.genders,label:"Gender","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select your gender"}]},model:{value:e.gender,callback:function(t){e.gender=t},expression:"gender"}}):e._e(),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.1"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone1,callback:function(t){e.telephone1=t},expression:"telephone1"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.2"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone2,callback:function(t){e.telephone2=t},expression:"telephone2"}}),a("div",{staticClass:"row"},[a("div",{staticClass:"items-left text-left"},[a("q-btn",{attrs:{label:"Change Password",color:"primary"},on:{click:function(t){e.changePasswordDialog=!0}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"items-left text-left"},[a("q-btn",{attrs:{label:"Delete Account",color:"red"},on:{click:e.deleteAccount}})],1),a("q-space"),a("div",{staticClass:"items-left text-left"},[a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),a("q-btn",{attrs:{label:"Save",type:"submit",color:"green",disable:e.userEditted}})],1)],1)],1)],1)],1):e._e(),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.changePasswordDialog,callback:function(t){e.changePasswordDialog=t},expression:"changePasswordDialog"}},[a("q-card",[a("q-card-section",{staticClass:"bg-secondary text-white text-h5 text-center"},[e._v("\n          Change Password\n        ")]),a("q-card-section",[a("q-form",{ref:"changePasswordForm",staticClass:"q-gutter-md text-white",on:{submit:e.changePassword,reset:e.onResetChangePassword}},[a("q-input",{attrs:{filled:"",type:"password",label:"Current Password",hint:"Current Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your current pasword"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.currentPassword,callback:function(t){e.currentPassword=t},expression:"currentPassword"}}),a("q-input",{attrs:{filled:"",type:"password",label:"New Password",hint:"New Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter your new pasword"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),a("q-input",{attrs:{filled:"",type:"password",label:"Confirm New Password",hint:"Confirm New Password","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please confirm your new pasword"}],"error-message":e.confirmPasswordError},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitChangePassword(t)}},model:{value:e.newPasswordAgain,callback:function(t){e.newPasswordAgain=t},expression:"newPasswordAgain"}}),a("div",{staticClass:"row"},[a("q-space"),a("div",{staticClass:"items-left text-left"},[a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),a("q-btn",{attrs:{label:"Change Password",type:"submit",color:"green"}})],1)],1)],1)],1)],1)],1)],1)},s=[];a("ddb0"),a("cf57"),a("51e2");const n=a("c2a1").default,r=a("1712").to,l=a("20e6"),o=a("6daa").default;var c={name:"basicProfile",components:{},props:["cysmed","selectedUser"],data(){return{profilePath:"",userData:{},email:"",firstName:"",lastName:"",firstNameOriginal:"",lastNameOriginal:"",genderOriginal:"",dobOriginal:"",telephone1:"",telephone1Original:"",telephone2:"",telephone2Original:"",currentPassword:"",newPassword:"",newPasswordAgain:"",loaded:!1,changePasswordDialog:!1,lastLogin:"",confirmPasswordError:"",gender:"Male",genders:["Male","Female"],dob:"",allowlastName:!0}},async created(){if(n.setSettings({TBURL:l["TB_URL"]}),n.setVue(this),await n.authGuard(),this.allowlastName=!this.cysmed.currentUserAuthority.match(/FACILITY/),this.selectedUser)this.setUserData(this.selectedUser);else{n.showLoading();let[e,t]=await r(n.readUserData());if(e)return;n.hideLoading(),this.setUserData(t)}},methods:{onReset(){this.firstName=this.firstNameOriginal,this.lastName=this.lastNameOriginal,this.gender=this.genderOriginal,this.dob=this.dobOriginal,this.telephone1=this.telephone1Original,this.telephone2=this.telephone2Original},onResetChangePassword(){this.currentPassword="",this.newPassword="",this.newPasswordAgain=""},setUserData(e){this.userData=e,this.email=e.email,this.firstName=e.firstName,this.lastName=e.lastName,this.firstNameOriginal=e.firstName,this.lastNameOriginal=e.lastName,this.dob=e.dateOfBirth,this.dobOriginal=e.dateOfBirth,this.gender=e.gender,this.genderOriginal=e.gender,this.telephone1=e.telephone1,this.telephone1Original=e.telephone1,this.telephone2=e.telephone2,this.telephone2Original=e.telephone2,this.loaded=!0,this.lastLogin=new Date(e.additionalInfo.lastLoginTs).toISOString()},async changeuserNames(){return new Promise((async(e,t)=>{if(this.notUserEditted())return e(!1);let a=this.userData;a.firstName=this.firstName,a.lastName=this.lastName,a.gender=this.gender,a.dateOfBirth=this.dob,a.telephone1=this.telephone1,a.telephone2=this.telephone2,n.showLoading();let[i,s]=await r(n.saveUserData(a));if(n.hideLoading(),i)return this.$q.notify({type:"negative",message:i.msg||i}),e(!1);this.setUserData(s),e(s)}))},async changePassword(){return new Promise((async(e,t)=>{if(this.newPassword!==this.newPasswordAgain)return this.newPasswordAgain="",this.confirmPasswordError="Passwords don't match",e(!1);let a={oldpassword:this.currentPassword,password:this.newPassword};n.showLoading({message:"Changing Password"});let[i,s]=await r(n.changePassword(a));if(n.hideLoading(),i)return this.$q.notify({type:"negative",message:i.response.data.error||i.msg||i.response.data.message||i.message||i}),e(!1);this.$q.notify({type:"positive",message:"Password changed."}),this.changePasswordDialog=!1,e(s)}))},async deleteAccount(){return new Promise((async(e,t)=>{let[a,i]=await r(o.confirm(this,"Are you sure you want to delete your account?","Delete Account"));return a?e(!1):(n.showLoading({message:"Deleting Account"}),[a,i]=await r(n.deleteUser(this.userData.userId,!0)),n.hideLoading(),a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:"Your account has been deleted"}),void window.location.assign("/")))}))},submitChangeUserName(){this.$refs.changeUserNameForm.submit()},submitChangePassword(){this.$refs.changePasswordForm.submit()},notUserEditted(){return this.firstName===this.firstNameOriginal&&this.lastName===this.lastNameOriginal&&this.dob===this.dobOriginal&&this.gender===this.genderOriginal&&this.telephone1===this.telephone1Original&&this.telephone2===this.telephone2Original}},computed:{userEditted(){return this.firstName===this.firstNameOriginal&&this.lastName===this.lastNameOriginal&&this.dob===this.dobOriginal&&this.gender===this.genderOriginal&&this.telephone1===this.telephone1Original&&this.telephone2===this.telephone2Original}}},d=c,m=(a("2eb0"),a("2877")),u=a("9989"),h=a("f09f"),g=a("a370"),p=a("2c91"),y=a("0378"),f=a("27f9"),b=a("ddd8"),w=a("9c40"),S=a("24e8"),v=a("eebe"),E=a.n(v),q=Object(m["a"])(d,i,s,!1,null,"7cd0516a",null);t["a"]=q.exports;E()(q,"components",{QPage:u["a"],QCard:h["a"],QCardSection:g["a"],QSpace:p["a"],QForm:y["a"],QInput:f["a"],QSelect:b["a"],QBtn:w["a"],QDialog:S["a"]})},"15ce":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toggle",{attrs:{color:"secondary"},on:{input:e.toggled},model:{value:e.localAccept,callback:function(t){e.localAccept=t},expression:"localAccept"}}),e._v(e._s(e.translate("PASSAGE.IACCEPTTHE"))+"\n  "),a("a",{staticClass:"text-underline text-italic",staticStyle:{"text-decoration":"underline",cursor:"pointer"},attrs:{clickable:""},on:{click:e.showTerms}},[e._v(e._s(e.translate("PASSAGE.TERMSANDCONDITIONS")))]),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.termsDialog,callback:function(t){e.termsDialog=t},expression:"termsDialog"}},[a("q-card",[a("q-card-section",{staticClass:"q-pt-none"},[""!==e.termsText?a("q-markdown",[e._v("\n          "+e._s(e.termsText)+"\n        ")]):e._e()],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Ok",color:"primary"}})],1)],1)],1)],1)},s=[],n=a("cf57");a("bc3a"),a("1712").to;const r=a("ea76").default,l=a("9fea")(r.getShortLang());var o={name:"terms",props:{accept:Boolean,main:Function},created(){this.myParent=this.main(),this.localAccept=this.accept},data(){return{translate:r.translate,localAccept:!1,myParent:null,termsText:"",termsDialog:!1}},methods:{async showTerms(){this.termsDialog=!0,this.termsText=l},toggled(e){this.$nextTick((function(){this.myParent.changeAccept(e)}))},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:n["a"],color:"primary"},persistent:!0,ok:!1}),a=setInterval((()=>{!1===this.working&&(clearInterval(a),t.hide())}),500)}}},c=o,d=a("2877"),m=a("9564"),u=a("24e8"),h=a("f09f"),g=a("a370"),p=a("4b7e"),y=a("9c40"),f=a("7f67"),b=a("eebe"),w=a.n(b),S=Object(d["a"])(c,i,s,!1,null,null,null);t["a"]=S.exports;w()(S,"components",{QToggle:m["a"],QDialog:u["a"],QCard:h["a"],QCardSection:g["a"],QCardActions:p["a"],QBtn:y["a"]}),w()(S,"directives",{ClosePopup:f["a"]})},"1b38":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"padding"},[e.loadingSomethingBigger?a("q-linear-progress",{attrs:{indeterminate:"",color:"negative"}}):e._e(),e.rightSideBarP&&e.organizationsSidebar?a("rightSideBar",{attrs:{main:e.mainLocal,objType:"organization"}}):e._e(),e.organizationsSidebar?e._e():a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Organizations"},on:{click:e.manageOrganizations}}),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.createOrganizationDialog,callback:function(t){e.createOrganizationDialog=t},expression:"createOrganizationDialog"}},[a("q-card",{staticClass:"q-ma-md"},[a("q-card-section",{staticClass:"bg-secondary text-white text-center"},[a("div",{staticClass:"text-h6"},[e._v("Create Organization")])]),a("q-card-section",{staticClass:"bg-secondary text-white"},[a("createOrganization",{attrs:{main:e.mainLocal,userId:e.userId}})],1)],1)],1),e.notOuterPage?e._e():a("breadcrumbs",{attrs:{links:e.links}}),a("q-table",{attrs:{grid:"","card-container-class":e.cardContainerClass,data:e.allOrganizations,columns:e.columns,title:"Organizations",filter:e.filter,"row-key":"name","hide-header":"","hide-bottom":"","rows-per-page-options":[0]},on:{"row-click":e.selectOrganization},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.listUserOrganizations()}}})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"add_circle",side:""},on:{click:function(t){e.createOrganizationDialog=!0}}})],1)]},proxy:!0},{key:"item",fn:function(t){return[a("div",{staticClass:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},[a("q-card",{staticClass:"bg-primary",staticStyle:{height:"200px"}},[a("q-card-section",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"flex flex-center text-h6 bg-secondary q-mb-none q-pb-none full-height cursor-pointer q-hoverable",on:{click:function(a){return e.selectOrganization(t.row)}}},[a("strong",[e._v(e._s(t.row.organizationName))])]),a("q-btn",{staticClass:"text-white absolute-top-right q-ma-sm",attrs:{icon:"delete",color:"red"},on:{click:function(a){return e.deleteOrganization(t.row)}}}),a("q-btn",{staticClass:"text-white absolute-top-left q-ma-sm",attrs:{icon:"input",color:"secondary"},on:{click:function(a){return e.manageUsers(t.row)}}})],1)],1)]}}])})],1)},s=[],n=(a("ddb0"),a("5319"),a("cf57"),a("2cbd")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-form",{ref:"createOrganizationForm",staticClass:"q-gutter-md text-white",on:{submit:e.createOrganization,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:"Organization name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name for your organization"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.organizationName,callback:function(t){e.organizationName=t},expression:"organizationName"}}),a("div",[a("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1)],1)},l=[];const o=a("1712").to,c=a("20e6"),d=a("c2a1").default;var m={name:"createOrganization",components:{},props:["main","userId"],beforeDestroy(){this.main.loadingSomethingBigger=!1},async created(){d.setSettings({TBURL:c["TB_URL"]}),d.setSettings(c)},data(){return{organizationName:""}},methods:{submit(){this.$refs.createOrganizationForm.submit()},async createOrganization(){return d.setSettings({TBURL:c["TB_URL"]}),new Promise((async(e,t)=>{this.main.loadingSomethingBigger=!0;let a=this.userId||(await d.whoAmILocally()).userId,i=this.organizationName,[s,n]=await o(d.createOrganization({organizationName:i,userId:a}));if(this.main.loadingSomethingBigger=!1,s){s=s.msg||s.message||s.error||s;try{s=JSON.parse(s)}catch(r){}if("object"===typeof s){let e=Object.keys(s);s=s[e[0]]}return this.$q.notify({type:"negative",message:s}),e(!1)}this.$q.notify({type:"positive",message:`${i} created.`}),this.main.createOrganizationDialog=!1,this.main.listUserOrganizations()}))},onReset(){this.organizationName=null}}},u=m,h=a("2877"),g=a("0378"),p=a("27f9"),y=a("9c40"),f=a("eebe"),b=a.n(f),w=Object(h["a"])(u,r,l,!1,null,null,null),S=w.exports;b()(w,"components",{QForm:g["a"],QInput:p["a"],QBtn:y["a"]});const v=a("20e6"),E=a("c2a1").default,q=a("1712").to,I=a("6daa").default;var N={name:"organizationsPage",props:["notOuterPage","main","organizationsSidebar"],components:{breadcrumbs:n["default"],createOrganization:S,rightSideBar:()=>Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"4d6d"))},watch:{$route(e,t){this.setfilters(e.path)}},data(){return{userId:null,activeElement_:"",mainLocal:this,editted:!1,loadingSomething:!1,loadingSomethingBigger:!1,rightSideBarP:!1,createOrganizationDialog:!1,loaded:!0,links:[{label:"Settings",icon:"settings",to:"/system"},{label:("mine"===window.location.hash.split("/")[3]?"My":"All")+" Organizations",icon:"corporate_fare",to:"/"+window.location.hash.split("/").slice(1,4).join("/")}],checkedLoggedIn:!1,loggedIn:!1,listHck:[{name:"Users",icon:"settings",link:"/#/system/users",Authority:"Manage Users and Organizations",description:"Manage Users and Organizations"}],filter:"",columnsHck:[],columns:[{name:"organizationName",label:"Organization",field:"organizationName",sortable:!0},{name:"lastName",label:"Last Name",field:"lastName",sortable:!0},{name:"email",label:"Email",field:"email",sortable:!0}],numUsers:0,numSysAdmins:0,numActiveUsers:0,numInactiveUsers:0,numEnabledUsers:0,numDisabledusers:0,allOrganizations:[],selectedRow:{}}},async created(){this.setfilters(),E.setVue(this),E.setSettings({TBURL:v["TB_URL"]});let e=window.location.hash.replace(/^[#]*[\/]*/,"");if(e.match(/system\/users/)){this.gettingOrganizationFor="user";try{this.userId=this.main.selectedRow.userId}catch(s){}}else if(e.match(/system\/(organizations)\/([a-zA-Z0-9]+)/)){let t=e.match(/system\/organizations\/([a-zA-Z0-9\-]+)/),a=t[1];this.userId="mine"===a?(await E.whoAmILocally()).userId:"system"===a?null:a}await this.listUserOrganizations();let t,a,i=e.match(/(organizations)\/([0-9a-z-]+)$/);i&&"organizations"===i[1]&&(t=i[2]),t&&(this.allOrganizations.map((e=>{e.organizationId===t&&(a=e)})),a&&this.selectOrganization(a))},methods:{manageOrganizations(){window.location.assign(`/#/system/organizations/${this.main.selectedRow.userId}`)},manageUsers(e){let t="";t="user"===this.gettingOrganizationFor?`/#/system/organizations/${this.main.selectedRow.userId}/${e.organizationId}/users`:window.location.href+`/${e.organizationId}/users`,window.location.assign(t)},async deleteOrganization(e){let{organizationId:t,organizationName:a}=e;return new Promise((async(t,a)=>{let[i,s]=await q(I.confirm(this,`Are you sure you want to delete ${e.organizationName}?`,"Delete Organization"));return i?t(!1):(this.main.loadingSomething=!0,[i,s]=await q(E.deleteOrganization(e.organizationId)),this.main.loadingSomething=!1,i?(this.$q.notify({type:"negative",message:i.msg||i}),t(!1)):(this.$q.notify({type:"positive",message:`Organization ${e.organizationName} has been deleted.`}),void await this.listUserOrganizations()))}))},setfilters(e=!1){let t=(e||window.location.hash).replace(/[\/]*[#]*\//,"");switch(t){case"system/users":this.filters={},this.activeElement_="users",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"}];break;case"system/users/sys_admin":this.filters={authority:"SYS_ADMIN"},this.activeElement_="sys_admin",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Sys_Admins",icon:"settings",to:"/system/users/sys_admin"}];break;case"system/users/active":this.filters={isActive:!0},this.activeElement_="active",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Active",icon:"do_not_disturb_off",to:"/system/users/active"}];break;case"system/users/inactive":this.filters={isActive:!1},this.activeElement_="inactive",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Inactive",icon:"do_not_disturb_on",to:"/system/users/inactive"}];break;case"system/users/enabled":this.filters={enabled:!0},this.activeElement_="enabled",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Enabled",icon:"people",to:"/system/users/enabled"}];break;case"system/users/disabled":this.filters={enabled:!1},this.activeElement_="disabled",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Disabled",icon:"person_off",to:"/system/users/disabled"}];break}e&&this.listUserOrganizations()},async listUserOrganizations(){this.loadingSomethingBigger=!0;let e=this.userId,[t,a]=[];[t,a]=e?await q(E.listUserOrganizations(e)):await q(E.listAllOrganizations()),this.loadingSomethingBigger=!1,t||(this.allOrganizations=a||[],this.numUsers=this.allOrganizations.length,this.numSysAdmins=this.allOrganizations.filter((e=>"SYS_ADMIN"===e.authority)).length,this.numActiveUsers=this.allOrganizations.filter((e=>!0===e.isActive)).length,this.numInactiveUsers=this.allOrganizations.filter((e=>!1===e.isActive)).length,this.numEnabledUsers=this.allOrganizations.filter((e=>!0===e.enabled)).length,this.numDisabledusers=this.allOrganizations.filter((e=>!1===e.enabled)).length)},selectApplication(e){window.location.assign(e)},gotoPage(e){console.log(e),window.location.assign(e)},selectOrganization(e){this.notOuterPage?window.location.assign(`/#/system/organizations/${this.main.selectedRow.userId}/${e.organizationId}/users`):(this.selectedOrganization=e,this.selectedOrganizationName=e.organizationName,this.selectedOrganizationId=e.organizationId,this.selectedId="object"===typeof e.organizationId?e.id.organizationId:e.organizationId,this.rightSideBarP=!1,this.$nextTick((()=>this.rightSideBarP=!0)))}},computed:{activeElement(){return this.activeElement_},cardContainerClass(){if(this.$q.screen.gt.xs)return"grid-masonry grid-masonry--"+(this.$q.screen.gt.sm?"6":"4")}}},T=N,O=a("9989"),k=a("6b1d"),R=a("24e8"),L=a("f09f"),P=a("a370"),C=a("eaac"),D=a("0016"),x=a("714f"),F=Object(h["a"])(T,i,s,!1,null,null,null);t["a"]=F.exports;b()(F,"components",{QPage:O["a"],QLinearProgress:k["a"],QBtn:y["a"],QDialog:R["a"],QCard:L["a"],QCardSection:P["a"],QTable:C["a"],QInput:p["a"],QIcon:D["a"]}),b()(F,"directives",{Ripple:x["a"]})},"22aa":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("facilitiesPage",{attrs:{facilitiesSidebar:!0}})},s=[],n=a("4618"),r={name:"facilities",props:["notOuterPage"],components:{facilitiesPage:n["a"]},watch:{$route(e,t){}},data(){return{}},async created(){},methods:{},computed:{}},l=r,o=a("2877"),c=a("9989"),d=a("6b1d"),m=a("24e8"),u=a("f09f"),h=a("a370"),g=a("eaac"),p=a("27f9"),y=a("0016"),f=a("9c40"),b=a("714f"),w=a("eebe"),S=a.n(w),v=Object(o["a"])(l,i,s,!1,null,null,null);t["default"]=v.exports;S()(v,"components",{QPage:c["a"],QLinearProgress:d["a"],QDialog:m["a"],QCard:u["a"],QCardSection:h["a"],QTable:g["a"],QInput:p["a"],QIcon:y["a"],QBtn:f["a"]}),S()(v,"directives",{Ripple:b["a"]})},"2cbd":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",[a("q-breadcrumbs-el",{attrs:{icon:"home",to:"/home"}}),e._l(e.links,(function(e){return a("q-breadcrumbs-el",{key:e.link,attrs:{label:e.label,icon:e.icon,to:e.to}})}))],2)],1)},s=[],n={name:"breadcrumbs",props:{links:{type:Array}},data(){return{}},methods:{}},r=n,l=a("2877"),o=a("ead5"),c=a("079e"),d=a("eebe"),m=a.n(d),u=Object(l["a"])(r,i,s,!1,null,null,null);t["default"]=u.exports;m()(u,"components",{QBreadcrumbs:o["a"],QBreadcrumbsEl:c["a"]})},"2eb0":function(e,t,a){"use strict";a("c556")},"2f8f":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"medicRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.createUser,reset:e.onReset},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])},[a("q-input",{attrs:{filled:"",type:"email",label:e.cysmed.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(t){return e.cysmed.isValidEmail(t)||e.cysmed.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.NAME.FACILITY"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.NAME.FACILITY.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.1"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone1,callback:function(t){e.telephone1=t},expression:"telephone1"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.2"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone2,callback:function(t){e.telephone2=t},expression:"telephone2"}}),a("q-separator",{attrs:{color:"white",size:"2px"}}),e.showAccept?a("terms",{attrs:{accept:e.accept,main:e.mainLocal}}):e._e(),e.showActivation?a("div",{staticClass:"col"},[a("q-checkbox",{staticClass:"col",attrs:{label:"Send Activation Email"},model:{value:e.activationEmail,callback:function(t){e.activationEmail=t},expression:"activationEmail"}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Show Activation link"},model:{value:e.showActivationLink,callback:function(t){e.showActivationLink=t},expression:"showActivationLink"}})],1):e._e(),a("div",[a("q-btn",{attrs:{label:e.cysmed.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.cysmed.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1)],1)],1)},s=[],n=(a("ddb0"),a("15ce"));const{to:r}=a("1712"),{PLATFORM:l,ENV:o}=a("99f2");var c={props:["inside","main","cysmed"],name:"facilityRegistration",components:{terms:n["a"]},data(){return{email:"",firstName:"",lastName:"Facility",gender:"Male",gendersOriginal:["Male","Female"],genders:[],dob:"1991/11/13",telephone1:"",telephone2:"",accept:!1,showAccept:!0,showActivation:!1,showActivationLink:!1}},created(){"dev"===o&&(this.firstName="brian",this.lastName="Facility",this.email="facility@cseco.co.ke",this.telephone1="+254706662011",this.telephone2="+254706662011")},methods:{mainLocal(){return this},changeAccept(e){this.accept=e},async createUser(){return new Promise((async(e,t)=>{if(!0!==this.accept)return this.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:this.cysmed.translate("PASSAGE.READACCEPTTERMS")}),e(!1);let a,i,s={};s.email=this.email,s.firstName=this.firstName,s.lastName=this.lastName,s.gender=this.gender,s.telephone1=this.telephone1,s.telephone2=this.telephone2,s.dateOfBirth=this.dob,s.authority="FACILITY",this.inside||(a=!0),"dev"===o&&(a=!0);let n="user";this.working=!0,this.cysmed.loading=!0;let[l,c]=await r(this.cysmed.createUser(s,{activationEmail:a,showActivationLink:i},n));if(this.working=!1,console.log(l),l){l=l.msg||l.message||l.error||l;try{l=JSON.parse(l)}catch(d){}if("object"===typeof l){let e=Object.keys(l);l=l[e[0]]}this.$q.notify({type:"negative",message:this.cysmed.translate(l)||l}),e(!1)}else{this.showActivationLink?(this.alertUserId=c,this.alert=!1,this.$nextTick((()=>this.alert=!0))):this.$q.notify({type:"positive",message:this.cysmed.translate(`SUCCESS.REGISTRATION.${this.cysmed.platform}`)});try{this.main.listUsers()}catch(d){}}}))},submit(){this.$refs.medicRegistrationForm.submit()},onReset(){this.email=null,this.firstName=null,this.lastName="Facility",this.password=null,this.cpassword=null,this.accept=!1,this.dob=!1,this.telephone1="",this.telephone2=""}}},d=c,m=a("2877"),u=a("0378"),h=a("27f9"),g=a("0016"),p=a("7cbe"),y=a("52ee"),f=a("9c40"),b=a("eb85"),w=a("8f8e"),S=a("7f67"),v=a("eebe"),E=a.n(v),q=Object(m["a"])(d,i,s,!1,null,null,null);t["default"]=q.exports;E()(q,"components",{QForm:u["a"],QInput:h["a"],QIcon:g["a"],QPopupProxy:p["a"],QDate:y["a"],QBtn:f["a"],QSeparator:b["a"],QCheckbox:w["a"]}),E()(q,"directives",{ClosePopup:S["a"]})},3151:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"patientRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.createUser,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"email",label:e.cysmed.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(t){return e.cysmed.isValidEmail(t)||e.cysmed.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.NAME.FIRST"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.NAME.ANY.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.NAME.LAST"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.NAME.ANY.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}}),a("q-select",{attrs:{filled:"",options:e.genders,label:e.cysmed.translate("FIELDS.GENDER"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.GENDER.MISSING")}]},model:{value:e.gender,callback:function(t){e.gender=t},expression:"gender"}}),a("q-input",{attrs:{filled:"",mask:"date",label:e.cysmed.translate("FIELDS.DOB"),rules:["date",function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.DOB.MISSING")}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.1"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone1,callback:function(t){e.telephone1=t},expression:"telephone1"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.2"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone2,callback:function(t){e.telephone2=t},expression:"telephone2"}}),a("q-separator",{attrs:{color:"white",size:"2px"}}),e.showAccept?a("terms",{attrs:{accept:e.accept,main:e.mainLocal}}):e._e(),e.showActivation?a("div",{staticClass:"col"},[a("q-checkbox",{staticClass:"col",attrs:{label:"Send Activation Email"},model:{value:e.activationEmail,callback:function(t){e.activationEmail=t},expression:"activationEmail"}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Show Activation link"},model:{value:e.showActivationLink,callback:function(t){e.showActivationLink=t},expression:"showActivationLink"}})],1):e._e(),a("div",[a("q-btn",{attrs:{label:e.cysmed.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.cysmed.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1)],1)],1)},s=[],n=(a("ddb0"),a("15ce"));const{to:r}=a("1712"),{PLATFORM:l,ENV:o}=a("99f2");var c={props:["inside","main","cysmed"],name:"patientRegistration",components:{terms:n["a"]},data(){return{email:"",firstName:"",lastName:"",gender:"Male",gendersOriginal:["Male","Female"],genders:[],dob:"",telephone1:"",telephone2:"",accept:!1,showAccept:!0,showActivation:!1,showActivationLink:!1}},created(){"dev"===o&&(this.firstName="brian",this.lastName="Onang'o",this.email="patient@cseco.co.ke",this.dob="1991/11/13",this.telephone1="+254706662011",this.telephone2="+254706662011")},methods:{mainLocal(){return this},changeAccept(e){this.accept=e},async createUser(){return new Promise((async(e,t)=>{if(!0!==this.accept)return this.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:this.cysmed.translate("PASSAGE.READACCEPTTERMS")}),e(!1);let a,i,s={};s.email=this.email,s.firstName=this.firstName,s.lastName=this.lastName,s.gender=this.gender,s.telephone1=this.telephone1,s.telephone2=this.telephone2,s.dateOfBirth=this.dob,s.authority="PATIENT",this.inside||(a=!0),"dev"===o&&(a=!0);let n="user";this.working=!0,this.cysmed.loading=!0;let[l,c]=await r(this.cysmed.createUser(s,{activationEmail:a,showActivationLink:i},n));if(this.working=!1,console.log(l),l){l=l.msg||l.message||l.error||l;try{l=JSON.parse(l)}catch(d){}if("object"===typeof l){let e=Object.keys(l);l=l[e[0]]}this.$q.notify({type:"negative",message:this.cysmed.translate(l)||l}),e(!1)}else{this.showActivationLink?(this.alertUserId=c,this.alert=!1,this.$nextTick((()=>this.alert=!0))):this.$q.notify({type:"positive",message:this.cysmed.translate(`SUCCESS.REGISTRATION.${this.cysmed.platform}`)});try{this.main.listUsers()}catch(d){}}}))},submit(){this.$refs.patientRegistrationForm.submit()},onReset(){this.email=null,this.firstName=null,this.lastName=null,this.password=null,this.cpassword=null,this.accept=!1,this.dob=!1,this.telephone1="",this.telephone2=""}}},d=c,m=a("2877"),u=a("0378"),h=a("27f9"),g=a("ddd8"),p=a("0016"),y=a("7cbe"),f=a("52ee"),b=a("9c40"),w=a("eb85"),S=a("8f8e"),v=a("7f67"),E=a("eebe"),q=a.n(E),I=Object(m["a"])(d,i,s,!1,null,null,null);t["default"]=I.exports;q()(I,"components",{QForm:u["a"],QInput:h["a"],QSelect:g["a"],QIcon:p["a"],QPopupProxy:y["a"],QDate:f["a"],QBtn:b["a"],QSeparator:w["a"],QCheckbox:S["a"]}),q()(I,"directives",{ClosePopup:v["a"]})},"39f7":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"adminRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.createUser,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"email",label:e.cysmed.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(t){return e.cysmed.isValidEmail(t)||e.cysmed.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.NAME.FIRST"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.NAME.ANY.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.NAME.LAST"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.NAME.ANY.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}}),a("q-select",{attrs:{filled:"",options:e.genders,label:e.cysmed.translate("FIELDS.GENDER"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.GENDER.MISSING")}]},model:{value:e.gender,callback:function(t){e.gender=t},expression:"gender"}}),a("q-input",{attrs:{filled:"",mask:"date",label:e.cysmed.translate("FIELDS.DOB"),rules:["date",function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.DOB.MISSING")}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.1"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone1,callback:function(t){e.telephone1=t},expression:"telephone1"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.2"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone2,callback:function(t){e.telephone2=t},expression:"telephone2"}}),e.inside?a("div",{staticClass:"col"},[a("q-checkbox",{staticClass:"col",attrs:{label:"Send Activation Email"},model:{value:e.activationEmail,callback:function(t){e.activationEmail=t},expression:"activationEmail"}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Show Activation link"},model:{value:e.showActivationLink,callback:function(t){e.showActivationLink=t},expression:"showActivationLink"}})],1):e._e(),a("div",[a("q-btn",{attrs:{label:e.cysmed.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.cysmed.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1)],1),a("activationLink",{attrs:{alert:e.alert,alertUserId:e.alertUserId,main:e.main}})],1)},s=[],n=(a("ddb0"),a("7c83"));const{to:r}=a("1712"),{PLATFORM:l,ENV:o}=a("99f2");var c={props:["inside","main","cysmed","authority"],name:"adminRegistration",components:{activationLink:n["a"]},data(){return{showActivationLink:null,activationEmail:null,alert:!1,alertUserId:null,email:"",firstName:"",lastName:"",gender:"Male",gendersOriginal:["Male","Female"],genders:[],dob:"",telephone1:"",telephone2:""}},created(){console.log(o),"dev"===o&&(this.firstName="brian",this.lastName="Onang'o",this.email="surgbc@gmail.com",this.dob="1991/11/13",this.telephone1="+254706662011",this.telephone2="+254706662011")},methods:{async createUser(){return new Promise((async(e,t)=>{let a,i={};i.email=this.email,i.firstName=this.firstName,i.lastName=this.lastName,i.gender=this.gender,i.telephone1=this.telephone1,i.telephone2=this.telephone2,i.dateOfBirth=this.dob,i.authority=this.authority?this.authority:"SYS_ADMIN",this.authority&&(i.facilityId=(await this.cysmed.whoAmILocally()).userId),this.inside||(a=!0);let s="user";this.working=!0,this.cysmed.loading=!0;let[n,l]=await r(this.cysmed.createUser(i,{activationEmail:this.activationEmail,showActivationLink:this.showActivationLink},s));if(this.cysmed.loading=!1,this.working=!1,n){n=n.msg||n.message||n.error||n;try{n=JSON.parse(n)}catch(o){}if("object"===typeof n){let e=Object.keys(n);n=n[e[0]]}this.$q.notify({type:"negative",message:this.cysmed.translate(n)||n}),e(!1)}else{this.showActivationLink?(this.alertUserId=l,this.alert=!1,this.$nextTick((()=>this.alert=!0))):this.$q.notify({type:"positive",message:this.cysmed.translate(`SUCCESS.REGISTRATION.${this.cysmed.platform}`)});try{this.main.listUsers()}catch(o){}}}))},submit(){this.$refs.adminRegistrationForm.submit()},onReset(){this.email=null,this.firstName=null,this.lastName=null,this.password=null,this.cpassword=null,this.accept=!1,this.dob=!1,this.telephone1="",this.telephone2=""}}},d=c,m=a("2877"),u=a("0378"),h=a("27f9"),g=a("ddd8"),p=a("0016"),y=a("7cbe"),f=a("52ee"),b=a("9c40"),w=a("8f8e"),S=a("7f67"),v=a("eebe"),E=a.n(v),q=Object(m["a"])(d,i,s,!1,null,null,null);t["default"]=q.exports;E()(q,"components",{QForm:u["a"],QInput:h["a"],QSelect:g["a"],QIcon:p["a"],QPopupProxy:y["a"],QDate:f["a"],QBtn:b["a"],QCheckbox:w["a"]}),E()(q,"directives",{ClosePopup:S["a"]})},4618:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"padding"},[e.loadingSomethingBigger?a("q-linear-progress",{attrs:{indeterminate:"",color:"negative"}}):e._e(),e.rightSideBarP?a("rightSideBar",{attrs:{main:e.mainLocal,objType:"facility"}}):e._e(),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:e.createFacilityDialog,callback:function(t){e.createFacilityDialog=t},expression:"createFacilityDialog"}},[a("q-card",{staticClass:"q-ma-md"},[a("q-card-section",{staticClass:"bg-secondary text-white text-center"},[a("div",{staticClass:"text-h6"},[e._v("Create Facility")])]),a("q-card-section",{staticClass:"bg-secondary text-white"},[a("createFacility",{attrs:{main:e.mainLocal,organizationId:e.organizationId}})],1)],1)],1),e.organizationId||e.isUserPage?e._e():a("breadcrumbs",{attrs:{links:e.links}}),a("q-tabs",{attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"facilities",label:"Facilities"}}),a("q-tab",{attrs:{name:"map",label:"Map"}})],1),a("q-tab-panels",{staticClass:"q-ma-none full-width q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"facilities"}},[a("q-table",{attrs:{grid:"","card-container-class":e.cardContainerClass,data:e.allFacilities,columns:e.columns,title:"Facilities",filter:e.filter,"row-key":"name","hide-header":"","hide-bottom":"","rows-per-page-options":[0]},on:{"row-click":e.selectFacility},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.listOrganizationFacilities()}}})],1),e.organizationId?a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"add_circle",side:""},on:{click:function(t){e.createFacilityDialog=!0}}})],1):e._e()]},proxy:!0},{key:"item",fn:function(t){return[a("div",{staticClass:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},[a("q-card",{staticClass:"bg-primary",staticStyle:{height:"200px"}},[a("q-card-section",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"flex flex-center text-h6 bg-primary q-mb-none q-pb-none full-height cursor-pointer q-hoverable",on:{click:function(a){return e.selectFacility(t.row)}}},[a("strong",[e._v(e._s(t.row.facilityName))])]),a("q-btn",{staticClass:"text-white absolute-top-right q-ma-sm",attrs:{icon:"delete",color:"red"},on:{click:function(a){return e.deleteFacility(t.row)}}}),a("q-btn",{staticClass:"text-white absolute-top-left q-ma-sm",attrs:{icon:"input",color:"secondary"},on:{click:function(a){return e.manageFacilities(t.row)}}})],1)],1)]}}])})],1),a("q-tab-panel",{attrs:{name:"map"}},[a("q-page",{staticClass:"full-height full-width"},[a("div",{staticClass:"full-height full-width",staticStyle:{height:"100%",position:"absolute"}},[a("l-map",{ref:"lmap",staticClass:"full-width full-height",staticStyle:{width:"100%",height:"100%"},attrs:{zoom:e.zoom,center:e.center}},[a("l-tile-layer",{attrs:{url:e.url}}),e._l(e.allFacilities,(function(t){return a("l-marker",{key:t.facilityId,ref:"marker",refInFor:!0,attrs:{"lat-lng":t.location.coordinates,draggable:!0},on:{click:function(a){return e.selectFacility(t)}}},[a("l-popup",{staticClass:"q-pa-none q-ma-none"},[e._v("\n                "+e._s(t.facilityName||"Facility")+"\n                ")])],1)}))],2)],1)])],1)],1)],1)},s=[],n=(a("ddb0"),a("5319"),a("cf57"),a("2cbd")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"createFacilityForm",staticClass:"q-gutter-md text-white",on:{submit:e.createFacility,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:"Facility name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name for your facility"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.facilityName,callback:function(t){e.facilityName=t},expression:"facilityName"}}),a("q-input",{attrs:{filled:"",type:"text",label:"location","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a location for your facility"}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-btn",{attrs:{icon:"place"},on:{click:function(t){e.mapDialog=!0}}})]},proxy:!0}]),model:{value:e.centerString,callback:function(t){e.centerString=t},expression:"centerString"}}),a("div",[a("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1)],1),a("q-dialog",{attrs:{maximized:!1,"transition-show":"scale","transition-hide":"scale"},model:{value:e.mapDialog,callback:function(t){e.mapDialog=t},expression:"mapDialog"}},[a("div",{staticStyle:{width:"100%",height:"100%"}},[a("l-map",{ref:"lmap",staticClass:"full-width",staticStyle:{width:"100%",height:"100%"},attrs:{zoom:e.zoom,center:e.center},on:{ready:e.lmapReady}},[a("l-tile-layer",{attrs:{url:e.url}}),a("l-marker",{ref:"marker",attrs:{"lat-lng":e.center,draggable:!0}},[a("l-popup",{staticClass:"q-pa-none q-ma-none"},[a("q-card",{staticClass:"q-pa-none q-ma-none",attrs:{flat:""}},[a("q-card-section",[e._v("\n                "+e._s(e.facilityName||"Facility")+" Location\n              ")]),a("q-card-section",[e._v("\n                "+e._s(e.centerString)+"\n              ")])],1)],1)],1)],1)],1)])],1)},l=[],o=a("e11e"),c=a.n(o),d=a("2699"),m=a("a40a"),u=a("4e2b6"),h=a("fbba"),g=a("f60f");a("6cc5");const p=a("1712").to,y=a("20e6"),f=a("c2a1").default;delete c.a.Icon.Default.prototype._getIconUrl,c.a.Icon.Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")});var b={name:"createFacility",components:{LMap:d["a"],LTileLayer:m["a"],LMarker:u["a"],LIcon:h["a"],LPopup:g["a"]},props:["main","organizationId"],beforeDestroy(){this.main.loadingSomethingBigger=!1},async created(){f.setSettings({TBURL:y["TB_URL"]}),f.setSettings(y),this.centerString=this.center.join(",");window.location.hash.replace(/^[#]*[\/]*/,"")},data(){return{mapDialog:!1,facilityName:"",location:"0,0",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:15,center:[-1.286389,36.817223],centerString:"",icon:c.a.icon({iconUrl:"/images/marker-icon.png",iconSize:[32,37],iconAnchor:[16,37]}),staticAnchor:[16,37],customText:"Foobar",iconSize:64}},methods:{lmapReady(e){this.map=e,this.$refs.marker.mapObject.on("dragend",(e=>{let t=e.target._latlng;t=[t.lat,t.lng],this.center=t}))},submit(){this.$refs.createFacilityForm.submit()},async createFacility(){return f.setSettings({TBURL:y["TB_URL"]}),new Promise((async(e,t)=>{let a={center:this.center,facilityName:this.facilityName,organizationId:this.organizationId};this.main.loadingSomethingBigger=!0;let[i,s]=await p(f.createFacility(a));if(this.main.loadingSomethingBigger=!1,i){i=i.msg||i.message||i.error||i;try{i=JSON.parse(i)}catch(n){}if("object"===typeof i){let e=Object.keys(i);i=i[e[0]]}return this.$q.notify({type:"negative",message:i}),e(!1)}this.$q.notify({type:"positive",message:`${this.facilityName} created.`}),this.main.createFacilityDialog=!1,this.main.listOrganizationFacilities()}))},onReset(){this.facilityName=null}},computed:{dynamicSize(){return[this.iconSize,1.15*this.iconSize]},dynamicAnchor(){return[this.iconSize/2,1.15*this.iconSize]}},watch:{center:{handler(e){this.centerString=this.center.join(",")},deep:!0}}},w=b,S=a("2877"),v=a("0378"),E=a("27f9"),q=a("9c40"),I=a("24e8"),N=a("f09f"),T=a("a370"),O=a("eebe"),k=a.n(O),R=Object(S["a"])(w,r,l,!1,null,null,null),L=R.exports;k()(R,"components",{QForm:v["a"],QInput:E["a"],QBtn:q["a"],QDialog:I["a"],QCard:N["a"],QCardSection:T["a"]});const P=a("20e6"),C=a("c2a1").default,D=a("1712").to,x=a("6daa").default;delete c.a.Icon.Default.prototype._getIconUrl,c.a.Icon.Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")});var F={name:"facilitiesPage",props:["notOuterPage","main","facilitiesSidebar"],components:{breadcrumbs:n["default"],createFacility:L,rightSideBar:()=>Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"4d6d")),LMap:d["a"],LTileLayer:m["a"],LMarker:u["a"],LIcon:h["a"],LPopup:g["a"]},watch:{$route(e,t){this.setfilters(e.path)}},data(){return{isUserPage:!1,organizationId:null,center:[0,0],url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:5,tab:"facilities",activeElement_:"",mainLocal:this,editted:!1,loadingSomething:!1,loadingSomethingBigger:!1,rightSideBarP:!1,createFacilityDialog:!1,loaded:!0,links:[{label:"Settings",icon:"settings",to:"/system"},{label:"Facilities",icon:"corporate_fare",to:"/system"},{label:"Facilities",icon:"corporate_fare",to:"/facilities"}],checkedLoggedIn:!1,loggedIn:!1,listHck:[{name:"Users",icon:"settings",link:"/#/system/users",Authority:"Manage Users and Facilities",description:"Manage Users and Facilities"}],filter:"",columnsHck:[],columns:[{name:"facilityName",label:"Facility",field:"facilityName",sortable:!0},{name:"lastName",label:"Last Name",field:"lastName",sortable:!0},{name:"email",label:"Email",field:"email",sortable:!0}],numUsers:0,numSysAdmins:0,numActiveUsers:0,numInactiveUsers:0,numEnabledUsers:0,numDisabledusers:0,allFacilities:[],selectedRow:{}}},async created(){C.setVue(this),C.setSettings({TBURL:P["TB_URL"]});let e=window.location.hash.replace(/^[#]*[\/]*/,"");if(e.match(/system\/organizations/)){this.gettingOrganizationFor="organization";try{let t=e.match(/system\/organizations\/([a-zA-Z0-9\-]+)\/([a-zA-Z0-9\-]+)\/facilities/);t||(t=e.match(/system\/organizations\/([a-zA-Z0-9\-]+)\/([a-zA-Z0-9\-]+)\/users/)),t?t[2]&&(this.organizationId=t[2]):this.organizationId=this.main.selectedOrganization.organizationId,this.isUserPage=!1}catch(t){}}else if(e.match(/system\/users/)){let e=this.main.selectedUserId;this.userId=e,this.isUserPage=!0}else{this.isUserPage=!1;let t=e.match(/system\/facilities\/([a-zA-Z0-9\-]+)/),a=t[1];"mine"===a?(this.links[2].label="My Facilities",this.userId=(await C.whoAmILocally()).userId):"system"===a?(this.links[2].label="All Facilities",this.userId=null):this.userId=a}await this.listOrganizationFacilities()},methods:{manageFacilities(e){window.location.assign(`/#/system/facilities/system/${e.facilityId}/users`)},async deleteFacility(e){let{facilityId:t,facilityName:a}=e;return new Promise((async(t,a)=>{let[i,s]=await D(x.confirm(this,`Are you sure you want to delete ${e.facilityName}?`,"Delete Facility"));return i?t(!1):(this.main.loadingSomething=!0,[i,s]=await D(C.deleteFacility(e.facilityId)),this.main.loadingSomething=!1,i?(this.$q.notify({type:"negative",message:i.msg||i}),t(!1)):(this.$q.notify({type:"positive",message:`Facility ${e.facilityName} has been deleted.`}),void await this.listOrganizationFacilities()))}))},setfilters(e=!1){let t=(e||window.location.hash).replace(/[\/]*[#]*\//,"");switch(t){case"system/users":this.filters={},this.activeElement_="users",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"}];break;case"system/users/sys_admin":this.filters={authority:"SYS_ADMIN"},this.activeElement_="sys_admin",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Sys_Admins",icon:"settings",to:"/system/users/sys_admin"}];break;case"system/users/active":this.filters={isActive:!0},this.activeElement_="active",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Active",icon:"do_not_disturb_off",to:"/system/users/active"}];break;case"system/users/inactive":this.filters={isActive:!1},this.activeElement_="inactive",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Inactive",icon:"do_not_disturb_on",to:"/system/users/inactive"}];break;case"system/users/enabled":this.filters={enabled:!0},this.activeElement_="enabled",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Enabled",icon:"people",to:"/system/users/enabled"}];break;case"system/users/disabled":this.filters={enabled:!1},this.activeElement_="disabled",this.links=[{label:"Settings",icon:"settings",to:"/system"},{label:"Users",icon:"people",to:"/system/users"},{label:"Disabled",icon:"person_off",to:"/system/users/disabled"}];break}this.listOrganizationFacilities()},async listOrganizationFacilities(){this.loadingSomethingBigger=!0;let e=this.organizationId;console.log({organizationId:e}),console.log({organizationId:e}),console.log({organizationId:e});let[t,a]=[];if(e)[t,a]=await D(C.listOrganizationFacilities({organizationId:e}));else{let e=this.userId;this.userId?[t,a]=await D(C.listOrganizationFacilities({userId:e})):[t,a]=await D(C.listOrganizationFacilities())}this.loadingSomethingBigger=!1,t?this.$q.notify({type:"negative",message:t}):(this.allFacilities=a||[],console.log(this.allFacilities),this.center=this.allFacilities[0].location.coordinates,this.numUsers=this.allFacilities.length,this.numSysAdmins=this.allFacilities.filter((e=>"SYS_ADMIN"===e.authority)).length,this.numActiveUsers=this.allFacilities.filter((e=>!0===e.isActive)).length,this.numInactiveUsers=this.allFacilities.filter((e=>!1===e.isActive)).length,this.numEnabledUsers=this.allFacilities.filter((e=>!0===e.enabled)).length,this.numDisabledusers=this.allFacilities.filter((e=>!1===e.enabled)).length)},selectApplication(e){window.location.assign(e)},gotoPage(e){console.log(e),window.location.assign(e)},selectFacility(e){this.selectedFacility=e,this.selectedFacilityName=e.facilityName,this.selectedFacilityId=e.facilityId,this.selectedId="object"===typeof e.facilityId?e.id.facilityId:e.facilityId,this.rightSideBarP=!1,this.$nextTick((()=>this.rightSideBarP=!0))}},computed:{activeElement(){return this.activeElement_},cardContainerClass(){if(this.$q.screen.gt.xs)return"grid-masonry grid-masonry--"+(this.$q.screen.gt.sm?"6":"4")}}},A=F,_=a("9989"),z=a("6b1d"),M=a("429bb"),$=a("7460"),U=a("adad"),Q=a("823b"),B=a("eaac"),j=a("0016"),G=a("714f"),H=Object(S["a"])(A,i,s,!1,null,null,null);t["a"]=H.exports;k()(H,"components",{QPage:_["a"],QLinearProgress:z["a"],QDialog:I["a"],QCard:N["a"],QCardSection:T["a"],QTabs:M["a"],QTab:$["a"],QTabPanels:U["a"],QTabPanel:Q["a"],QTable:B["a"],QInput:E["a"],QIcon:j["a"],QBtn:q["a"]}),k()(H,"directives",{Ripple:G["a"]})},"46c6":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card",{staticClass:"bg-white",attrs:{flat:""}},[a("q-card-section",{staticClass:"flex flex-center"},[a("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"cursor-pointer q-hoverable",class:e.backgroundColor,staticStyle:{width:"80vw"},on:{click:function(t){return e.gotoPage(e.localLink)}}},[a("q-card-section",{staticClass:"text-center"},[a("div",{staticClass:"row"},[e.total1?e._e():a("div",{staticClass:"col-3 flex flex-center"},[a("q-icon",{staticStyle:{"font-size":"3em"},attrs:{name:e.iconName,color:"white"}})],1),a("div",{staticClass:"col"},[a("p",{staticClass:"text-bold"},[e._v(e._s(e.title))]),e.smallsize?e._e():a("h5",{ref:"number",staticClass:"q-ma-none"},[e._v(e._s(e.total))]),e.smallsize?a("p",{ref:"number",staticClass:"q-ma-none"},[e._v(e._s(e.total))]):e._e()])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[e.total1?a("p",{staticClass:"text-bold"},[e._v(e._s(e.title1))]):e._e(),!e.smallsize&&e.total1?a("h5",{ref:"number",staticClass:"q-ma-none"},[e._v(e._s(e.total1))]):e._e(),e.smallsize&&e.total1?a("p",{ref:"number",staticClass:"q-ma-none"},[e._v(e._s(e.total1))]):e._e()])])])],1)],1)],1)},s=[],n={props:["title","total","backgroundColor","iconName","link","smallsize","total1","title1"],mounted(){this.link?this.localLink=this.link:this.localLink=window.location.href},created(){this.link?this.localLink=this.link:this.localLink=window.location.href},computed:{},watch:{},data(){return{localLink:window.location.href,options:{separator:"."}}},methods:{gotoPage(e){console.log(e),window.location.assign(e)}}},r=n,l=(a("d47b"),a("2877")),o=a("f09f"),c=a("a370"),d=a("0016"),m=a("714f"),u=a("eebe"),h=a.n(u),g=Object(l["a"])(r,i,s,!1,null,"62cb15cc",null);t["a"]=g.exports;h()(g,"components",{QCard:o["a"],QCardSection:c["a"],QIcon:d["a"]}),h()(g,"directives",{Ripple:m["a"]})},"47cd":function(e,t,a){},"4d6d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-drawer",{staticClass:"bg-primary bg-red",attrs:{bordered:"",side:"right",width:e.rightSideBarSize,overlay:"",breakpoint:2,behavior:"desktop"},model:{value:e.rightSidebarOpen,callback:function(t){e.rightSidebarOpen=t},expression:"rightSidebarOpen"}},[e.main.loadingSomething?a("q-linear-progress",{attrs:{indeterminate:"",color:"negative"}}):e._e(),"user"===e.objType?a("userSideBar",{attrs:{main:e.main,cysmed:e.cysmed}}):e._e(),"organization"===e.objType?a("organizationSideBar",{attrs:{main:e.main}}):e._e(),"organizationMember"===e.objType?a("organizationMemberSideBar",{attrs:{main:e.main}}):e._e(),"language"===e.objType?a("language",{attrs:{main:e.main}}):e._e(),"landing"===e.objType?a("landing",{attrs:{main:e.main}}):e._e(),"facility"===e.objType?a("facilitySideBar",{attrs:{main:e.main}}):e._e(),"facilityMember"===e.objType?a("facilityMemberSideBar",{attrs:{main:e.main}}):e._e()],1)},s=[],n=(a("cf57"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v(e._s(e.main.selectedEmail))]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("User details")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.main.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent",disable:!0}}):e._e(),e.openedEditing&&e.main.editted?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}}),a("q-tab",{attrs:{name:"auditLogs",label:"Audit Logs"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("userDetails",{attrs:{cysmed:e.cysmed,main:e.main,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1),a("q-tab-panel",{attrs:{name:"auditLogs"}},[a("auditLogs",{attrs:{main:e.main,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1),a("q-tab-panel",{attrs:{name:"organizations"}},[a("organizationsPage",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset,notOuterPage:!0}})],1),a("q-tab-panel",{attrs:{name:"facilities"}},[a("facilitiesPage",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset,notOuterPage:!0}})],1),a("q-tab-panel",{attrs:{name:"registrations"}},[e._v(" Under construction ")])],1)],1)],1)}),r=[],l=(a("ddb0"),a("82ef")),o=a("1b38"),c=a("4618");a("bc3a"),a("1712").to;const d=a("c2a1").default;var m={name:"userSideBar",props:["main","cysmed"],async created(){this.authority=(await d.whoAmILocally()).authority,d.setVue(this),this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{userDetails:async()=>{let e=(await d.whoAmILocally()).authority;return e.match(/LOCAL_/)?Promise.all([a.e(0),a.e(22)]).then(a.bind(null,"e3be")):Promise.all([a.e(0),a.e(1),a.e(21)]).then(a.bind(null,"add7"))},auditLogs:l["a"],organizationsPage:o["a"],facilitiesPage:c["a"]},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{authority:"",rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBar=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},u=m,h=a("2877"),g=a("65c6"),p=a("6ac5"),y=a("9c40"),f=a("de5e"),b=a("429bb"),w=a("7460"),S=a("eb85"),v=a("adad"),E=a("823b"),q=a("eebe"),I=a.n(q),N=Object(h["a"])(u,n,r,!1,null,null,null),T=N.exports;I()(N,"components",{QToolbar:g["a"],QToolbarTitle:p["a"],QBtn:y["a"],QPageSticky:f["a"],QTabs:b["a"],QTab:w["a"],QSeparator:S["a"],QTabPanels:v["a"],QTabPanel:E["a"]});var O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v(e._s(e.main.selectedOrganization.organizationName))]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("Organization details")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.main.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent",disable:!0}}):e._e(),e.openedEditing&&e.main.editted?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}}),a("q-tab",{attrs:{name:"facilities",label:"Facilities"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none  q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("organizationDetails",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1),a("q-tab-panel",{attrs:{name:"facilities"}},[a("q-tab-panel",{attrs:{name:"organizations"}},[a("facilitiesPage",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset,notOuterPage:!0}})],1)],1)],1)],1)],1)},k=[],R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.openedEditing?e._e():a("div",{staticClass:"q-pa-sm"},[a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Users"},on:{click:e.manageUsers}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Facilities"},on:{click:e.manageFacilities}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Admins"},on:{click:e.manageAdmins}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Delete Organization"},on:{click:e.deleteOrganization}})],1),a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.editOrganization}},[a("q-input",{attrs:{filled:"",type:"text",label:"Organization Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!e.openedEditing},model:{value:e.selectedOrganization.organizationName,callback:function(t){e.$set(e.selectedOrganization,"organizationName",t)},expression:"selectedOrganization.organizationName"}})],1)],1)},L=[],P=(a("5319"),a("7c83"));a("bc3a");const C=a("1712").to,D=a("20e6"),x=a("c2a1").default,F=a("6daa").default;var A={name:"organizationDetails",props:["main","openedEditing","submit","reset","immediateMain"],components:{activationLink:P["a"]},beforeDestroy(){this.main.loadingSomething=!1},async created(){x.setSettings({TBURL:D["TB_URL"]}),x.setVue(this),this.selectedOrganization=JSON.parse(JSON.stringify(this.main.selectedOrganization));let[e,t]=await C(x.whoAmILocally());t&&(this.whoami=t);let a=window.location.hash.replace(/^[#]*[\/]*/,"");if(a.match(/system\/users/)){this.gettingOrganizationFor="user";try{this.userId=this.main.selectedRow.userId}catch(i){}}else if(a.match(/system\/(organizations)\/([a-zA-Z0-9]+)/)){let e=a.match(/system\/organizations\/([a-zA-Z0-9\-]+)/),t=e[1];this.userId="mine"===t?(await x.whoAmILocally()).userId:"system"===t?null:t}},data(){return{selectedOrganization:{},whoami:{},userChanged:!1,alert:!1}},methods:{async editOrganization(){return new Promise((async(e,t)=>{let a={organizationName:this.selectedOrganization.organizationName,organizationId:this.selectedOrganization.organizationId};this.main.loadingSomething=!0;let[i,s]=await C(x.editOrganization(a));if(this.main.loadingSomething=!1,console.log(i),i)return this.$q.notify({type:"negative",message:i.msg||i}),e(!1);this.$q.notify({type:"positive",message:`Saved changes for ${this.selectedOrganization.organizationName}`}),await this.main.listUserOrganizations(),this.immediateMain.openedEditing=!1,this.main.selectedOrganization=this.selectedOrganization,this.main.editted=!1,e(!0)}))},async deleteOrganization(e){return new Promise((async(e,t)=>{let[a,i]=await C(F.confirm(this,`Are you sure you want to delete ${this.main.selectedOrganization.organizationName}?`,"Delete Organization"));return a?e(!1):(this.main.loadingSomething=!0,[a,i]=await C(x.deleteOrganization(this.main.selectedOrganization.organizationId)),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Organization ${this.main.selectedOrganization.organizationName} has been deleted.`}),void await this.main.listUserOrganizations()))}))},async manageAdmins(e){let t="";t="user"===this.gettingOrganizationFor?`/#/system/organizations/${this.main.selectedRow.userId}/${this.main.selectedOrganization.organizationId}/users/org_admin`:window.location.href+`/${this.main.selectedOrganization.organizationId}/users/org_admin`,window.location.assign(t)},async manageFacilities(){let e="";e="user"===this.gettingOrganizationFor?`/#/system/organizations/${this.main.selectedRow.userId}/${this.main.selectedOrganization.organizationId}/facilities`:window.location.href+`/${this.main.selectedOrganization.organizationId}/facilities`,window.location.assign(e)},manageUsers(){let e="";e="user"===this.gettingOrganizationFor?`/#/system/organizations/${this.main.selectedRow.userId}/${this.main.selectedOrganization.organizationId}/users`:window.location.href+`/${this.main.selectedOrganization.organizationId}/users`,window.location.assign(e)}},computed:{userEditted(){return(this.main.selectedOrganization.firstName!==this.originalSelectedUser.firstName||this.main.selectedOrganization.lastName!==this.originalSelectedUser.lastName||this.main.selectedOrganization.authority!==this.originalSelectedUser.authority||this.main.selectedOrganization.dateOfBirth!==this.originalSelectedUser.dateOfBirth||this.main.selectedOrganization.gender!==this.originalSelectedUser.gender||this.main.selectedOrganization.enabled!==this.originalSelectedUser.enabled)&&(this.main.editted=!0)}},watch:{selectedOrganization:{handler(e){JSON.stringify(this.selectedOrganization)!==JSON.stringify(this.main.selectedOrganization)?this.main.editted=!0:this.main.editted=!1},deep:!0},submit(e){e&&this.$refs.userRegistrationForm.submit()},reset(e){e&&(this.selectedOrganization=JSON.parse(JSON.stringify(this.main.selectedOrganization)))}}},_=A,z=a("0378"),M=a("27f9"),$=Object(h["a"])(_,R,L,!1,null,null,null),U=$.exports;I()($,"components",{QBtn:y["a"],QForm:z["a"],QInput:M["a"]});a("bc3a"),a("1712").to;var Q={name:"organizationSideBar",props:["main"],created(){this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{organizationDetails:U,facilitiesPage:c["a"]},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBarP=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},B=Q,j=Object(h["a"])(B,O,k,!1,null,null,null),G=j.exports;I()(j,"components",{QToolbar:g["a"],QToolbarTitle:p["a"],QBtn:y["a"],QPageSticky:f["a"],QTabs:b["a"],QTab:w["a"],QSeparator:S["a"],QTabPanels:v["a"],QTabPanel:E["a"]});var H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v(e._s(e.main.selectedFacility.facilityName))]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("Facility details")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"1000"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.main.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent",disable:!0}}):e._e(),e.openedEditing&&e.main.editted?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none  q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("facilityDetails",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1)],1)],1)],1)},Y=[],V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.openedEditing?e._e():a("div",{staticClass:"q-pa-sm"},[a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Users"},on:{click:e.manageUsers}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Manage Admins"},on:{click:e.manageAdmins}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Delete Facility"},on:{click:e.deleteFacility}})],1),a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.editFacility}},[a("q-input",{attrs:{filled:"",type:"text",label:"Facility Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!e.openedEditing},model:{value:e.selectedFacility.facilityName,callback:function(t){e.$set(e.selectedFacility,"facilityName",t)},expression:"selectedFacility.facilityName"}})],1),a("q-page",{staticClass:"full-height full-width"},[a("div",{staticClass:"full-height full-width",staticStyle:{height:"100%",position:"absolute"}},[a("l-map",{ref:"lmap",staticClass:"full-width full-height",staticStyle:{width:"100%",height:"100%"},attrs:{zoom:e.zoom,center:e.center},on:{ready:e.lmapReady}},[a("l-tile-layer",{attrs:{url:e.url}}),a("l-marker",{ref:"marker",attrs:{"lat-lng":e.center,draggable:!0}})],1)],1)])],1)},J=[],W=a("e11e"),Z=a.n(W),K=a("2699"),X=a("a40a"),ee=a("4e2b6"),te=a("fbba"),ae=a("f60f");a("6cc5");a("bc3a");const ie=a("1712").to,se=a("20e6"),ne=a("c2a1").default,re=a("6daa").default;delete Z.a.Icon.Default.prototype._getIconUrl,Z.a.Icon.Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")});var le={name:"facilityDetails",props:["main","openedEditing","submit","reset","immediateMain"],components:{LMap:K["a"],LTileLayer:X["a"],LMarker:ee["a"],LIcon:te["a"],LPopup:ae["a"]},beforeDestroy(){this.main.loadingSomething=!1},async created(){ne.setSettings({TBURL:se["TB_URL"]}),ne.setVue(this),this.selectedFacility=JSON.parse(JSON.stringify(this.main.selectedFacility)),this.center=this.selectedFacility.location.coordinates,this.centerOriginal=this.center,this.selectedFacility.facilityNameOriginal=this.selectedFacility.facilityName},data(){return{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:15,center:[-1.286389,36.817223],selectedFacility:{},whoami:{},userChanged:!1,alert:!1}},methods:{lmapReady(e){this.map=e,this.$refs.marker.mapObject.on("dragend",(e=>{let t=e.target._latlng;if(t=[t.lat,t.lng],!this.openedEditing)return this.center=this.centerOriginal,void this.$refs.marker.mapObject.setLatLng(this.center).update();this.center=t}))},async editFacility(){return new Promise((async(e,t)=>{let a={facilityName:this.selectedFacility.facilityName,facilityId:this.selectedFacility.facilityId,center:this.center};this.main.loadingSomething=!0;let[i,s]=await ie(ne.editFacility(a));if(this.main.loadingSomething=!1,i)return this.$q.notify({type:"negative",message:i.msg||i}),e(!1);this.$q.notify({type:"positive",message:`Saved changes for ${this.selectedFacility.facilityName}`}),await this.main.listOrganizationFacilities(),this.immediateMain.openedEditing=!1,this.main.selectedFacility=this.selectedFacility,this.main.editted=!1,e(!0)}))},async deleteFacility(){return new Promise((async(e,t)=>{let[a,i]=await ie(re.confirm(this,`Are you sure you want to delete ${this.main.selectedFacility.facilityName}?`,"Delete Facility"));return a?e(!1):(this.main.loadingSomething=!0,[a,i]=await ie(ne.deleteFacility(this.main.selectedFacility.facilityId)),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Facility ${this.main.selectedFacility.facilityName} has been deleted.`}),void await this.main.listOrganizationFacilities()))}))},async manageAdmins(e){let t="";if("user"===this.gettingFacilityFor)t=`/#/system/organizations/${this.main.selectedRow.userId}/${this.main.selectedFacility.organizationId}/users/facility_admin`;else{let e=window.location.hash.replace(/^[#]*[\/]*/,"");t=(e.match(/system\/organizations\/([a-zA-Z0-9\-]+)\/([a-zA-Z0-9\-]+)\/facilities/),`/#/system/facilities/system/${this.main.selectedFacility.facilityId}/users/facility_admin`)}window.location.assign(t)},async manageFacilities(){let e="";e="user"===this.gettingFacilityFor?`/#/system/organizations/${this.main.selectedRow.userId}/${this.main.selectedFacility.organizationId}/facilities`:window.location.href+`/${this.main.selectedFacility.organizationId}/facilities`,window.location.assign(e)},manageUsers(){let e=window.location.hash.replace(/^[#]*[\/]*/,""),t="";t="user"===this.gettingFacilityFor?`/#/system/organizations/${this.main.selectedRow.userId}/${this.main.selectedFacility.organizationId}/users`:(e.match(/system\/organizations\/([a-zA-Z0-9\-]+)\/([a-zA-Z0-9\-]+)\/facilities/),`/#/system/facilities/system/${this.main.selectedFacility.facilityId}/users`),window.location.assign(t)}},computed:{userEditted(){return(this.main.selectedFacility.firstName!==this.originalSelectedUser.firstName||this.main.selectedFacility.lastName!==this.originalSelectedUser.lastName||this.main.selectedFacility.authority!==this.originalSelectedUser.authority||this.main.selectedFacility.dateOfBirth!==this.originalSelectedUser.dateOfBirth||this.main.selectedFacility.gender!==this.originalSelectedUser.gender||this.main.selectedFacility.enabled!==this.originalSelectedUser.enabled)&&(this.main.editted=!0)}},watch:{center:{handler(e){JSON.stringify(this.center)!==JSON.stringify(this.main.centerOriginal)||this.selectedFacility.facilityName!==selectedFacility.facilityNameOriginal?this.main.editted=!0:this.main.editted=!1},deep:!0},"main.selectedFacility.facilityName":{handler(e){JSON.stringify(this.center)!==JSON.stringify(this.main.centerOriginal)||this.selectedFacility.facilityName!==selectedFacility.facilityNameOriginal?this.main.editted=!0:this.main.editted=!1},deep:!0},submit(e){e&&this.$refs.userRegistrationForm.submit()},reset(e){e&&(this.selectedFacility.facilityName=this.selectedFacility.facilityNameOriginal,this.center=this.centerOriginal,this.$refs.marker.mapObject.setLatLng(this.center).update())}}},oe=le,ce=a("9989"),de=Object(h["a"])(oe,V,J,!1,null,null,null),me=de.exports;I()(de,"components",{QBtn:y["a"],QForm:z["a"],QInput:M["a"],QPage:ce["a"]});a("bc3a"),a("1712").to;var ue={name:"facilitySideBar",props:["main"],created(){this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{facilityDetails:me},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBarP=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},he=ue,ge=Object(h["a"])(he,H,Y,!1,null,null,null),pe=ge.exports;I()(ge,"components",{QToolbar:g["a"],QToolbarTitle:p["a"],QBtn:y["a"],QPageSticky:f["a"],QTabs:b["a"],QTab:w["a"],QSeparator:S["a"],QTabPanels:v["a"],QTabPanel:E["a"]});var ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v(e._s(e.main.selectedEmail))]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("Organization Member details")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.main.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent",disable:!0}}):e._e(),e.openedEditing&&e.main.editted?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none  q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("organizationMemberDetails",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1)],1)],1)],1)},fe=[],be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.openedEditing?e._e():a("div",{staticClass:"q-pa-sm"},[a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Transfer Organization to User",disable:e.main.selectedIsOwner},on:{click:e.transferOrganization}}),a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Delete Member"},on:{click:e.deleteMember}})],1),a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.transferOrganization}},[a("q-input",{attrs:{filled:"",type:"text",label:"Email Address","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!0},model:{value:e.main.selectedEmail,callback:function(t){e.$set(e.main,"selectedEmail",t)},expression:"main.selectedEmail"}}),a("q-input",{attrs:{filled:"",type:"text",label:"Full Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!0},model:{value:e.main.selectedFullName,callback:function(t){e.$set(e.main,"selectedFullName",t)},expression:"main.selectedFullName"}})],1)],1)},we=[];a("bc3a");const Se=a("1712").to,ve=a("20e6"),Ee=a("c2a1").default,qe=a("6daa").default;var Ie={name:"organizationMemberDetails",props:["main","openedEditing","submit","reset","immediateMain"],components:{activationLink:P["a"]},beforeDestroy(){this.main.loadingSomething=!1},async created(){Ee.setSettings({TBURL:ve["TB_URL"]}),Ee.setVue(this);let[e,t]=await Se(Ee.whoAmILocally());t&&(this.whoami=t)},data(){return{}},methods:{async deleteMember(e){return new Promise((async(e,t)=>{let[a,i]=await Se(qe.confirm(this,`Are you sure you want to remove ${this.main.selectedFullName} from ${this.main.currentOrganization.organizationName}?`,"Delete Member"));return a?e(!1):(this.main.loadingSomething=!0,[a,i]=await Se(Ee.deleteOrganizationUser(this.main.selectedOrganizationUserId)),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Account for ${this.main.selectedFullName} has been removed.`}),void await this.main.listOrganizationMembers()))}))},async transferOrganization(){return new Promise((async(e,t)=>{let[a,i]=await Se(qe.confirm(this,`Are you sure you want to transfer organization to ${this.main.selectedFullName}?`,"Transfer Organization"));return a?e(!1):(this.main.loadingSomething=!0,[a,i]=await Se(Ee.transferOrganization({userId:this.main.selecteduserId,organizationId:this.main.currentOrganization.organizationId})),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Organization ${this.main.currentOrganization.organizationName} has been transfered to new owner.`}),void await this.main.listOrganizationMembers()))}))}},computed:{userEditted(){return!1}},watch:{selectedOrganization:{handler(e){},deep:!0},submit(e){},reset(e){}}},Ne=Ie,Te=Object(h["a"])(Ne,be,we,!1,null,null,null),Oe=Te.exports;I()(Te,"components",{QBtn:y["a"],QForm:z["a"],QInput:M["a"]});a("bc3a"),a("1712").to;var ke={name:"organizationMemberSideBar",props:["main"],created(){this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{organizationMemberDetails:Oe},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBar=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},Re=ke,Le=Object(h["a"])(Re,ye,fe,!1,null,null,null),Pe=Le.exports;I()(Le,"components",{QToolbar:g["a"],QToolbarTitle:p["a"],QBtn:y["a"],QPageSticky:f["a"],QTabs:b["a"],QTab:w["a"],QSeparator:S["a"],QTabPanels:v["a"],QTabPanel:E["a"]});var Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v(e._s(e.main.selectedEmail))]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("Facility Member details")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.main.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent",disable:!0}}):e._e(),e.openedEditing&&e.main.editted?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none  q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("facilityMemberDetails",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1)],1)],1)],1)},De=[],xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.openedEditing?e._e():a("div",{staticClass:"q-pa-sm"},[a("q-btn",{staticClass:"bg-primary q-mr-md q-mb-md",attrs:{"no-caps":"",label:"Delete Member"},on:{click:e.deleteMember}})],1),a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.transferOrganization}},[a("q-input",{attrs:{filled:"",type:"text",label:"Email Address","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!0},model:{value:e.main.selectedEmail,callback:function(t){e.$set(e.main,"selectedEmail",t)},expression:"main.selectedEmail"}}),a("q-input",{attrs:{filled:"",type:"text",label:"Full Name","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a name"}],disable:!0},model:{value:e.main.selectedFullName,callback:function(t){e.$set(e.main,"selectedFullName",t)},expression:"main.selectedFullName"}})],1)],1)},Fe=[];a("bc3a");const Ae=a("1712").to,_e=a("20e6"),ze=a("c2a1").default,Me=a("6daa").default;var $e={name:"organizationMemberDetails",props:["main","openedEditing","submit","reset","immediateMain"],components:{activationLink:P["a"]},beforeDestroy(){this.main.loadingSomething=!1},async created(){ze.setSettings({TBURL:_e["TB_URL"]}),ze.setVue(this);let[e,t]=await Ae(ze.whoAmILocally());t&&(this.whoami=t)},data(){return{}},methods:{async deleteMember(e){return new Promise((async(e,t)=>{let[a,i]=await Ae(Me.confirm(this,`Are you sure you want to remove ${this.main.selectedFullName} from ${this.main.currentFacility.facilityName}?`,"Delete Member"));return a?e(!1):(this.main.loadingSomething=!0,[a,i]=await Ae(ze.deleteFacilityUser(this.main.selectedFacilityUserId)),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Account for ${this.main.selectedFullName} has been removed.`}),void await this.main.listFacilityMembers()))}))},async transferOrganization(){return new Promise((async(e,t)=>{let[a,i]=await Ae(Me.confirm(this,`Are you sure you want to transfer organization to ${this.main.selectedFullName}?`,"Transfer Organization"));return a?e(!1):(this.main.loadingSomething=!0,[a,i]=await Ae(ze.transferOrganization({userId:this.main.selecteduserId,organizationId:this.main.currentOrganization.organizationId})),this.main.loadingSomething=!1,a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:`Organization ${this.main.currentOrganization.organizationName} has been transfered to new owner.`}),void await this.main.listOrganizationMembers()))}))}},computed:{userEditted(){return!1}},watch:{selectedOrganization:{handler(e){},deep:!0},submit(e){},reset(e){}}},Ue=$e,Qe=Object(h["a"])(Ue,xe,Fe,!1,null,null,null),Be=Qe.exports;I()(Qe,"components",{QBtn:y["a"],QForm:z["a"],QInput:M["a"]});a("bc3a"),a("1712").to;var je={name:"facilityMemberSideBar",props:["main"],created(){this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{facilityMemberDetails:Be},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBar=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},Ge=je,He=Object(h["a"])(Ge,Ce,De,!1,null,null,null),Ye=He.exports;I()(He,"components",{QToolbar:g["a"],QToolbarTitle:p["a"],QBtn:y["a"],QPageSticky:f["a"],QTabs:b["a"],QTab:w["a"],QSeparator:S["a"],QTabPanels:v["a"],QTabPanel:E["a"]});var Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v("Settings")]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("Language Settings")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing&&!e.editted?a("q-btn",{staticClass:"text-black q-mr-sm",attrs:{fab:"",icon:"done",color:"transparent",disable:!0}}):e._e(),e.openedEditing&&e.editted?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"details",label:"Details"}})],1),a("q-separator"),a("div",[a("q-tab-panels",{staticClass:"q-ma-none q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"details"}},[a("changeLanguage",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1)],1)],1)],1)},Je=[],We=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"changeLangForm",staticClass:"q-gutter-md text-white",on:{submit:e.changeLang}},[a("q-select",{attrs:{filled:"",options:e.langs,label:"Language","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please select a language"}],disable:!e.immediateMain.openedEditing},on:{input:e.changeLang},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}})],1)],1)},Ze=[];a("bc3a"),a("1712").to;const Ke=a("ea76").default;var Xe={name:"changeLanguage",props:["openedEditing","immediateMain","main","submit","reset"],components:{},beforeDestroy(){},async created(){this.lang=Ke.getLang(),this.langs=Ke.listLangs(),this.langOriginal=this.lang,this.main.immediateMain=!1},data(){return{lang:"",langOriginal:"",langs:[]}},methods:{async changeLang(){}},computed:{lange(){this.lang!==this.langOriginal&&(this.immediateMain.editted=!0)||(this.immediateMain.editted=!1)}},watch:{lang(e){this.lang!==this.langOriginal&&(this.immediateMain.editted=!0)||(this.immediateMain.editted=!1)},submit(e){if(e){let e=this.lang;Ke.setLang(e),this.langOriginal=this.lang,this.immediateMain.editted=!1}},reset(e){e&&(this.lang=this.langOriginal)}}},et=Xe,tt=a("ddd8"),at=Object(h["a"])(et,We,Ze,!1,null,null,null),it=at.exports;I()(at,"components",{QForm:z["a"],QSelect:tt["a"]});a("bc3a"),a("1712").to;var st={name:"language",props:["main"],created(){this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{changeLanguage:it},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{editted:!1,rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBarP=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},nt=st,rt=Object(h["a"])(nt,Ve,Je,!1,null,null,null),lt=rt.exports;I()(rt,"components",{QToolbar:g["a"],QToolbarTitle:p["a"],QBtn:y["a"],QPageSticky:f["a"],QTabs:b["a"],QTab:w["a"],QSeparator:S["a"],QTabPanels:v["a"],QTabPanel:E["a"]});var ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",{staticClass:"q-mt-md q-ml-md"},[a("span",{staticClass:"text-weight-bold q-pt-lg"},[e._v("Settings")]),a("br"),a("span",{staticClass:"text-caption",staticStyle:{"font-size":"0.8em"}},[e._v("Navigate to new page to change landing page")])]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.closeSelf}})],1),a("q-page-sticky",{staticClass:"q-gutter-xs q-ma-sm",staticStyle:{"z-index":"3"},attrs:{position:"top-right",offset:[18,0]}},[e.openedEditing?e._e():a("q-btn",{staticClass:"q-ma-sm",attrs:{fab:"",icon:"edit",color:"red"},on:{click:function(t){e.openedEditing=!0}}}),e.openedEditing?a("q-btn",{staticClass:"q-mr-sm",attrs:{fab:"",icon:"done",color:"red"},on:{click:e.submitForm}}):e._e(),e.openedEditing?a("q-btn",{attrs:{fab:"",icon:"close",color:"red"},on:{click:e.resetForm}}):e._e()],1),a("q-separator"),a("div",[a("changeLanding",{attrs:{main:e.main,immediateMain:e.immediateMain,openedEditing:e.openedEditing,submit:e.submit,reset:e.reset}})],1)],1)},ct=[],dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("iframe",{ref:"defaultLandingIframe",staticStyle:{width:"100%",height:"100%",position:"absolute","overflow-y":"hidden"},attrs:{src:e.url,scrolling:"no",frameBorder:"0"}}),e.immediateMain.openedEditing?e._e():a("div",{staticClass:"bg-transparent absolute-center full-height",staticStyle:{width:"100%",height:"100% z-index:300"}})])},mt=[];const ut=a("c2a1").default;var ht={name:"changeLanding",props:["openedEditing","immediateMain","main","submit","reset"],components:{},beforeDestroy(){},data(){return{links:[{label:"Settings",icon:"settings",to:"/system"},{label:"Default Home",icon:"house",to:"/system/landing_page"}],url:""}},created(){let e=ut.getDefaultPageAfterLogin("");this.url=e,this.urlOriginal=e},watch:{submit(e){if(e){let e=this.url;e=this.$refs.defaultLandingIframe.contentDocument.location.href.split(window.location.protocol+"//"+window.location.host).join(""),ut.setDefaultPageAfterLogin(e),console.log({defaultUrl:e}),this.immediateMain.openedEditing=!1}},reset(e){this.url=this.urlOriginal,this.immediateMain.openedEditing=!1}}},gt=ht,pt=Object(h["a"])(gt,dt,mt,!1,null,null,null),yt=pt.exports;I()(pt,"components",{QPage:ce["a"]});a("bc3a"),a("1712").to;var ft={name:"landing",props:["main"],created(){this.main.selectedTab&&(this.tab=this.main.selectedTab)},components:{changeLanding:yt},beforeDestroy(){this.main.selectedTab=this.tab},data(){return{editted:!1,rightSidebarOpen:!0,tab:"details",openedEditing:!1,submit:!1,reset:!1,immediateMain:this}},methods:{submitForm(){this.submit=!1,this.$nextTick((()=>this.submit=!0))},closeSelf(){this.main.rightSideBarP=!1},resetForm(){this.reset=!1,this.$nextTick((()=>this.reset=!0)),this.openedEditing=!1,this.main.editted=!1}},computed:{}},bt=ft,wt=Object(h["a"])(bt,ot,ct,!1,null,null,null),St=wt.exports;I()(wt,"components",{QToolbar:g["a"],QToolbarTitle:p["a"],QBtn:y["a"],QPageSticky:f["a"],QTabs:b["a"],QTab:w["a"],QSeparator:S["a"],QTabPanels:v["a"],QTabPanel:E["a"]});a("bc3a"),a("1712").to;var vt={name:"rightSideBar",props:["main","objType","cysmed"],created(){},components:{userSideBar:T,organizationSideBar:G,organizationMemberSideBar:Pe,facilityMemberSideBar:Ye,language:lt,landing:St,facilitySideBar:pe},data(){return{rightSidebarOpen:!0,tab:"login"}},methods:{},computed:{rightSideBarSize(){return this.$q.screen.lt.xs||this.$q.screen.lt.sm||this.$q.screen.lt.md?document.getElementsByTagName("body")[0].clientWidth:.75*document.getElementsByTagName("body")[0].clientWidth}}},Et=vt,qt=a("9404"),It=a("6b1d"),Nt=Object(h["a"])(Et,i,s,!1,null,null,null);t["default"]=Nt.exports;I()(Nt,"components",{QDrawer:qt["a"],QLinearProgress:It["a"]})},"50e3":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"medicRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.createUser,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"email",label:e.cysmed.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(t){return e.cysmed.isValidEmail(t)||e.cysmed.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.NAME.FIRST"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.NAME.ANY.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.NAME.LAST"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.NAME.ANY.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}}),a("q-select",{attrs:{filled:"",options:e.genders,label:e.cysmed.translate("FIELDS.GENDER"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.GENDER.MISSING")}]},model:{value:e.gender,callback:function(t){e.gender=t},expression:"gender"}}),a("q-input",{attrs:{filled:"",mask:"date",label:e.cysmed.translate("FIELDS.DOB"),rules:["date",function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.DOB.MISSING")}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.dob,callback:function(t){e.dob=t},expression:"dob"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.1"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.1.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone1,callback:function(t){e.telephone1=t},expression:"telephone1"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.2"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.2.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.telephone2,callback:function(t){e.telephone2=t},expression:"telephone2"}}),a("q-separator",{attrs:{color:"white",size:"2px"}}),e.showAccept?a("terms",{attrs:{accept:e.accept,main:e.mainLocal}}):e._e(),e.showActivation?a("div",{staticClass:"col"},[a("q-checkbox",{staticClass:"col",attrs:{label:"Send Activation Email"},model:{value:e.activationEmail,callback:function(t){e.activationEmail=t},expression:"activationEmail"}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Show Activation link"},model:{value:e.showActivationLink,callback:function(t){e.showActivationLink=t},expression:"showActivationLink"}})],1):e._e(),a("div",[a("q-btn",{attrs:{label:e.cysmed.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:e.cysmed.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1)],1)],1)},s=[],n=(a("ddb0"),a("15ce"));const{to:r}=a("1712"),{PLATFORM:l,ENV:o}=a("99f2");var c={props:["inside","main","cysmed"],name:"medicRegistration",components:{terms:n["a"]},data(){return{email:"",firstName:"",lastName:"",gender:"Male",gendersOriginal:["Male","Female"],genders:[],dob:"",telephone1:"",telephone2:"",accept:!1,showAccept:!0,showActivation:!1,showActivationLink:!1}},created(){"dev"===o&&(this.firstName="brian",this.lastName="Onang'o",this.email="medic@cseco.co.ke",this.dob="1991/11/13",this.telephone1="+254706662011",this.telephone2="+254706662011")},methods:{mainLocal(){return this},changeAccept(e){this.accept=e},async createUser(){return new Promise((async(e,t)=>{if(!0!==this.accept)return this.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:this.cysmed.translate("PASSAGE.READACCEPTTERMS")}),e(!1);let a,i,s={};s.email=this.email,s.firstName=this.firstName,s.lastName=this.lastName,s.gender=this.gender,s.telephone1=this.telephone1,s.telephone2=this.telephone2,s.dateOfBirth=this.dob,s.authority="MEDIC",this.inside||(a=!0),"dev"===o&&(a=!0);let n="user";this.working=!0,this.cysmed.loading=!0;let[l,c]=await r(this.cysmed.createUser(s,{activationEmail:a,showActivationLink:i},n));if(this.working=!1,console.log(l),l){l=l.msg||l.message||l.error||l;try{l=JSON.parse(l)}catch(d){}if("object"===typeof l){let e=Object.keys(l);l=l[e[0]]}this.$q.notify({type:"negative",message:this.cysmed.translate(l)||l}),e(!1)}else{this.showActivationLink?(this.alertUserId=c,this.alert=!1,this.$nextTick((()=>this.alert=!0))):this.$q.notify({type:"positive",message:this.cysmed.translate(`SUCCESS.REGISTRATION.${this.cysmed.platform}`)});try{this.main.listUsers()}catch(d){}}}))},submit(){this.$refs.medicRegistrationForm.submit()},onReset(){this.email=null,this.firstName=null,this.lastName=null,this.password=null,this.cpassword=null,this.accept=!1,this.dob=!1,this.telephone1="",this.telephone2=""}}},d=c,m=a("2877"),u=a("0378"),h=a("27f9"),g=a("ddd8"),p=a("0016"),y=a("7cbe"),f=a("52ee"),b=a("9c40"),w=a("eb85"),S=a("8f8e"),v=a("7f67"),E=a("eebe"),q=a.n(E),I=Object(m["a"])(d,i,s,!1,null,null,null);t["default"]=I.exports;q()(I,"components",{QForm:u["a"],QInput:h["a"],QSelect:g["a"],QIcon:p["a"],QPopupProxy:y["a"],QDate:f["a"],QBtn:b["a"],QSeparator:w["a"],QCheckbox:S["a"]}),q()(I,"directives",{ClosePopup:v["a"]})},"51e2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-card",{staticClass:"my-card",staticStyle:{position:"relative"}},[a("q-card-section",{staticClass:"bg-secondary text-white text-center"},[a("div",{staticClass:"text-h6"},[e._v(e._s(e.translate("PROJECT.NAME")))]),"ADMIN"===e.userType?a("div",[e._v("Admin")]):e._e(),e.hasAdmin?e._e():a("q-tabs",{staticClass:"text-white",model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"login",icon:"login",label:e.translate("ACTIONS.LOGIN")},on:{click:e.removeRecoveringPassword}}),"DESKTOP"!==e.cysmed.platform?a("q-tab",{attrs:{name:"register",icon:"person_add",label:e.translate("ACTIONS.REGISTER")}}):e._e()],1)],1),a("q-card-section",{staticClass:"bg-secondary text-white q-pa-none"},[a("q-tab-panels",{staticClass:"bg-secondary q-ma-none full-width q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"login"}},[a("loginFormSelect",{attrs:{cysmed:e.cysmed,userType:e.userType,recoveringPassword:e.recoveringPassword,setRecoveringPassword:e.setRecoveringPassword}})],1),a("q-tab-panel",{attrs:{name:"register"}},[a("registrationForm",{attrs:{cysmed:e.cysmed,userType:e.userType}})],1)],1)],1)],1)},s=[],n=(a("ddb0"),a("b758"));const r=a("20e6"),l=a("ea76").default,o=a("1712").to,{PLATFORM:c,ENV:d}=a("99f2");var m={name:"authForms",components:{loginFormSelect:n["default"],registrationForm:async()=>new Promise((async(e,t)=>{let i="./",s="registrationForm.vue",n=null;try{n=await a("95a5")(`${i}${s.split(".").join(`.${c}.`)}`)}catch(r){n=await a("95a5")(`${i}${s}`)}e(n)}))},props:["cysmed"],async created(){this.userType=this.$route.path.match(/\/auth\//)?"NORMAL":this.$route.path.match(/\/([^\/]+)/)?"ADMIN":"NORMAL";let e=this.$route.path.match(/\/([^\/]+)\/(.+)/);if(e||(e=this.$route.path.match(/\/([^\/]+)/)),"ADMIN"===this.userType){let[t,a]=await o(this.cysmed.hasAdmin());t?this.hasAdmin=!1:(this.hasAdmin=a,this.hasAdmin&&e&&(!e[2]||e[2]&&"register"===e[2])&&(this.$router.push({path:`/${e[1]}/login`}),this.tab="login"))}if(this.extendedProjectName=r["PROJECTEXTENDED"],e){let t=e[2];["register","login"].includes(t)&&(this.tab=t)}if("DESKTOP"===this.cysmed.platform){let[e,t]=await o(this.cysmed.isLoggedIn())}},data(){return{hasAdmin:!1,userType:null,recoveringPassword:!1,translate:l.translate,extendedProjectName:"",tab:"",loggedin:!1,working:!1}},methods:{removeRecoveringPassword(){this.recoveringPassword=!1},setRecoveringPassword(){this.recoveringPassword=!0}},watch:{async tab(e,t){let a=this.$route.path.match(/\/([^\/]+)\/(.+)/);if(a){let t=a[2];t!==e&&this.$router.push({path:`/${a[1]}/${e}`})}else a=this.$route.path.match(/\/([^\/]+)/),a||(a=[,"auth"]),this.$router.push({path:`/${a[1]}/${e}`});this.recoveringPassword=!1}}},u=m,h=(a("5396"),a("2877")),g=a("f09f"),p=a("a370"),y=a("429bb"),f=a("7460"),b=a("adad"),w=a("823b"),S=a("eebe"),v=a.n(S),E=Object(h["a"])(u,i,s,!1,null,"5b49b507",null);t["default"]=E.exports;v()(E,"components",{QCard:g["a"],QCardSection:p["a"],QTabs:y["a"],QTab:f["a"],QTabPanels:b["a"],QTabPanel:w["a"]})},5396:function(e,t,a){"use strict";a("ef06")},"6daa":function(e,t,a){"use strict";a.r(t);var i=a("cf57");const s=a("e350").default,n=a("4556");class r extends s{constructor(){super()}async confirm(e,t,a="Confirm"){return new Promise(((i,s)=>{e.$q.dialog({title:a,message:t,cancel:!0,persistent:!0}).onOk((()=>i(!0))).onOk((()=>i(!0))).onCancel((()=>s(!0))).onDismiss((()=>s(!0)))}))}showDialog(e,t="",a="",s=0){let r=n({length:10});const l=e.$q.dialog({title:t,message:a,progress:{spinner:i["a"],color:"primary"},persistent:!0,ok:!1});let o,c,d=s;l.update({message:`${d} secs`});const m=()=>{clearInterval(o),clearInterval(c),l.hide()};return c=setInterval((()=>{s>0?(d--,0===d&&m()):d++,l.update({message:`${d} secs`})}),1e3),this.once(r,m),r}}t["default"]=new r},"6ded":function(e,t,a){"use strict";a("47cd")},"6e23":function(e,t,a){var i={"./cysmed/csysteminfo.png":"7ec1"};function s(e){var t=n(e);return a(t)}function n(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=n,e.exports=s,s.id="6e23"},"7c83":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{attrs:{"full-width":""},model:{value:e.innerAlert,callback:function(t){e.innerAlert=t},expression:"innerAlert"}},[a("q-card",[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",[a("span",{staticClass:"text-weight-bold"},[e._v("User activation link")])]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),a("q-card-section",[e._v("\n      In order to activate user use the following\n      "),a("a",{attrs:{href:e.activationPage}},[e._v("activation link")]),e._v(" :\n    ")]),a("q-card-section",{staticClass:"text-center row flex flex-center"},[a("div",{staticClass:"col text-no-wrap flex flex-center"},[a("code",{staticClass:"bg-grey-4 text-h6 text-bold q-pa-md row text-no-wrap",staticStyle:{"overflow-x":"scroll","overflow-y":"none"}},[e._v(e._s(e.activationPage))]),a("q-btn",{staticClass:"text-primary",attrs:{icon:"content_copy",flat:""},on:{click:e.copyActivationLinkToClipBoard}},[a("q-tooltip",[e._v(" Copy activation link ")])],1)],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK",color:"primary"}})],1)],1)],1)},s=[];a("ddb0"),a("cf57");const n=a("1712").to,r=a("20e6"),l=a("c2a1").default;var o={name:"activationLink",components:{},props:["inside","alert","alertUserId","main"],async created(){l.setSettings({TBURL:r["TB_URL"]}),l.setSettings(r),this.showAccept=!1,this.accept=!0},data(){return{activationPage:"",accept:!1,showAccept:!0,innerAlert:!1}},watch:{async alert(e,t){console.log("alert changed...."),this.main.loadingSomethingBigger=!0;let[a,i]=await n(l.getActivationCode(this.alertUserId));if(this.main.loadingSomethingBigger=!1,a)return void this.$q.notify({type:"negative",message:a||a.response||"Couldn't fetch activation link"});this.innerAlert=!0;let{activationCode:s}=i,r=window.location.protocol+"//"+window.location.host+`/#/activate?activateToken=${s}`;this.activationPage=r}},methods:{copyActivationLinkToClipBoard(){navigator.clipboard.writeText(this.activationPage).then((()=>{this.$q.notify({type:"positive",message:"Activation link copied!"})}),(()=>{}))}}},c=o,d=a("2877"),m=a("24e8"),u=a("f09f"),h=a("a370"),g=a("65c6"),p=a("6ac5"),y=a("9c40"),f=a("05c0"),b=a("4b7e"),w=a("7f67"),S=a("eebe"),v=a.n(S),E=Object(d["a"])(c,i,s,!1,null,null,null);t["a"]=E.exports;v()(E,"components",{QDialog:m["a"],QCard:u["a"],QCardSection:h["a"],QToolbar:g["a"],QToolbarTitle:p["a"],QBtn:y["a"],QTooltip:f["a"],QCardActions:b["a"]}),v()(E,"directives",{ClosePopup:w["a"]})},"7ec1":function(e,t,a){e.exports=a.p+"img/csysteminfo.d33fe8a7.png"},"82ef":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("q-tabs",{staticClass:"text-black bg-secondary",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"logins",label:"Logins"}}),a("q-tab",{attrs:{name:"activeDevices",label:"Active Devices"}}),a("q-tab",{attrs:{name:"create",label:"Create"}}),a("q-tab",{attrs:{name:"update",label:"Update"}}),a("q-tab",{attrs:{name:"delete",label:"Delete"}})],1),a("q-tab-panels",{staticClass:"q-ma-none full-width q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{staticClass:"q-pa-none q-ma-none",attrs:{name:"logins"}},[a("logins",{attrs:{main:e.main,immediateMain:e.immediateMain}})],1),a("q-tab-panel",{staticClass:"q-pa-none q-ma-none",attrs:{name:"activeDevices"}},[a("logins",{attrs:{main:e.main,immediateMain:e.immediateMain}})],1)],1)],1)},s=[],n=(a("5319"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("q-table",{staticClass:"col",attrs:{title:"Logins",dense:"",data:e.allLogins,columns:e.columns,filter:e.filter,"row-key":"loginId",selection:"multiple",selected:e.selected},on:{"row-click":e.selectLogin,"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"top-left",fn:function(){return[a("dateTimeRange",{attrs:{immediateMain:e.myImmediateMain,id:e.id}})]},proxy:!0},{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",outlined:"",dense:"",debounce:"300",placeholder:"Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),a("q-btn",{attrs:{flat:"",disable:!e.selectedRows}},[a("q-icon",{attrs:{color:"primary",name:"logout",side:""},on:{click:function(t){return e.logoutSelected()}}})],1),a("q-btn",{attrs:{flat:""}},[a("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(t){return e.fetchLogins()}}})],1)]},proxy:!0},{key:"body-cell-ip",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[t.row.isMe?a("q-icon",{staticClass:"text-white",attrs:{name:"person"}}):e._e(),a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-browser",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-os",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-platform",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-createdAt",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-email",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[a("q-chip",{class:t.row.isMe?"bg-transparent":"bg-transparent text-white",attrs:{dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))])],1)]}},{key:"body-cell-active",fn:function(t){return[a("q-td",{class:t.row.isMe?"bg-primary":t.row.active?"bg-secondary":"bg-black text-white",attrs:{props:t}},[t.row[t.col.name]?e._e():a("q-chip",{staticClass:"text-weight-bolder",attrs:{color:!0===t.row.active?"green":"red","text-color":"white",dense:"",square:""}},[e._v(e._s(t.row[t.col.name]))]),t.row[t.col.name]?a("q-btn",{staticClass:"bg-white",attrs:{flat:"",icon:"logout"},on:{click:function(a){return e.logoutFromBtn(t.row)}}}):e._e()],1)]}}])})],1)}),r=[],l=(a("ddb0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-btn",{staticClass:"bg-primary text-white",attrs:{"no-caps":"",icon:"schedule",label:e.dateRangeSelectLabel}},[a("q-menu",{ref:"menu0",staticClass:"q-ma-md q-pa-md"},[a("q-card",{staticClass:"q-pa-none q-ma-none",staticStyle:{width:"300px"}},[a("q-card-section",{staticClass:"q-pa-none q-ma-none"},[a("div",[a("q-radio",{attrs:{val:"last",label:"Last"},on:{input:e.dateRangeSelectTypeChanged},model:{value:e.dateRangeSelectType,callback:function(t){e.dateRangeSelectType=t},expression:"dateRangeSelectType"}}),"last"===e.dateRangeSelectType?a("div",{staticClass:"row q-pa-md"},[e.advancedForLastFilter?e._e():a("q-select",{staticClass:"col-8",attrs:{options:e.dateRangeSelectTypeLasts,label:"Last","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please provide an input"}]},model:{value:e.dateRangeSelectTypeLast,callback:function(t){e.dateRangeSelectTypeLast=t},expression:"dateRangeSelectTypeLast"}}),e.advancedForLastFilter?a("div",{staticClass:"col-8"},[a("q-input",{attrs:{label:"Days",type:"number"},model:{value:e.days,callback:function(t){e.days=t},expression:"days"}}),a("q-input",{attrs:{label:"hours",type:"number"},model:{value:e.hours,callback:function(t){e.hours=t},expression:"hours"}}),a("q-input",{attrs:{label:"Minutes",type:"number"},model:{value:e.minutes,callback:function(t){e.minutes=t},expression:"minutes"}}),a("q-input",{attrs:{label:"Seconds",type:"number"},model:{value:e.seconds,callback:function(t){e.seconds=t},expression:"seconds"}})],1):e._e(),a("span",{staticClass:"float-right"},[a("q-list",[a("q-item-section",[a("q-item-label",{attrs:{caption:""}},[e._v("Advanced")]),a("q-item-label",[a("q-toggle",{staticClass:"float-right",attrs:{color:"secondary"},model:{value:e.advancedForLastFilter,callback:function(t){e.advancedForLastFilter=t},expression:"advancedForLastFilter"}})],1)],1)],1)],1)],1):e._e()],1),a("div",{staticClass:"q-ma-none q-pa-none"},[a("q-radio",{attrs:{val:"timePeriod",label:"Time Period"},on:{input:e.dateRangeSelectTypeChanged},model:{value:e.dateRangeSelectType,callback:function(t){e.dateRangeSelectType=t},expression:"dateRangeSelectType"}}),"timePeriod"===e.dateRangeSelectType?a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-6",attrs:{mask:"date",label:"Date to",rules:["date",function(e){return e&&e.length>0||"Please enter a date"}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.dateTo,callback:function(t){e.dateTo=t},expression:"dateTo"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}],null,!1,2882366464),model:{value:e.dateTo,callback:function(t){e.dateTo=t},expression:"dateTo"}}),a("q-input",{staticClass:"col-6",attrs:{mask:"time",label:"Time to",rules:["time",function(e){return e&&e.length>0||"Please enter a time"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"schedule"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-time",{attrs:{"now-btn":""},model:{value:e.timeTo,callback:function(t){e.timeTo=t},expression:"timeTo"}})],1)],1)]},proxy:!0}],null,!1,789531335),model:{value:e.timeTo,callback:function(t){e.timeTo=t},expression:"timeTo"}})],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-6",attrs:{mask:"date",label:"Date from",rules:["date",function(e){return e&&e.length>0||"Please enter a date"}]},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.dateFrom,callback:function(t){e.dateFrom=t},expression:"dateFrom"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}],null,!1,1103465677),model:{value:e.dateFrom,callback:function(t){e.dateFrom=t},expression:"dateFrom"}}),a("q-input",{staticClass:"col-6",attrs:{mask:"time",label:"Time from",rules:["time",function(e){return e&&e.length>0||"Please enter a time"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"schedule"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-time",{attrs:{"now-btn":""},model:{value:e.timeFrom,callback:function(t){e.timeFrom=t},expression:"timeFrom"}})],1)],1)]},proxy:!0}],null,!1,94629418),model:{value:e.timeFrom,callback:function(t){e.timeFrom=t},expression:"timeFrom"}})],1)]):e._e()],1),a("div",[a("q-radio",{attrs:{val:"interval",label:"Interval"},on:{input:e.dateRangeSelectTypeChanged},model:{value:e.dateRangeSelectType,callback:function(t){e.dateRangeSelectType=t},expression:"dateRangeSelectType"}}),"interval"===e.dateRangeSelectType?a("div",{staticClass:"row q-pa-md"},[a("q-select",{staticClass:"col-12",attrs:{options:e.intervalTypes,label:"Last","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please provide an input"}]},model:{value:e.intervalType,callback:function(t){e.intervalType=t},expression:"intervalType"}})],1):e._e()],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:""},on:{click:e.cancel}},[e._v("Cancel")]),a("q-btn",{attrs:{color:"primary"},on:{click:e.update}},[e._v("Update")])],1)],1)],1)],1)}),o=[],c=(a("26e9"),{name:"dateTimeRange",props:["main","immediateMain","id"],components:{},async created(){this.immediateMain.dateTimeRanges||(this.immediateMain.dateTimeRanges={});let e=this.immediateMain.dateTimeRanges[this.id];e||(this.dateRangeSelectType="last",this.dateRangeSelectTypeLast="1 day"),this.oldDateRangeSelectType=this.dateRangeSelectType,this.convertToOtherTypes()},data(){return{dateFrom:"2021/01/04",timeFrom:"",dateTo:"",timeTo:"",days:1,hours:0,minutes:0,seconds:0,advancedForLastFilter:!1,dateRangeSelectType:"last",dateRangeSelectLabel:"...",intervalType:"Yesterday",intervalTypes:["Yesterday","Day before yesterday","This day last week","Previous week (Sun - Sat)","Previous week (Mon - Sun)","Previous month","Previous year","Current hour","Current day","Current day so far","Current week (Sun - Sat)","Current week (Mon - Sun)","Current week so far (Sun - Sat)","Current week so far (Mon - Sun)","Current month","Current month so far","Current year","Current year so far"],dateRangeSelectTypeLast:"1 day",dateRangeSelectTypeLasts:["1 second","5 seconds","10 seconds","15 seconds","30 seconds","1 minute","2 minutes","5 minutes","10 minutes","15 minutes","30 minutes","1 hour","2 hours","5 hours","10 hours","12 hours","1 day"]}},methods:{convertToOtherTypes(e){let t,a,i=e||this.dateRangeSelectType;switch(e||"last"===i&&this.advancedForLastFilter&&(i="lastAdvanced"),i){case"last":let e=parseInt(this.dateRangeSelectTypeLast),i=this.dateRangeSelectTypeLast.split(" ").slice(-1)[0].replace(/s$/,"");switch(a=e,i){case"second":break;case"minute":a*=60;break;case"hour":a*=3600;break;case"day":a*=86400;break}this.dateRangeSelectLabel=`Last ${this.dateRangeSelectTypeLast}`,this.interval={to:"now",from:-a};let s=0,n=parseInt(a/86400);s=n>0?a%(86400*n):a;let r=parseInt(s/3600);s=r>0?s%(3600*r):s;let l=parseInt(s/60);s=l>0?s%(60*l):s;let o=s;this.dateRangeSelectTypeLastAdvanced={day:n,hour:r,min:l,sec:o},console.log(n,r,l,o),this.days=n,this.hours=r,this.minutes=l,this.seconds=o,t=new Date,this.dateTo=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeTo=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`,t=new Date(t.getTime()-1e3*a),this.dateFrom=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeFrom=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`;break;case"lastAdvanced":a=24*parseInt(this.days)*60*60+60*parseInt(this.hours)*60+60*parseInt(this.minutes)+parseInt(this.seconds),t=new Date,this.dateTo=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeTo=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`,t=new Date(t.getTime()-1e3*a),this.dateFrom=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeFrom=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`;let c=[1,5,10,15,30,1,2,5,10,15,30,1,2,5,10,12,1],d=[1,60,3600,86400],m=-1;c=c.map((e=>(1===e&&m++,e*d[m])));let u=c[0],h=c[c.length-1];c.map((e=>{e<=a&&(u=e)})),c=c.reverse(),c.map((e=>{e>=a&&(h=e)})),c=c.reverse(),this.interval={to:"now",from:-a},a=a-u<h-a?u:h;let g=c.indexOf(a);this.dateRangeSelectTypeLast=this.dateRangeSelectTypeLasts[g];let p="";this.days>0&&(""===p&&(p="Last "),p+=`${this.days} day${this.days>1?"s":""} `),this.hours>0&&(""===p&&(p="Last "),p+=`${this.hours} hour${this.hours>1?"s":""} `),this.minutes>0&&(""===p&&(p="Last "),p+=`${this.minutes} minute${this.minutes>1?"s":""} `),this.seconds>0&&(""===p&&(p="Last "),p+=`${this.seconds} second${this.seconds>1?"s":""} `),this.dateRangeSelectLabel=p;break;case"timePeriod":this.interval={to:new Date(`${this.dateTo} ${this.timeTo}`),from:new Date(`${this.dateFrom} ${this.timeFrom}`)},this.dateRangeSelectLabel=`from ${this.dateFrom} ${this.timeFrom} to ${this.dateTo} ${this.timeTo}`;break;case"interval":const y=e=>{e=e||new Date;let t=60*e.getHours()*60+60*e.getMinutes()+e.getSeconds();return t};t=new Date;let f=y(),b=new Date(t.getTime()-60*t.getMinutes()*1e3-1e3*t.getSeconds()),w=new Date(b.getTime()+36e5),S=new Date(t.getTime()-1e3*f),v=new Date(S.getTime()+864e5),E=new Date(S.getTime()-864e5),q=new Date(E.getTime()-864e5),I=(new Date).getDay(),N=new Date(S.getTime()-24*I*60*60*1e3),T=new Date(N.getTime()+6048e5),O=new Date(N.getTime()-6048e5),k=new Date(N.getTime()+864e5),R=new Date(k.getTime()+6048e5),L=new Date(O.getTime()+864e5),P=new Date(S.getTime()-24*((new Date).getDate()-1)*60*60*1e3),C=new Date(P.getTime()-1e4),D=new Date(P.getTime()-24*C.getDate()*60*60*1e3),x=(C.getDate(),new Date((new Date).getFullYear(),0,0)),F=y(x);x=new Date(x.getTime()-1e3*F+864e5);let A=new Date(t.getFullYear()-1,0,0);F=y(A),A=new Date(A.getTime()-1e3*F+864e5);let _=new Date(t.getFullYear()+1,0,0);F=y(_),_=new Date(_.getTime()-1e3*F+864e5);let z=new Date(t.getFullYear(),t.getMonth()+1,0),M=y(z);switch(z=new Date(z.getTime()-1e3*M+864e5),console.log(N),console.log(q),console.log(O),console.log(k),console.log(P),console.log(C),console.log(D),console.log(x),console.log(A),console.log({beginningOfHour:b,endofHour:w,beginningOfToday:S,endOfToday:v,beginningOfNextMonth:z,beginningOfNextYear:_}),this.intervalType){case"Yesterday":this.interval={to:S,from:E};break;case"Day before yesterday":this.interval={to:E,from:E};break;case"This day last week":let e=new Date(S.getTime()-6048e5),t=new Date(e.getTime()+864e5);this.interval={to:t,from:e};break;case"Previous week (Sun - Sat)":this.interval={to:N,from:O};break;case"Previous week (Mon - Sun)":this.interval={to:k,from:L};break;case"Previous month":this.interval={to:P,from:D};break;case"Previous year":this.interval={to:x,from:A};break;case"Current hour":this.interval={to:w,from:b};break;case"Current day":this.interval={to:v,from:S};break;case"Current day so far":this.interval={to:"now",from:S};break;case"Current week (Sun - Sat)":this.interval={to:T,from:N};break;case"Current week (Mon - Sun)":this.interval={to:R,from:k};break;case"Current week so far (Sun - Sat)":this.interval={to:"now",from:N};break;case"Current week so far (Mon - Sun)":this.interval={to:"now",from:k};break;case"Current month":this.interval={to:z,from:P};break;case"Current month so far":this.interval={to:"now",from:P};break;case"Current year":this.interval={to:_,from:P};break;case"Current year so far":this.interval={to:"now",from:x};break}this.dateRangeSelectLabel=`${this.intervalType}`;let $=this.interval.from,U=this.interval.to;"now"===U&&(U=new Date),t=U,this.dateTo=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeTo=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`,t=$,this.dateFrom=`${t.getFullYear()}/${t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1}/${t.getDate()<10?"0"+t.getDate():t.getDate()}`,this.timeFrom=`${t.getHours()<10?"0"+t.getHours():t.getHours()}:${t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()}`;break}},cancel(){this.$refs.menu0.toggle(),this.immediateMain.dateTimeRanges[this.id]=this.settingsOriginal},update(){this.convertToOtherTypes(!1),this.immediateMain.dateTimeRanges[this.id]||(this.immediateMain.dateTimeRanges[this.id]={});let e=["dateRangeSelectType","dateRangeSelectTypeLast","interval"];e.map((e=>this.immediateMain.dateTimeRanges[this.id][e]=this[e])),this.$refs.menu0.toggle(),this.immediateMain.dateTimeRanges[this.id].interval=this.interval,this.immediateMain.runSelected()},dateRangeSelectTypeChanged(e,t){this.convertToOtherTypes()}},computed:{},watch:{dateRangeSelectType(){let e=this.dateRangeSelectType;this.dateRangeSelectType=this.oldDateRangeSelectType,this.convertToOtherTypes(),this.dateRangeSelectType=e,this.oldDateRangeSelectType=e},advancedForLastFilter(){if(!1===this.advancedForLastFilter){let e=this.dateRangeSelectType;this.convertToOtherTypes("lastAdvanced"),this.dateRangeSelectType=e,this.oldDateRangeSelectType=e}else{let e=this.dateRangeSelectType;this.convertToOtherTypes("last"),this.dateRangeSelectType=e,this.oldDateRangeSelectType=e}}}}),d=c,m=a("2877"),u=a("9c40"),h=a("4e73"),g=a("f09f"),p=a("a370"),y=a("3786"),f=a("ddd8"),b=a("27f9"),w=a("1c1c"),S=a("4074"),v=a("0170"),E=a("9564"),q=a("0016"),I=a("7cbe"),N=a("52ee"),T=a("ca78"),O=a("4b7e"),k=a("7f67"),R=a("eebe"),L=a.n(R),P=Object(m["a"])(d,l,o,!1,null,null,null),C=P.exports;L()(P,"components",{QBtn:u["a"],QMenu:h["a"],QCard:g["a"],QCardSection:p["a"],QRadio:y["a"],QSelect:f["a"],QInput:b["a"],QList:w["a"],QItemSection:S["a"],QItemLabel:v["a"],QToggle:E["a"],QIcon:q["a"],QPopupProxy:I["a"],QDate:N["a"],QTime:T["a"],QCardActions:O["a"]}),L()(P,"directives",{ClosePopup:k["a"]});const D=a("1712").to,x=a("20e6"),F=a("c2a1").default;var A={name:"logins",props:["main","immediateMain"],components:{dateTimeRange:C},async created(){F.setSettings({TBURL:x["TB_URL"]}),F.setVue(this),this.fetchLogins()},data(){return{id:1,myImmediateMain:this,dateTimeRanges:{},dateRangeSelectType:"last",dateRangeSelectLabel:"",selected:[],columns:[{name:"email",label:"Email",field:"email",sortable:!0},{name:"ip",label:"IP",field:"ip",sortable:!0},{name:"browser",label:"Browser",field:"browser",sortable:!0},{name:"os",label:"OS",field:"os",sortable:!0},{name:"platform",label:"Platform",field:"platform",sortable:!0},{name:"active",label:"Active",field:"active",sortable:!0},{name:"createdAt",label:"Created",field:"createdAt",sortable:!0}],allLogins:[],selectedRow:{},filter:""}},methods:{async logoutFromBtn(e){await this.logoutSelected([e])},async logoutSelected(e){return new Promise((async(t,a)=>{let i=!1,s=(e||this.selected).map((e=>e));s.map((e=>{e.isMe&&(i=!0)})),s=s.filter((e=>!e.isMe&&""!==e.token)),s=s.map((e=>e.token)),i&&this.$q.notify({type:"negative",message:"We will not log you out from here"});let n=s.map(F.logout);this.main.loadingSomething=!0;let[r,l]=await D(Promise.all(n));if(this.main.loadingSomething=!1,r)return this.$q.notify({type:"negative",message:r.msg||r}),t(!1);await D(this.fetchLogins()),t()}))},async runSelected(){return this.fetchLogins()},async fetchLogins(){let e={};this.main.selectedRow&&(e={userId:this.main.selectedRow.userId}),this.dateTimeRanges[this.id]||(this.dateTimeRanges[this.id]={}),this.dateTimeRanges[this.id].interval&&(e.createdAt={},this.dateTimeRanges[this.id].interval.to&&("now"===this.dateTimeRanges[this.id].interval.to?e.createdAt["lte"]=new Date:e.createdAt["lte"]=this.dateTimeRanges[this.id].interval.to),this.dateTimeRanges[this.id].interval.from&&(this.dateTimeRanges[this.id].interval.from<0?e.createdAt["gte"]=new Date((new Date).getTime()+1e3*this.dateTimeRanges[this.id].interval.from):e.createdAt["gte"]=this.dateTimeRanges[this.id].interval.from)),"activeDevices"===this.immediateMain.tab&&(e["tokenExpiry"]={gte:parseInt((new Date).getTime()/1e3)},e["token"]={ne:""}),this.main.loadingSomething=!0;let[t,a]=await D(F.getLogins(e));this.main.loadingSomething=!1;let i=F.currentToken();t||(a=a.map((e=>(e.active=""!==e.token,e.token===i?e.isMe=!0:e.isMe=!1,e))),this.allLogins=a)},selectLogin(e,t){t.active&&(this.selectedRow=t)}},computed:{selectedRows(){let e=this.selected.filter((e=>e.active));return e.length>0}},watch:{selectedRow:{handler(e){JSON.stringify(this.selectedRow)!==JSON.stringify(this.main.selectedRow)?this.main.editted=!0:this.main.editted=!1},deep:!0}}},_=A,z=a("9989"),M=a("eaac"),$=a("db86"),U=a("b047"),Q=Object(m["a"])(_,n,r,!1,null,null,null),B=Q.exports;L()(Q,"components",{QPage:z["a"],QTable:M["a"],QBtn:u["a"],QMenu:h["a"],QCard:g["a"],QCardSection:p["a"],QRadio:y["a"],QCardActions:O["a"],QInput:b["a"],QIcon:q["a"],QTd:$["a"],QChip:U["a"]});a("20e6"),a("c2a1").default;var j={name:"userDetails",props:["main"],components:{logins:B},async created(){let e,t,a=window.location.hash.replace(/^[#]*[\/]*/,""),i=a.match(/(audit_logs)\/([0-9a-z-]+)[\/]*([a-zA-Z]+)/);i&&"audit_logs"===i[1]&&(e=i[2],t=i[3]),e&&(this.selectedRow={userId:e}),t&&(this.tab=t)},data(){return{tab:"logins",immediateMain:this}},methods:{},computed:{},watch:{}},G=j,H=a("429bb"),Y=a("7460"),V=a("adad"),J=a("823b"),W=Object(m["a"])(G,i,s,!1,null,null,null);t["a"]=W.exports;L()(W,"components",{QPage:z["a"],QTabs:H["a"],QTab:Y["a"],QTabPanels:V["a"],QTabPanel:J["a"]})},"862c":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"basic",label:"Basic Info"}}),a("q-tab",{attrs:{name:"details",label:"Details"}})],1),a("q-tab-panels",{staticClass:"q-ma-none q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"basic"}},[a("basicProfile",{attrs:{cysmed:e.cysmed,selectedUser:e.selectedUser}})],1),a("q-tab-panel",{attrs:{name:"details"}},[a("medicDetailsProfile",{attrs:{cysmed:e.cysmed,selectedUser:e.selectedUser}})],1)],1)],1)},s=[],n=a("0e1b"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-card",{staticClass:"items-center text-center bg-white",attrs:{flat:""}},[a("q-card-section",[a("q-form",{ref:"changeUserNameForm",staticClass:"q-gutter-md text-white",on:{submit:e.changeuserNames,reset:e.onReset}},[a("q-select",{attrs:{filled:"",options:e.registeringBodies,label:e.cysmed.translate("PASSAGE.REGISTERINGBODY"),rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.REGISTERINGBODY.MISSING")}]},model:{value:e.registeringBody,callback:function(t){e.registeringBody=t},expression:"registeringBody"}}),a("q-select",{attrs:{filled:"",options:e.qualifications[e.registeringBody],label:e.cysmed.translate("FIELDS.PROFESSIONAL.SUPERINTENDENT.QUALIFICATION"),rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.QUALIFICATION.SUPERINTENDENT.MISSING")}]},model:{value:e.qualification,callback:function(t){e.qualification=t},expression:"qualification"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.SUPERINTENDENT.REGISTRATIONNUMBER"),rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.REGISTRATIONNUMBER.SUPERINTENDENT.MISSINGOWN")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.registrationNumber,callback:function(t){e.registrationNumber=t},expression:"registrationNumber"}}),a("q-separator",{attrs:{color:"white",size:"2px"}}),a("div",{staticClass:"row"},[a("q-space"),a("div",{staticClass:"items-left text-left"},[a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),a("q-btn",{attrs:{label:"Save",type:"submit",color:"green",disable:e.userEditted}})],1)],1)],1)],1)],1),a("q-dialog",{attrs:{maximized:!1,"transition-show":"scale","transition-hide":"scale"},model:{value:e.mapDialog,callback:function(t){e.mapDialog=t},expression:"mapDialog"}},[a("div",{staticStyle:{width:"100%",height:"100%"}},[a("l-map",{ref:"lmap",staticClass:"full-width",staticStyle:{width:"100%",height:"100%"},attrs:{zoom:e.zoom,center:e.center},on:{ready:e.lmapReady}},[a("l-tile-layer",{attrs:{url:e.url}}),a("l-marker",{ref:"marker",attrs:{"lat-lng":e.center,draggable:!0}},[a("l-popup",{staticClass:"q-pa-none q-ma-none"},[a("q-card",{staticClass:"q-pa-none q-ma-none",attrs:{flat:""}},[a("q-card-section",[e._v("\n                "+e._s(e.firstName||"Facility")+" Location\n              ")]),a("q-card-section",[e._v("\n                "+e._s(e.centerString)+"\n              ")])],1)],1)],1)],1)],1)])],1)},l=[],o=(a("ddb0"),a("cf57"),a("51e2"),a("e11e")),c=a.n(o),d=a("2699"),m=a("a40a"),u=a("4e2b6"),h=a("fbba"),g=a("f60f");a("6cc5");const p=a("c2a1").default,y=a("1712").to,f=a("20e6"),b=a("6daa").default;delete c.a.Icon.Default.prototype._getIconUrl,c.a.Icon.Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")});var w={name:"medicDetailsProfile",components:{LMap:d["a"],LTileLayer:m["a"],LMarker:u["a"],LIcon:h["a"],LPopup:g["a"]},props:["cysmed","selectedUser"],data(){return{authority:"",superintendentFullName:"",superintendentIdentityNumber:"",superintendentTelephone1:"",superintendentTelephone2:"",facilityRegistrationNumber:"",superintendentTelephone1:"",superintendentTelephone1Original:"",superintendentTelephone2:"",superintendentTelephone2Original:"",qualification:"",qualifications:{"Pharmacy and Poisons Board":["Pharmacist","Pharmtech"]},registeringBody:"",registeringBodyOriginal:"",registeringBodies:["Pharmacy and Poisons Board"],registrationNumber:"",registrationNumberOriginal:"",profilePath:"",userData:{},email:"",firstName:"",lastName:"",centerOriginal:[-1.286389,36.817223],loaded:!1,changePasswordDialog:!1,lastLogin:"",allowlastName:!0,mapDialog:!1,location:"0,0",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:15,center:[-1.286389,36.817223],centerString:"",icon:c.a.icon({iconUrl:"/images/marker-icon.png",iconSize:[32,37],iconAnchor:[16,37]}),staticAnchor:[16,37]}},async created(){if(this.centerString=this.center.join(","),p.setSettings({TBURL:f["TB_URL"]}),p.setVue(this),await p.authGuard(),this.allowlastName=!this.cysmed.currentUserAuthority.match(/FACILITY/),this.selectedUser)this.setUserData(this.selectedUser);else{p.showLoading();let[e,t]=await y(p.readUserData());if(e)return;p.hideLoading(),this.setUserData(t)}},methods:{lmapReady(e){this.map=e,this.$refs.marker.mapObject.on("dragend",(e=>{let t=e.target._latlng;t=[t.lat,t.lng],this.center=t}))},onReset(){this.superintendentFullName=this.superintendentFullNameOriginal,this.superintendentIdentityNumber=this.superintendentIdentityNumberOriginal,this.registeringBody=this.registeringBodyOriginal,this.registrationNumber=this.registrationNumberOriginal,this.qualification=this.qualificationOriginal,this.superintendentTelephone1=this.superintendentTelephone1Original,this.superintendentTelephone2=this.superintendentTelephone2Original},onResetChangePassword(){this.currentPassword="",this.newPassword="",this.newPasswordAgain=""},setUserData(e){this.userData=e,this.registeringBody=e.registeringBody,this.registeringBodyOriginal=e.registeringBody,this.registrationNumber=e.registrationNumber,this.registrationNumberOriginal=e.registrationNumber,this.qualification=e.qualification,this.qualificationOriginal=e.qualification},async changeuserNames(){return new Promise((async(e,t)=>{if(this.notUserEditted())return e(!1);let a={userId:this.userData.userId};a.registeringBody=this.registeringBody,a.registrationNumber=this.registrationNumber,a.qualification=this.qualification,p.showLoading();let[i,s]=await y(p.patchEntry(a,"user/medic"));if(p.hideLoading(),i)return this.$q.notify({type:"negative",message:i.msg||i}),e(!1);this.setUserData(s),e(s)}))},async changePassword(){return new Promise((async(e,t)=>{if(this.newPassword!==this.newPasswordAgain)return this.newPasswordAgain="",this.confirmPasswordError="Passwords don't match",e(!1);let a={oldpassword:this.currentPassword,password:this.newPassword};p.showLoading({message:"Changing Password"});let[i,s]=await y(p.changePassword(a));if(p.hideLoading(),i)return this.$q.notify({type:"negative",message:i.response.data.error||i.msg||i.response.data.message||i.message||i}),e(!1);this.$q.notify({type:"positive",message:"Password changed."}),this.changePasswordDialog=!1,e(s)}))},async deleteAccount(){return new Promise((async(e,t)=>{let[a,i]=await y(b.confirm(this,"Are you sure you want to delete your account?","Delete Account"));return a?e(!1):(p.showLoading({message:"Deleting Account"}),[a,i]=await y(p.deleteUser(this.userData.userId,!0)),p.hideLoading(),a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:"Your account has been deleted"}),void window.location.assign("/")))}))},submitChangeUserName(){this.$refs.changeUserNameForm.submit()},submitChangePassword(){this.$refs.changePasswordForm.submit()},notUserEditted(){return this.registeringBody===this.registeringBodyOriginal&&this.registrationNumber===this.registrationNumberOriginal&&this.qualification===this.qualificationOriginal}},computed:{userEditted(){return this.registeringBody===this.registeringBodyOriginal&&this.registrationNumber===this.registrationNumberOriginal&&this.qualification===this.qualificationOriginal}}},S=w,v=(a("6ded"),a("2877")),E=a("f09f"),q=a("a370"),I=a("0378"),N=a("ddd8"),T=a("27f9"),O=a("eb85"),k=a("2c91"),R=a("9c40"),L=a("24e8"),P=a("eebe"),C=a.n(P),D=Object(v["a"])(S,r,l,!1,null,"7015f732",null),x=D.exports;C()(D,"components",{QCard:E["a"],QCardSection:q["a"],QForm:I["a"],QSelect:N["a"],QInput:T["a"],QSeparator:O["a"],QSpace:k["a"],QBtn:R["a"],QDialog:L["a"]});var F={name:"medicProfile",components:{basicProfile:n["a"],medicDetailsProfile:x},props:["cysmed","selectedUser"],data(){return{tab:"basic"}}},A=F,_=a("429bb"),z=a("7460"),M=a("adad"),$=a("823b"),U=Object(v["a"])(A,i,s,!1,null,null,null);t["a"]=U.exports;C()(U,"components",{QTabs:_["a"],QTab:z["a"],QTabPanels:M["a"],QTabPanel:$["a"]})},"87a4":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{staticClass:"full-width",attrs:{seamless:"",position:"bottom",square:"",maximized:""},model:{value:e.cysmed.seamlessDialog,callback:function(t){e.$set(e.cysmed,"seamlessDialog",t)},expression:"cysmed.seamlessDialog"}},[a("q-card",{staticClass:"full-width q-pa-none q-ma-none",staticStyle:{"max-width":"100% !important"}},[a("q-card-section",{staticClass:"items-center no-wrap"},[a("p",{staticClass:"text-center q-ma-none q-pa-sm"},[e._v("\n        "+e._s(e.cysmed.formatTime(e.time))+"\n        "+e._s(e.translate("PASSAGE.WAITING_FOR_SERVER."+e.cysmed.platform))+"\n        "+e._s(e.cysmed.reloadPageIfServerNotFound?e.translate("PASSAGE.WILL_RELOAD."+e.cysmed.platform):"")+"\n      ")])]),a("q-linear-progress",{staticClass:"q-ma-none",attrs:{indeterminate:"",rounded:"",color:"negative",size:"lg"}})],1)],1)},s=[];const n=a("ea76").default;var r={name:"seamlessDialog",components:{},props:["cysmed"],created(){this.timer=setInterval((()=>{this.time+=1,this.cysmed.reloadPageIfServerNotFound&&this.time>this.cysmed.reloadPageIfServerNotFound&&this.cysmed.reloadCurrentPage()}),1e3)},data(){return{time:0,timer:null,translate:n.translate}},beforeDestroy(){clearInterval(this.timer)}},l=r,o=a("2877"),c=a("24e8"),d=a("f09f"),m=a("a370"),u=a("6b1d"),h=a("eebe"),g=a.n(h),p=Object(o["a"])(l,i,s,!1,null,null,null);t["a"]=p.exports;g()(p,"components",{QDialog:c["a"],QCard:d["a"],QCardSection:m["a"],QLinearProgress:u["a"]})},"8a74":function(e){e.exports=JSON.parse('{"ORG":["ORG_USER"],"FACILITY":["FACILITY_ADMIN","FACILITY_USER"]}')},"8be4":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=this,a=t.$createElement,i=t._self._c||a;return t.recoveringPassword?"DESKTOP"===t.cysmed.platform?i("div",[t._v("\n  Contact your system administrator to recorver your password. Or use the web\n  portal and reregister this software to recover the admin account.\n")]):i("q-form",{staticClass:"text-white bg-secondary",on:{submit:t.onSubmitRecover,reset:t.onReset}},[i("q-input",{attrs:{filled:"",type:"email",label:t.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(e){return e&&e.length>0||t.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(a){return e.isValidEmail()||t.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),i("div",{staticClass:"q-pt-md"},[i("q-btn",{attrs:{label:t.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),i("q-btn",{staticClass:"q-ml-sm",attrs:{label:t.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1),i("div",{staticClass:"flex flex-center"},[i("p",{staticClass:"text-center items-center q-pa-md"},[i("a",{attrs:{href:"#"},on:{click:t.unrecoverPassword}},[t._v("Log in?")])])])],1):i("q-form",{staticClass:"text-white bg-secondary",on:{submit:t.onSubmit,reset:t.onReset}},[i("q-input",{attrs:{filled:"",type:"email",label:t.translate("FIELDS.EMAIL"),hint:t.translate("FIELDS.EMAIL"),"lazy-rules":"",rules:[function(e){return e&&e.length>0||t.translate("FIELDS.ERRORS.EMAIL.MISSINGOWN")},function(a){return e.isValidEmail()||t.translate("FIELDS.ERRORS.EMAIL.INVALID")}]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),i("q-input",{attrs:{filled:"",type:"password",label:t.translate("FIELDS.PASSWORD"),"lazy-rules":"",rules:[function(e){return null!==e&&""!==e||t.translate("FIELDS.ERRORS.PASSWORD.MISSINGOWN")}],"error-message":t.passwordErrorMessage},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),i("div",{staticClass:"q-pa-none"},[i("q-btn",{attrs:{label:t.translate("ACTIONS.SUBMIT"),type:"submit",color:"primary"}}),i("q-btn",{staticClass:"q-ml-sm",attrs:{label:t.translate("ACTIONS.RESET"),type:"reset",color:"white",flat:""}})],1),i("p",{staticClass:"text-center items-center q-pa-md"},[i("a",{attrs:{href:"#"},on:{click:t.recoverPassword}},[t._v("Forgot password?")])])],1)},s=[],n=(a("ddb0"),a("cf57"));const r=a("1712").to,l=a("20e6"),o=a("c2a1").default,c=a("ea76").default;var d={name:"loginForm",props:["cysmed","setRecoveringPassword"],data(){return{translate:c.translate,email:"",password:"",passwordErrorMessage:"",recoveringPassword:!1}},methods:{recoverPassword(e){e.preventDefault(),this.recoveringPassword=!0},unrecoverPassword(e){e.preventDefault(),this.recoveringPassword=!1},isValidEmail(){const e=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return e.test(this.email)||this.translate("FIELDS.ERRORS.EMAIL.INVALID")},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:n["a"],color:"primary"},persistent:!0,ok:!1}),a=setInterval((()=>{!1===this.working&&(clearInterval(a),t.hide())}),500)},async onSubmitRecover(){o.setSettings({TBURL:l["TB_URL"]});l["TB_URL"];let e={email:this.email,password:this.password};this.working=!0,this.showCustom();let[t,a]=await r(o.initializeResetPassword(e));if(this.working=!1,t)return this.loggedin=!1,this.$q.notify({type:"negative",message:this.translate(t.error||t.message)}),this.password="",void(this.passwordErrorMessage=this.translate(t.error||t.message));this.$q.notify({type:"positive",message:"log in successful"});let i=o.getDefaultPageAfterLogin();i.match(/^http/)&&(i=i.split(/^http[s]*:\/\/[^\/]*/)[1]),void 0===i&&(i=""),i.match(/#/)&&(i=i.split(/#/)[1]),alert(i),this.$router.push({path:i})},async onSubmit(){o.setSettings({TBURL:l["TB_URL"]});l["TB_URL"];let e={email:this.email,password:this.password};this.working=!0,this.showCustom();let[t,a]=await r(o.login(e));if(this.working=!1,t)return this.loggedin=!1,this.$q.notify({type:"negative",message:this.translate(t.error||t.message||t||"ACTIONS.ERRORS.LOGINFAILED")}),this.password="",void(this.passwordErrorMessage=this.translate(t.error||t.message||t||"FIELDS.ERRORS.EMAILORPASSWORD"));this.$q.notify({type:"positive",message:"log in successful"});let i=o.getDefaultPageAfterLogin();console.log(i),console.log(i),console.log(i),console.log(i),console.log(i),console.log(i),console.log(i),window.location.assign(o.getDefaultPageAfterLogin())},onReset(){this.email=null,this.password=null}}},m=d,u=a("2877"),h=a("0378"),g=a("27f9"),p=a("9c40"),y=a("eebe"),f=a.n(y),b=Object(u["a"])(m,i,s,!1,null,null,null);t["default"]=b.exports;f()(b,"components",{QForm:h["a"],QInput:g["a"],QBtn:p["a"]})},"948c":function(e,t,a){var i={"./cysmed/authorities.json":"8a74"};function s(e){var t=n(e);return a(t)}function n(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=n,e.exports=s,s.id="948c"},"95a5":function(e,t,a){var i={"./authForms":["51e2"],"./authForms.vue":["51e2"],"./loginFormSelect":["b758"],"./loginFormSelect.vue":["b758"],"./loginParts/adminLogin":["4253",0,7],"./loginParts/adminLogin.vue":["4253",0,7],"./loginParts/loginForm":["8be4",0,1],"./loginParts/loginForm.vue":["8be4",0,1],"./registrationForm":["b0e2",0,1],"./registrationForm.1":["ecc7",0,1,8],"./registrationForm.1.vue":["ecc7",0,1,8],"./registrationForm.vue":["b0e2",0,1],"./registrationParts/adminRegistration":["39f7",0,1],"./registrationParts/adminRegistration.vue":["39f7",0,1],"./registrationParts/facilityRegistration":["2f8f",0,1],"./registrationParts/facilityRegistration.vue":["2f8f",0,1],"./registrationParts/medicRegistration":["50e3",0,1],"./registrationParts/medicRegistration.vue":["50e3",0,1],"./registrationParts/patientRegistration":["3151",0,1],"./registrationParts/patientRegistration.vue":["3151",0,1]};function s(e){if(!a.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],s=t[0];return Promise.all(t.slice(1).map(a.e)).then((function(){return a(s)}))}s.keys=function(){return Object.keys(i)},s.id="95a5",e.exports=s},"9fea":function(e,t){let a={EN:"\n## Terms and Conditions\n\n...\n    ",SWA:"\n## Sheria na Masharti\n\n...\n    "};function i(e){return a[e.toUpperCase()]}e.exports=i},a46f:function(e,t,a){},b0e2:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-form",{ref:"userRegistrationForm",staticClass:"q-gutter-md text-white",on:{submit:e.createUser,reset:e.onReset}},[e.entityTypes.length>1?a("q-select",{attrs:{disable:e.inside,filled:"",options:e.entityTypes,label:e.translate("PASSAGE.REGISTERAS"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.translate("FIELDS.ERRORS.ENTITYTYPE.MISSING")}]},model:{value:e.entityType,callback:function(t){e.entityType=t},expression:"entityType"}}):e._e(),"PATIENT"===e.selectedEntityTypeOriginal?a("patientRegistration",{attrs:{cysmed:e.cysmed,main:e.main,inside:e.inside}}):e._e(),"MEDIC"===e.selectedEntityTypeOriginal?a("medicRegistration",{attrs:{cysmed:e.cysmed,main:e.main,inside:e.inside}}):e._e(),"FACILITY"===e.selectedEntityTypeOriginal?a("facilityRegistration",{attrs:{cysmed:e.cysmed,main:e.main,inside:e.inside}}):e._e(),"SYS_ADMIN"===e.selectedEntityTypeOriginal?a("adminRegistration",{attrs:{cysmed:e.cysmed,main:e.main,inside:e.inside,authority:e.rqAuthority}}):e._e()],1)},s=[],n=(a("ddb0"),a("3151")),r=a("50e3"),l=a("2f8f"),o=a("39f7"),c=a("15ce"),d=a("7c83"),m=a("cf57"),u=a("e11e"),h=a.n(u),g=a("2699"),p=a("a40a"),y=a("4e2b6"),f=a("fbba"),b=a("f60f");a("6cc5");a("bc3a");const w=a("1712").to,S=a("20e6"),v=a("c2a1").default,E=a("ea76").default;delete h.a.Icon.Default.prototype._getIconUrl,h.a.Icon.Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")});var q={computed:{isIndividual(){return"PATIENT"===this.selectedEntityTypeOriginal||"PHARMACIST"===this.selectedEntityTypeOriginal||"SYS_ADMIN"===this.selectedEntityTypeOriginal},isPharmacist(){return"PHARMACIST"===this.selectedEntityTypeOriginal},isPatient(){return"PATIENT"===this.selectedEntityTypeOriginal||""===this.selectedEntityTypeOriginal||"SYS_ADMIN"===this.selectedEntityTypeOriginal},isFacility(){return"PATIENT"!==this.selectedEntityTypeOriginal&&""!==this.selectedEntityTypeOriginal&&"PHARMACIST"!==this.selectedEntityTypeOriginal&&"SYS_ADMIN"!==this.selectedEntityTypeOriginal},entiTyisSelected(){return""!==this.selectedEntityTypeOriginal}},name:"registrationForm",components:{facilityRegistration:l["default"],medicRegistration:r["default"],patientRegistration:n["default"],adminRegistration:o["default"],terms:c["a"],activationLink:d["a"],LMap:g["a"],LTileLayer:p["a"],LMarker:y["a"],LIcon:f["a"],LPopup:b["a"]},props:["inside","main","cysmed","userType","rqAuthority"],async created(){"ADMIN"===this.userType?(this.entityTypesOriginal=[this.entityTypesOriginal[0]],this.entityType=this.cysmed.translate(`FIELDS.ENTITYTYPES.${this.entityTypesOriginal[0]}`)):this.inside&&(["SYS_ADMIN","FACILITY"].includes((await v.whoAmILocally()).authority)?(this.entityTypesOriginal=[this.entityTypesOriginal[0]],this.entityType=this.cysmed.translate(`FIELDS.ENTITYTYPES.${this.entityTypesOriginal[0]}`)):this.entityTypesOriginal.shift()),this.entityTypes=this.entityTypesOriginal.map((e=>this.translate(`FIELDS.ENTITYTYPES.${e}`))),this.genders=this.gendersOriginal.map((e=>this.translate(`FIELDS.GENDERS.${e}`))),this.centerString=this.center.join(",");let e=this.gendersOriginal.indexOf(this.gender);this.gender=this.genders[e],v.setSettings({TBURL:S["TB_URL"]}),v.setSettings(S),this.inside&&(this.showAccept=!1,this.accept=!0,this.showActivation=!0,this.activationEmail=!1,this.showActivationLink=!0)},data(){return{authority:"",superintendentFullName:"",superintendentIdentityNumber:"",superintendentTelephone1:"",superintendentTelephone2:"",facilityRegistrationNumber:"",mapDialog:!1,location:"0,0",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:15,center:[-1.286389,36.817223],centerString:"",icon:h.a.icon({iconUrl:"/images/marker-icon.png",iconSize:[32,37],iconAnchor:[16,37]}),staticAnchor:[16,37],customText:"Foobar",iconSize:64,registrationNumber:"",qualification:"",qualifications:{Pharmacists:["Pharmacist","Pharmtech"]},registeringBody:"",registeringBodies:{Pharmacists:["Pharmacy and Poisons Board"]},telephone1:"",telephone2:"",selectedEntityTypeOriginal:"",entityType:"",entityTypesOriginal:["SYS_ADMIN","PATIENT","MEDIC","FACILITY"],entityTypes:[],translate:E.translate,activationPage:"",accept:!1,showAccept:!0,showActivation:!1,showActivationLink:!1,activationEmail:!0,email:"",firstName:"",lastName:"",gender:"Male",gendersOriginal:["Male","Female"],genders:[],dob:"",password:"",cpassword:"",passwordErrorMessage:"",users:[],alert:!1,alertUserId:null}},methods:{async createLocalUser(){if(this.password!==this.cpassword)return this.cpassword="",this.passwordErrorMessage=this.translate("FIELDS.ERRORS.PASSWORD.DONTMATCH"),this.$q.notify({type:"negative",message:this.translate("FIELDS.ERRORS.PASSWORD.DONTMATCH")}),!1;let e={};e.email=this.email,e.firstName=this.firstName,e.lastName=this.lastName,e.password=this.password,e.authority="LOCAL_USER",this.cysmed.setVue(this),this.cysmed.getPlatform();let[t,a]=await w(this.cysmed.createLocalUser(e));if(t){t=t.msg||t.message||t.error||t;try{t=JSON.parse(t)}catch(i){}if("object"===typeof t){let e=Object.keys(t);t=t[e[0]]}return this.$q.notify({type:"negative",message:this.translate(t)||t}),!1}this.$q.notify({type:"positive",message:this.translate("Successful user creation")});try{this.main.listUsers(),this.main.createUserDialog=!1}catch(i){}},lmapReady(e){this.map=e,this.$refs.marker.mapObject.on("dragend",(e=>{let t=e.target._latlng;t=[t.lat,t.lng],this.center=t}))},changeAccept(e){this.accept=e},submit(){this.$refs.userRegistrationForm.submit()},mainLocal(){return this},isValidEmail(){const e=/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/;return e.test(this.email)||this.translate("FIELDS.ERRORS.EMAIL.INVALID")},showCustom(e=""){const t=this.$q.dialog({title:e,message:"",progress:{spinner:m["a"],color:"primary"},persistent:!0,ok:!1}),a=setInterval((()=>{!1===this.working&&(clearInterval(a),t.hide())}),500)},async createUser(){return v.setSettings({TBURL:S["TB_URL"]}),new Promise((async(e,t)=>{if(!0!==this.accept)return this.$q.notify({color:"red-5",textColor:"white",icon:"warning",message:this.translate("PASSAGE.READACCEPTTERMS")}),e(!1);let a={};a.email=this.email,a.firstName=this.firstName,a.telephone1=this.telephone1,a.telephone2=this.telephone2;let i="";switch(console.log(this.selectedEntityTypeOriginal),a.authority=this.selectedEntityTypeOriginal,this.selectedEntityTypeOriginal){case"SYS_ADMIN":a.authority="SYS_ADMIN";case"PATIENT":case"PHARMACIST":case"SYS_ADMIN":let e=this.genders.indexOf(this.gender),t=this.gendersOriginal[e];a.lastName=this.lastName,a.gender=t,a.dateOfBirth=this.dob;case"PATIENT":if("PATIENT"===this.selectedEntityTypeOriginal){i="user";break}case"SYS_ADMIN":if("SYS_ADMIN"===this.selectedEntityTypeOriginal){i="user";break}case"PHARMACIST":a.qualification=this.qualification,a.registeringBody=this.registeringBody,a.registrationNumber=this.registrationNumber,console.log("PHARM PATH"),i="user/pharmacist";break;case"DISTRIBUTOR_PHARMACY":case"WHOLESALE_PHARMACY":case"RETAIL_PHARMACY":i="user/facility",a.lastName="",a.registrationNumber=this.registrationNumber,a.location=this.center,a.superintendentFullName=this.superintendentFullName,a.superintendentIdentityNumber=this.superintendentIdentityNumber,a.qualification=this.qualification,a.registeringBody=this.registeringBody,a.superintendentTelephone1=this.superintendentTelephone1,a.superintendentTelephone2=this.superintendentTelephone2,a.facilityRegistrationNumber=this.facilityRegistrationNumber;break;default:}console.log(i),console.log(i),console.log(i),console.log(i),this.working=!0,this.showCustom();let[s,n]=await w(v.createUser(a,{activationEmail:this.activationEmail,showActivationLink:this.showActivationLink},i));if(this.working=!1,s){s=s.msg||s.message||s.error||s;try{s=JSON.parse(s)}catch(r){}if("object"===typeof s){let e=Object.keys(s);s=s[e[0]]}this.$q.notify({type:"negative",message:this.translate(s)||s}),e(!1)}else{this.showActivationLink?(this.alertUserId=n,this.alert=!1,this.$nextTick((()=>this.alert=!0))):this.$q.notify({type:"positive",message:this.translate(`SUCCESS.REGISTRATION.${this.cysmed.platform}`)});try{this.main.listUsers()}catch(r){}}}))},onReset(){this.email=null,this.firstName=null,this.lastName=null,this.password=null,this.cpassword=null,this.accept=!1},updateSelectedEntityType(e){let t=this.entityTypes.indexOf(e),a=this.entityTypesOriginal[t];this.selectedEntityTypeOriginal=a}},watch:{entityType(e){this.updateSelectedEntityType(e)},center:{handler(e){this.centerString=this.center.join(",")},deep:!0}}},I=q,N=a("2877"),T=a("0378"),O=a("ddd8"),k=a("eebe"),R=a.n(k),L=Object(N["a"])(I,i,s,!1,null,null,null);t["default"]=L.exports;R()(L,"components",{QForm:T["a"],QSelect:O["a"]})},b758:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return"ADMIN"===e.userType?a("adminLogin",{attrs:{cysmed:e.cysmed,recoveringPassword:e.recoveringPassword,setRecoveringPassword:e.setRecoveringPassword}}):a("loginForm",{attrs:{cysmed:e.cysmed,recoveringPassword:e.recoveringPassword,setRecoveringPassword:e.setRecoveringPassword}})},s=[],n=(a("ddb0"),{props:["inside","main","cysmed","userType"],components:{loginForm:async()=>new Promise((async(e,t)=>{console.log(void 0);let i="./loginParts/",s="loginForm.vue",n=null;try{n=await a("95a5")(`${i}${s.split(".").join(`.${PLATFORM}.`)}`)}catch(r){n=await a("95a5")(`${i}${s}`)}e(n)})),adminLogin:async()=>new Promise((async(e,t)=>{console.log(void 0);let i="./loginParts/",s="adminLogin.vue",n=null;try{n=await a("95a5")(`${i}${s.split(".").join(`.${PLATFORM}.`)}`)}catch(r){n=await a("95a5")(`${i}${s}`)}e(n)}))},name:"loginFormSelect",created(){},data(){return{recoveringPassword:!1}},methods:{removeRecoveringPassword(){this.recoveringPassword=!1},setRecoveringPassword(){this.recoveringPassword=!0}}}),r=n,l=a("2877"),o=Object(l["a"])(r,i,s,!1,null,null,null);t["default"]=o.exports},bd0d:function(e,t,a){"use strict";a("bfd5")},bfd5:function(e,t,a){},c556:function(e,t,a){},d1a5:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-tabs",{staticClass:"text-black",attrs:{align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"basic",label:"Basic Info"}}),a("q-tab",{attrs:{name:"facility",label:"Facility"}}),a("q-tab",{attrs:{name:"superintendent",label:"Superintendent"}})],1),a("q-tab-panels",{staticClass:"q-ma-none q-pa-none",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"basic"}},[a("basicProfile",{attrs:{cysmed:e.cysmed,selectedUser:e.selectedUser}})],1),a("q-tab-panel",{attrs:{name:"facility"}},[a("facilityProfileDetails",{attrs:{cysmed:e.cysmed,selectedUser:e.selectedUser}})],1),a("q-tab-panel",{attrs:{name:"superintendent"}},[a("superintendentDetails",{attrs:{cysmed:e.cysmed,selectedUser:e.selectedUser}})],1)],1)],1)},s=[],n=a("0e1b"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-page",{staticClass:"flex flex-center",attrs:{padding:""}},[e.loaded?a("q-card",{staticClass:"absolute-top items-center text-center bg-white",attrs:{flat:""}},[a("q-card-section",[a("q-form",{ref:"changeUserNameForm",staticClass:"q-gutter-md text-white",on:{submit:e.changeuserNames,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.REGISTRATIONNUMBER"),rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.REGISTRATIONNUMBERFACILITY.MISSINGOWN")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.facilityRegistrationNumber,callback:function(t){e.facilityRegistrationNumber=t},expression:"facilityRegistrationNumber"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.LOCATION"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.LOCATION.MISSING")},,]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-btn",{attrs:{icon:"place"},on:{click:function(t){e.mapDialog=!0}}})]},proxy:!0}],null,!1,495012479),model:{value:e.centerString,callback:function(t){e.centerString=t},expression:"centerString"}}),a("q-separator",{attrs:{color:"white",size:"2px"}}),a("div",{staticClass:"row"}),a("div",{staticClass:"row"},[a("q-space"),a("div",{staticClass:"items-left text-left"},[a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),a("q-btn",{attrs:{label:"Save",type:"submit",color:"green",disable:e.userEditted}})],1)],1)],1)],1)],1):e._e(),a("q-dialog",{attrs:{maximized:!1,"transition-show":"scale","transition-hide":"scale"},model:{value:e.mapDialog,callback:function(t){e.mapDialog=t},expression:"mapDialog"}},[a("div",{staticStyle:{width:"100%",height:"100%"}},[a("l-map",{ref:"lmap",staticClass:"full-width",staticStyle:{width:"100%",height:"100%"},attrs:{zoom:e.zoom,center:e.center},on:{ready:e.lmapReady}},[a("l-tile-layer",{attrs:{url:e.url}}),a("l-marker",{ref:"marker",attrs:{"lat-lng":e.center,draggable:!0}},[a("l-popup",{staticClass:"q-pa-none q-ma-none"},[a("q-card",{staticClass:"q-pa-none q-ma-none",attrs:{flat:""}},[a("q-card-section",[e._v("\n                "+e._s(e.firstName||"Facility")+" Location\n              ")]),a("q-card-section",[e._v("\n                "+e._s(e.centerString)+"\n              ")])],1)],1)],1)],1)],1)])],1)],1)},l=[],o=(a("ddb0"),a("cf57"),a("51e2"),a("e11e")),c=a.n(o),d=a("2699"),m=a("a40a"),u=a("4e2b6"),h=a("fbba"),g=a("f60f");a("6cc5");const p=a("c2a1").default,y=a("1712").to,f=a("20e6"),b=a("6daa").default;delete c.a.Icon.Default.prototype._getIconUrl,c.a.Icon.Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")});var w={name:"facilityProfileDetails",components:{LMap:d["a"],LTileLayer:m["a"],LMarker:u["a"],LIcon:h["a"],LPopup:g["a"]},props:["cysmed","selectedUser"],data(){return{profilePath:"",userData:{},email:"",firstName:"",lastName:"",centerOriginal:[-1.286389,36.817223],loaded:!1,changePasswordDialog:!1,lastLogin:"",allowlastName:!0,facilityRegistrationNumber:"",facilityRegistrationNumberOriginal:"",mapDialog:!1,location:"0,0",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:15,center:[-1.286389,36.817223],centerString:"",icon:c.a.icon({iconUrl:"/images/marker-icon.png",iconSize:[32,37],iconAnchor:[16,37]}),staticAnchor:[16,37]}},async created(){if(this.centerString=this.center.join(","),p.setSettings({TBURL:f["TB_URL"]}),p.setVue(this),await p.authGuard(),this.allowlastName=!this.cysmed.currentUserAuthority.match(/FACILITY/),this.selectedUser)this.setUserData(this.selectedUser);else{p.showLoading();let[e,t]=await y(p.readUserData());if(e)return;p.hideLoading(),this.setUserData(t)}console.log(this.selectedUser),console.log(this.selectedUser),console.log(this.selectedUser)},methods:{lmapReady(e){this.map=e,this.$refs.marker.mapObject.on("dragend",(e=>{let t=e.target._latlng;t=[t.lat,t.lng],this.center=t}))},onReset(){this.firstName=this.firstNameOriginal,this.lastName=this.lastNameOriginal,this.gender=this.genderOriginal,this.dob=this.dobOriginal},onResetChangePassword(){this.currentPassword="",this.newPassword="",this.newPasswordAgain=""},setUserData(e){this.userData=e,this.email=e.email,this.firstName=e.firstName,this.lastName=e.lastName,this.firstNameOriginal=e.firstName,this.lastNameOriginal=e.lastName,this.facilityRegistrationNumber=e.facilityRegistrationNumber,this.facilityRegistrationNumberOriginal=e.facilityRegistrationNumber,this.dob=e.dateOfBirth,this.dobOriginal=e.dateOfBirth,this.gender=e.gender,this.genderOriginal=e.gender,this.loaded=!0,this.lastLogin=new Date(e.additionalInfo.lastLoginTs).toISOString()},async changeuserNames(){return new Promise((async(e,t)=>{if(this.notUserEditted())return e(!1);let a={userId:this.userData.userId};a.location=JSON.stringify(this.center),a.facilityRegistrationNumber=this.facilityRegistrationNumber,p.showLoading();let[i,s]=await y(p.patchEntry(a,"user/facility"));if(p.hideLoading(),i)return this.$q.notify({type:"negative",message:i.msg||i}),e(!1);this.setUserData(s),e(s)}))},async changePassword(){return new Promise((async(e,t)=>{if(this.newPassword!==this.newPasswordAgain)return this.newPasswordAgain="",this.confirmPasswordError="Passwords don't match",e(!1);let a={oldpassword:this.currentPassword,password:this.newPassword};p.showLoading({message:"Changing Password"});let[i,s]=await y(p.changePassword(a));if(p.hideLoading(),i)return this.$q.notify({type:"negative",message:i.response.data.error||i.msg||i.response.data.message||i.message||i}),e(!1);this.$q.notify({type:"positive",message:"Password changed."}),this.changePasswordDialog=!1,e(s)}))},async deleteAccount(){return new Promise((async(e,t)=>{let[a,i]=await y(b.confirm(this,"Are you sure you want to delete your account?","Delete Account"));return a?e(!1):(p.showLoading({message:"Deleting Account"}),[a,i]=await y(p.deleteUser(this.userData.userId,!0)),p.hideLoading(),a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:"Your account has been deleted"}),void window.location.assign("/")))}))},submitChangeUserName(){this.$refs.changeUserNameForm.submit()},submitChangePassword(){this.$refs.changePasswordForm.submit()},notUserEditted(){return this.center.toString()===this.centerOriginal.toString()&&this.facilityRegistrationNumber===this.facilityRegistrationNumberOriginal}},computed:{userEditted(){return this.center.toString()===this.centerOriginal.toString()&&this.facilityRegistrationNumber===this.facilityRegistrationNumberOriginal}}},S=w,v=(a("bd0d"),a("2877")),E=a("9989"),q=a("f09f"),I=a("a370"),N=a("0378"),T=a("27f9"),O=a("9c40"),k=a("eb85"),R=a("2c91"),L=a("24e8"),P=a("eebe"),C=a.n(P),D=Object(v["a"])(S,r,l,!1,null,"c2a9e2ec",null),x=D.exports;C()(D,"components",{QPage:E["a"],QCard:q["a"],QCardSection:I["a"],QForm:N["a"],QInput:T["a"],QBtn:O["a"],QSeparator:k["a"],QSpace:R["a"],QDialog:L["a"]});var F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-card",{staticClass:"items-center text-center bg-white",attrs:{flat:""}},[a("q-card-section",[a("q-form",{ref:"changeUserNameForm",staticClass:"q-gutter-md text-white",on:{submit:e.changeuserNames,reset:e.onReset}},[a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.NAME.SUPERINTENDENT"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.NAME.SUPERINTENDENT.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.superintendentFullName,callback:function(t){e.superintendentFullName=t},expression:"superintendentFullName"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.IDNUMBER.SUPERINTENDENT"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.IDNUMBER.SUPERINTENDENT.MISSING")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.superintendentIdentityNumber,callback:function(t){e.superintendentIdentityNumber=t},expression:"superintendentIdentityNumber"}}),a("q-select",{attrs:{filled:"",options:e.registeringBodies,label:e.cysmed.translate("PASSAGE.REGISTERINGBODY"),rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.REGISTERINGBODY.MISSING")}]},model:{value:e.registeringBody,callback:function(t){e.registeringBody=t},expression:"registeringBody"}}),a("q-select",{attrs:{filled:"",options:e.qualifications[e.registeringBody],label:e.cysmed.translate("FIELDS.PROFESSIONAL.SUPERINTENDENT.QUALIFICATION"),rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.QUALIFICATION.SUPERINTENDENT.MISSING")}]},model:{value:e.qualification,callback:function(t){e.qualification=t},expression:"qualification"}}),a("q-input",{attrs:{filled:"",type:"text",label:e.cysmed.translate("FIELDS.SUPERINTENDENT.REGISTRATIONNUMBER"),rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.REGISTRATIONNUMBER.SUPERINTENDENT.MISSINGOWN")}]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.registrationNumber,callback:function(t){e.registrationNumber=t},expression:"registrationNumber"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.SUPERINTENDENT.1"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.SUPERINTENDENT.1.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.SUPERINTENDENT.1.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.superintendentTelephone1,callback:function(t){e.superintendentTelephone1=t},expression:"superintendentTelephone1"}}),a("q-input",{attrs:{filled:"",label:e.cysmed.translate("FIELDS.TELEPHONE.SUPERINTENDENT.2"),type:"text",rules:[function(t){return t&&t.length>0||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.SUPERINTENDENT.2.MISSING")},function(t){return t&&e.cysmed.isTelephone(t)||e.cysmed.translate("FIELDS.ERRORS.TELEPHONE.SUPERINTENDENT.2.INVALID")}]},on:{input:e.cysmed.changeSomethingInProfessional},model:{value:e.superintendentTelephone2,callback:function(t){e.superintendentTelephone2=t},expression:"superintendentTelephone2"}}),a("q-separator",{attrs:{color:"white",size:"2px"}}),a("div",{staticClass:"row"},[a("q-space"),a("div",{staticClass:"items-left text-left"},[a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"primary",flat:""}}),a("q-btn",{attrs:{label:"Save",type:"submit",color:"green",disable:e.userEditted}})],1)],1)],1)],1)],1),a("q-dialog",{attrs:{maximized:!1,"transition-show":"scale","transition-hide":"scale"},model:{value:e.mapDialog,callback:function(t){e.mapDialog=t},expression:"mapDialog"}},[a("div",{staticStyle:{width:"100%",height:"100%"}},[a("l-map",{ref:"lmap",staticClass:"full-width",staticStyle:{width:"100%",height:"100%"},attrs:{zoom:e.zoom,center:e.center},on:{ready:e.lmapReady}},[a("l-tile-layer",{attrs:{url:e.url}}),a("l-marker",{ref:"marker",attrs:{"lat-lng":e.center,draggable:!0}},[a("l-popup",{staticClass:"q-pa-none q-ma-none"},[a("q-card",{staticClass:"q-pa-none q-ma-none",attrs:{flat:""}},[a("q-card-section",[e._v("\n                "+e._s(e.firstName||"Facility")+" Location\n              ")]),a("q-card-section",[e._v("\n                "+e._s(e.centerString)+"\n              ")])],1)],1)],1)],1)],1)])],1)},A=[];const _=a("c2a1").default,z=a("1712").to,M=a("20e6"),$=a("6daa").default;delete c.a.Icon.Default.prototype._getIconUrl,c.a.Icon.Default.mergeOptions({iconRetinaUrl:a("584d"),iconUrl:a("6397"),shadowUrl:a("e2b9")});var U={name:"superintendentDetails",components:{LMap:d["a"],LTileLayer:m["a"],LMarker:u["a"],LIcon:h["a"],LPopup:g["a"]},props:["cysmed","selectedUser"],data(){return{authority:"",superintendentFullName:"",superintendentIdentityNumber:"",superintendentTelephone1:"",superintendentTelephone2:"",facilityRegistrationNumber:"",superintendentTelephone1:"",superintendentTelephone1Original:"",superintendentTelephone2:"",superintendentTelephone2Original:"",qualification:"",qualifications:{"Pharmacy and Poisons Board":["Pharmacist","Pharmtech"]},registeringBody:"",registeringBodyOriginal:"",registeringBodies:["Pharmacy and Poisons Board"],registrationNumber:"",registrationNumberOriginal:"",profilePath:"",userData:{},email:"",firstName:"",lastName:"",centerOriginal:[-1.286389,36.817223],loaded:!1,changePasswordDialog:!1,lastLogin:"",allowlastName:!0,mapDialog:!1,location:"0,0",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:15,center:[-1.286389,36.817223],centerString:"",icon:c.a.icon({iconUrl:"/images/marker-icon.png",iconSize:[32,37],iconAnchor:[16,37]}),staticAnchor:[16,37]}},async created(){if(this.centerString=this.center.join(","),_.setSettings({TBURL:M["TB_URL"]}),_.setVue(this),await _.authGuard(),this.allowlastName=!this.cysmed.currentUserAuthority.match(/FACILITY/),this.selectedUser)this.setUserData(this.selectedUser);else{_.showLoading();let[e,t]=await z(_.readUserData());if(e)return;_.hideLoading(),this.setUserData(t)}},methods:{lmapReady(e){this.map=e,this.$refs.marker.mapObject.on("dragend",(e=>{let t=e.target._latlng;t=[t.lat,t.lng],this.center=t}))},onReset(){this.superintendentFullName=this.superintendentFullNameOriginal,this.superintendentIdentityNumber=this.superintendentIdentityNumberOriginal,this.registeringBody=this.registeringBodyOriginal,this.registrationNumber=this.registrationNumberOriginal,this.qualification=this.qualificationOriginal,this.superintendentTelephone1=this.superintendentTelephone1Original,this.superintendentTelephone2=this.superintendentTelephone2Original},onResetChangePassword(){this.currentPassword="",this.newPassword="",this.newPasswordAgain=""},setUserData(e){this.userData=e,this.superintendentFullName=e.superintendentFullName,this.superintendentFullNameOriginal=e.superintendentFullName,this.superintendentIdentityNumber=e.superintendentIdentityNumber,this.superintendentIdentityNumberOriginal=e.superintendentIdentityNumber,this.registeringBody=e.registeringBody,this.registeringBodyOriginal=e.registeringBody,this.registrationNumber=e.registrationNumber,this.registrationNumberOriginal=e.registrationNumber,this.qualification=e.qualification,this.qualificationOriginal=e.qualification,this.superintendentTelephone1=e.superintendentTelephone1,this.superintendentTelephone1Original=e.superintendentTelephone1,this.superintendentTelephone2=e.superintendentTelephone2,this.superintendentTelephone2Original=e.superintendentTelephone2},async changeuserNames(){return new Promise((async(e,t)=>{if(this.notUserEditted())return e(!1);let a={userId:this.userData.userId};a.superintendentFullName=this.superintendentFullName,a.superintendentIdentityNumber=this.superintendentIdentityNumber,a.registeringBody=this.registeringBody,a.registrationNumber=this.registrationNumber,a.qualification=this.qualification,a.superintendentTelephone1=this.superintendentTelephone1,a.superintendentTelephone2=this.superintendentTelephone2,_.showLoading();let[i,s]=await z(_.patchEntry(a,"user/facility"));if(_.hideLoading(),i)return this.$q.notify({type:"negative",message:i.msg||i}),e(!1);this.setUserData(s),e(s)}))},async changePassword(){return new Promise((async(e,t)=>{if(this.newPassword!==this.newPasswordAgain)return this.newPasswordAgain="",this.confirmPasswordError="Passwords don't match",e(!1);let a={oldpassword:this.currentPassword,password:this.newPassword};_.showLoading({message:"Changing Password"});let[i,s]=await z(_.changePassword(a));if(_.hideLoading(),i)return this.$q.notify({type:"negative",message:i.response.data.error||i.msg||i.response.data.message||i.message||i}),e(!1);this.$q.notify({type:"positive",message:"Password changed."}),this.changePasswordDialog=!1,e(s)}))},async deleteAccount(){return new Promise((async(e,t)=>{let[a,i]=await z($.confirm(this,"Are you sure you want to delete your account?","Delete Account"));return a?e(!1):(_.showLoading({message:"Deleting Account"}),[a,i]=await z(_.deleteUser(this.userData.userId,!0)),_.hideLoading(),a?(this.$q.notify({type:"negative",message:a.msg||a}),e(!1)):(this.$q.notify({type:"positive",message:"Your account has been deleted"}),void window.location.assign("/")))}))},submitChangeUserName(){this.$refs.changeUserNameForm.submit()},submitChangePassword(){this.$refs.changePasswordForm.submit()},notUserEditted(){return this.superintendentFullName===this.superintendentFullNameOriginal&&this.superintendentIdentityNumber===this.superintendentIdentityNumberOriginal&&this.registeringBody===this.registeringBodyOriginal&&this.registrationNumber===this.registrationNumberOriginal&&this.qualification===this.qualificationOriginal&&this.superintendentTelephone1===this.superintendentTelephone1Original&&this.superintendentTelephone2===this.superintendentTelephone2Original}},computed:{userEditted(){return this.superintendentFullName===this.superintendentFullNameOriginal&&this.superintendentIdentityNumber===this.superintendentIdentityNumberOriginal&&this.registeringBody===this.registeringBodyOriginal&&this.registrationNumber===this.registrationNumberOriginal&&this.qualification===this.qualificationOriginal&&this.superintendentTelephone1===this.superintendentTelephone1Original&&this.superintendentTelephone2===this.superintendentTelephone2Original}}},Q=U,B=(a("020c"),a("ddd8")),j=Object(v["a"])(Q,F,A,!1,null,"ba230574",null),G=j.exports;C()(j,"components",{QCard:q["a"],QCardSection:I["a"],QForm:N["a"],QInput:T["a"],QSelect:B["a"],QSeparator:k["a"],QSpace:R["a"],QBtn:O["a"],QDialog:L["a"]});var H={name:"facilityProfile",components:{basicProfile:n["a"],facilityProfileDetails:x,superintendentDetails:G},props:["cysmed","selectedUser"],data(){return{tab:"basic"}},created(){}},Y=H,V=a("429bb"),J=a("7460"),W=a("adad"),Z=a("823b"),K=Object(v["a"])(Y,i,s,!1,null,null,null);t["a"]=K.exports;C()(K,"components",{QTabs:V["a"],QTab:J["a"],QTabPanels:W["a"],QTabPanel:Z["a"]})},d47b:function(e,t,a){"use strict";a("a46f")},d52d:function(e,t,a){},ef06:function(e,t,a){},f392:function(e,t,a){"use strict";a.r(t);a("ddb0");let i={ORG:["ORG_ADMIN","ORG_USER"],FACILITY:["FACILITY_ADMIN","FACILITY_USER"]},s=a("20e6").PROJECT.toLowerCase();try{let e=a("948c")(`./${s}/authorities.json`);for(let t in e){let a=e[t].concat(i[t]);a=[...new Set(a)],i[t]=a}}catch(n){console.log(n)}t["default"]=i}}]);